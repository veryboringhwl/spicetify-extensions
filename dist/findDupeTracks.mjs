
        (async function() {
          while (!Spicetify.React || !Spicetify.ReactDOM) {
          await new Promise(resolve => setTimeout(resolve, 10));
        }
var Wa=Object.create;var ni=Object.defineProperty;var Ha=Object.getOwnPropertyDescriptor;var Ya=Object.getOwnPropertyNames;var Qa=Object.getPrototypeOf,Ga=Object.prototype.hasOwnProperty;var yt=(A,S)=>()=>(S||A((S={exports:{}}).exports,S),S.exports);var Za=(A,S,x,N)=>{if(S&&typeof S=="object"||typeof S=="function")for(let M of Ya(S))!Ga.call(A,M)&&M!==x&&ni(A,M,{get:()=>S[M],enumerable:!(N=Ha(S,M))||N.enumerable});return A};var se=(A,S,x)=>(x=A!=null?Wa(Qa(A)):{},Za(S||!A||!A.__esModule?ni(x,"default",{value:A,enumerable:!0}):x,A));var be=yt((uo,ti)=>{ti.exports=Spicetify.ReactJSX});var Fn=yt((co,ri)=>{ri.exports=Spicetify.React});var dr=yt((lo,ii)=>{ii.exports=Spicetify.ReactDOM});var li=yt((pr,hr)=>{(function(A,S){typeof pr=="object"&&typeof hr<"u"?hr.exports=S():typeof define=="function"&&define.amd?define(S):(A=typeof globalThis<"u"?globalThis:A||self,A.Dexie=S())})(pr,function(){"use strict";var A=function(e,n){return A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},A(e,n)};function S(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");A(e,n);function t(){this.constructor=e}e.prototype=n===null?Object.create(n):(t.prototype=n.prototype,new t)}var x=function(){return x=Object.assign||function(n){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(n[a]=t[a])}return n},x.apply(this,arguments)};function N(e,n,t){if(t||arguments.length===2)for(var r=0,i=n.length,a;r<i;r++)(a||!(r in n))&&(a||(a=Array.prototype.slice.call(n,0,r)),a[r]=n[r]);return e.concat(a||Array.prototype.slice.call(n))}var M=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,j=Object.keys,F=Array.isArray;typeof Promise<"u"&&!M.Promise&&(M.Promise=Promise);function B(e,n){return typeof n!="object"||j(n).forEach(function(t){e[t]=n[t]}),e}var G=Object.getPrototypeOf,L={}.hasOwnProperty;function H(e,n){return L.call(e,n)}function J(e,n){typeof n=="function"&&(n=n(G(e))),(typeof Reflect>"u"?j:Reflect.ownKeys)(n).forEach(function(t){re(e,t,n[t])})}var ce=Object.defineProperty;function re(e,n,t,r){ce(e,n,B(t&&H(t,"get")&&typeof t.get=="function"?{get:t.get,set:t.set,configurable:!0}:{value:t,configurable:!0,writable:!0},r))}function ve(e){return{from:function(n){return e.prototype=Object.create(n.prototype),re(e.prototype,"constructor",e),{extend:J.bind(null,e.prototype)}}}}var sn=Object.getOwnPropertyDescriptor;function Ne(e,n){var t=sn(e,n),r;return t||(r=G(e))&&Ne(r,n)}var cn=[].slice;function Qe(e,n,t){return cn.call(e,n,t)}function Vn(e,n){return n(e)}function Ge(e){if(!e)throw new Error("Assertion Failed")}function z(e){M.setImmediate?setImmediate(e):setTimeout(e,0)}function ie(e,n){return e.reduce(function(t,r,i){var a=n(r,i);return a&&(t[a[0]]=a[1]),t},{})}function X(e,n){if(typeof n=="string"&&H(e,n))return e[n];if(!n)return e;if(typeof n!="string"){for(var t=[],r=0,i=n.length;r<i;++r){var a=X(e,n[r]);t.push(a)}return t}var o=n.indexOf(".");if(o!==-1){var u=e[n.substr(0,o)];return u==null?void 0:X(u,n.substr(o+1))}}function U(e,n,t){if(!(!e||n===void 0)&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof n!="string"&&"length"in n){Ge(typeof t!="string"&&"length"in t);for(var r=0,i=n.length;r<i;++r)U(e,n[r],t[r])}else{var a=n.indexOf(".");if(a!==-1){var o=n.substr(0,a),u=n.substr(a+1);if(u==="")t===void 0?F(e)&&!isNaN(parseInt(o))?e.splice(o,1):delete e[o]:e[o]=t;else{var s=e[o];(!s||!H(e,o))&&(s=e[o]={}),U(s,u,t)}}else t===void 0?F(e)&&!isNaN(parseInt(n))?e.splice(n,1):delete e[n]:e[n]=t}}function ue(e,n){typeof n=="string"?U(e,n,void 0):"length"in n&&[].map.call(n,function(t){U(e,t,void 0)})}function ne(e){var n={};for(var t in e)H(e,t)&&(n[t]=e[t]);return n}var ye=[].concat;function we(e){return ye.apply([],e)}var Ze="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(we([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(n){return n+e+"Array"})}))).filter(function(e){return M[e]}),ae=new Set(Ze.map(function(e){return M[e]}));function zn(e){var n={};for(var t in e)if(H(e,t)){var r=e[t];n[t]=!r||typeof r!="object"||ae.has(r.constructor)?r:zn(r)}return n}function _t(e){for(var n in e)if(H(e,n))return!1;return!0}var Ee=null;function Me(e){Ee=new WeakMap;var n=ln(e);return Ee=null,n}function ln(e){if(!e||typeof e!="object")return e;var n=Ee.get(e);if(n)return n;if(F(e)){n=[],Ee.set(e,n);for(var t=0,r=e.length;t<r;++t)n.push(ln(e[t]))}else if(ae.has(e.constructor))n=e;else{var i=G(e);n=i===Object.prototype?{}:Object.create(i),Ee.set(e,n);for(var a in e)H(e,a)&&(n[a]=ln(e[a]))}return n}var xt={}.toString;function me(e){return xt.call(e).slice(8,-1)}var Se=typeof Symbol<"u"?Symbol.iterator:"@@iterator",xn=typeof Se=="symbol"?function(e){var n;return e!=null&&(n=e[Se])&&n.apply(e)}:function(){return null};function Ke(e,n){var t=e.indexOf(n);return t>=0&&e.splice(t,1),t>=0}var fn={};function Re(e){var n,t,r,i;if(arguments.length===1){if(F(e))return e.slice();if(this===fn&&typeof e=="string")return[e];if(i=xn(e)){for(t=[];r=i.next(),!r.done;)t.push(r.value);return t}if(e==null)return[e];if(n=e.length,typeof n=="number"){for(t=new Array(n);n--;)t[n]=e[n];return t}return[e]}for(n=arguments.length,t=new Array(n);n--;)t[n]=arguments[n];return t}var kt=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},bi=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"],yr=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Et=bi.concat(yr),wi={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function dn(e,n){this.name=e,this.message=n}ve(dn).from(Error).extend({toString:function(){return this.name+": "+this.message}});function mr(e,n){return e+". Errors: "+Object.keys(n).map(function(t){return n[t].toString()}).filter(function(t,r,i){return i.indexOf(t)===r}).join(`
`)}function $n(e,n,t,r){this.failures=n,this.failedKeys=r,this.successCount=t,this.message=mr(e,n)}ve($n).from(dn);function pn(e,n){this.name="BulkError",this.failures=Object.keys(n).map(function(t){return n[t]}),this.failuresByPos=n,this.message=mr(e,this.failures)}ve(pn).from(dn);var St=Et.reduce(function(e,n){return e[n]=n+"Error",e},{}),_i=dn,R=Et.reduce(function(e,n){var t=n+"Error";function r(i,a){this.name=t,i?typeof i=="string"?(this.message="".concat(i).concat(a?`
 `+a:""),this.inner=a||null):typeof i=="object"&&(this.message="".concat(i.name," ").concat(i.message),this.inner=i):(this.message=wi[n]||t,this.inner=null)}return ve(r).from(_i),e[n]=r,e},{});R.Syntax=SyntaxError,R.Type=TypeError,R.Range=RangeError;var gr=yr.reduce(function(e,n){return e[n+"Error"]=R[n],e},{});function xi(e,n){if(!e||e instanceof dn||e instanceof TypeError||e instanceof SyntaxError||!e.name||!gr[e.name])return e;var t=new gr[e.name](n||e.message,e);return"stack"in e&&re(t,"stack",{get:function(){return this.inner.stack}}),t}var Un=Et.reduce(function(e,n){return["Syntax","Type","Range"].indexOf(n)===-1&&(e[n+"Error"]=R[n]),e},{});Un.ModifyError=$n,Un.DexieError=dn,Un.BulkError=pn;function Z(){}function kn(e){return e}function ki(e,n){return e==null||e===kn?n:function(t){return n(e(t))}}function Xe(e,n){return function(){e.apply(this,arguments),n.apply(this,arguments)}}function Ei(e,n){return e===Z?n:function(){var t=e.apply(this,arguments);t!==void 0&&(arguments[0]=t);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var a=n.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?Xe(r,this.onsuccess):r),i&&(this.onerror=this.onerror?Xe(i,this.onerror):i),a!==void 0?a:t}}function Si(e,n){return e===Z?n:function(){e.apply(this,arguments);var t=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,n.apply(this,arguments),t&&(this.onsuccess=this.onsuccess?Xe(t,this.onsuccess):t),r&&(this.onerror=this.onerror?Xe(r,this.onerror):r)}}function Ci(e,n){return e===Z?n:function(t){var r=e.apply(this,arguments);B(t,r);var i=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var o=n.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?Xe(i,this.onsuccess):i),a&&(this.onerror=this.onerror?Xe(a,this.onerror):a),r===void 0?o===void 0?void 0:o:B(r,o)}}function Pi(e,n){return e===Z?n:function(){return n.apply(this,arguments)===!1?!1:e.apply(this,arguments)}}function Ct(e,n){return e===Z?n:function(){var t=e.apply(this,arguments);if(t&&typeof t.then=="function"){for(var r=this,i=arguments.length,a=new Array(i);i--;)a[i]=arguments[i];return t.then(function(){return n.apply(r,a)})}return n.apply(this,arguments)}}var Ce=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function br(e,n){Ce=e}var En={},wr=100,Pt=typeof Promise>"u"?[]:function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,G(e),e];var n=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[n,G(n),e]}(),_r=Pt[0],xr=Pt[1],Ai=Pt[2],Di=xr&&xr.then,Je=_r&&_r.constructor,At=!!Ai;function Ti(){queueMicrotask(Ki)}var Sn=function(e,n){Cn.push([e,n]),Wn&&(Ti(),Wn=!1)},Dt=!0,Wn=!0,qe=[],Hn=[],Tt=kn,Le={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Z,pgp:!1,env:{},finalize:Z},T=Le,Cn=[],en=0,Yn=[];function C(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var n=this._PSD=T;if(typeof e!="function"){if(e!==En)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Kt(this,this._value);return}this._state=null,this._value=null,++n.ref,Er(this,e)}var Mt={get:function(){var e=T,n=Xn;function t(r,i){var a=this,o=!e.global&&(e!==T||n!==Xn),u=o&&!Ve(),s=new C(function(c,d){Rt(a,new kr(Pr(r,e,o,u),Pr(i,e,o,u),c,d,e))});return this._consoleTask&&(s._consoleTask=this._consoleTask),s}return t.prototype=En,t},set:function(e){re(this,"then",e&&e.prototype===En?Mt:{get:function(){return e},set:Mt.set})}};J(C.prototype,{then:Mt,_then:function(e,n){Rt(this,new kr(null,null,e,n,T))},catch:function(e){if(arguments.length===1)return this.then(null,e);var n=arguments[0],t=arguments[1];return typeof n=="function"?this.then(null,function(r){return r instanceof n?t(r):Qn(r)}):this.then(null,function(r){return r&&r.name===n?t(r):Qn(r)})},finally:function(e){return this.then(function(n){return C.resolve(e()).then(function(){return n})},function(n){return C.resolve(e()).then(function(){return Qn(n)})})},timeout:function(e,n){var t=this;return e<1/0?new C(function(r,i){var a=setTimeout(function(){return i(new R.Timeout(n))},e);t.then(r,i).finally(clearTimeout.bind(null,a))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&re(C.prototype,Symbol.toStringTag,"Dexie.Promise"),Le.env=Cr();function kr(e,n,t,r,i){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof n=="function"?n:null,this.resolve=t,this.reject=r,this.psd=i}J(C,{all:function(){var e=Re.apply(null,arguments).map(Jn);return new C(function(n,t){e.length===0&&n([]);var r=e.length;e.forEach(function(i,a){return C.resolve(i).then(function(o){e[a]=o,--r||n(e)},t)})})},resolve:function(e){if(e instanceof C)return e;if(e&&typeof e.then=="function")return new C(function(t,r){e.then(t,r)});var n=new C(En,!0,e);return n},reject:Qn,race:function(){var e=Re.apply(null,arguments).map(Jn);return new C(function(n,t){e.map(function(r){return C.resolve(r).then(n,t)})})},PSD:{get:function(){return T},set:function(e){return T=e}},totalEchoes:{get:function(){return Xn}},newPSD:je,usePSD:nn,scheduler:{get:function(){return Sn},set:function(e){Sn=e}},rejectionMapper:{get:function(){return Tt},set:function(e){Tt=e}},follow:function(e,n){return new C(function(t,r){return je(function(i,a){var o=T;o.unhandleds=[],o.onunhandled=a,o.finalize=Xe(function(){var u=this;Ri(function(){u.unhandleds.length===0?i():a(u.unhandleds[0])})},o.finalize),e()},n,t,r)})}}),Je&&(Je.allSettled&&re(C,"allSettled",function(){var e=Re.apply(null,arguments).map(Jn);return new C(function(n){e.length===0&&n([]);var t=e.length,r=new Array(t);e.forEach(function(i,a){return C.resolve(i).then(function(o){return r[a]={status:"fulfilled",value:o}},function(o){return r[a]={status:"rejected",reason:o}}).then(function(){return--t||n(r)})})})}),Je.any&&typeof AggregateError<"u"&&re(C,"any",function(){var e=Re.apply(null,arguments).map(Jn);return new C(function(n,t){e.length===0&&t(new AggregateError([]));var r=e.length,i=new Array(r);e.forEach(function(a,o){return C.resolve(a).then(function(u){return n(u)},function(u){i[o]=u,--r||t(new AggregateError(i))})})})}),Je.withResolvers&&(C.withResolvers=Je.withResolvers));function Er(e,n){try{n(function(t){if(e._state===null){if(t===e)throw new TypeError("A promise cannot be resolved with itself.");var r=e._lib&&hn();t&&typeof t.then=="function"?Er(e,function(i,a){t instanceof C?t._then(i,a):t.then(i,a)}):(e._state=!0,e._value=t,Sr(e)),r&&vn()}},Kt.bind(null,e))}catch(t){Kt(e,t)}}function Kt(e,n){if(Hn.push(n),e._state===null){var t=e._lib&&hn();n=Tt(n),e._state=!1,e._value=n,Ii(e),Sr(e),t&&vn()}}function Sr(e){var n=e._listeners;e._listeners=[];for(var t=0,r=n.length;t<r;++t)Rt(e,n[t]);var i=e._PSD;--i.ref||i.finalize(),en===0&&(++en,Sn(function(){--en===0&&It()},[]))}function Rt(e,n){if(e._state===null){e._listeners.push(n);return}var t=e._state?n.onFulfilled:n.onRejected;if(t===null)return(e._state?n.resolve:n.reject)(e._value);++n.psd.ref,++en,Sn(Mi,[t,e,n])}function Mi(e,n,t){try{var r,i=n._value;!n._state&&Hn.length&&(Hn=[]),r=Ce&&n._consoleTask?n._consoleTask.run(function(){return e(i)}):e(i),!n._state&&Hn.indexOf(i)===-1&&Oi(n),t.resolve(r)}catch(a){t.reject(a)}finally{--en===0&&It(),--t.psd.ref||t.psd.finalize()}}function Ki(){nn(Le,function(){hn()&&vn()})}function hn(){var e=Dt;return Dt=!1,Wn=!1,e}function vn(){var e,n,t;do for(;Cn.length>0;)for(e=Cn,Cn=[],t=e.length,n=0;n<t;++n){var r=e[n];r[0].apply(null,r[1])}while(Cn.length>0);Dt=!0,Wn=!0}function It(){var e=qe;qe=[],e.forEach(function(r){r._PSD.onunhandled.call(null,r._value,r)});for(var n=Yn.slice(0),t=n.length;t;)n[--t]()}function Ri(e){function n(){e(),Yn.splice(Yn.indexOf(n),1)}Yn.push(n),++en,Sn(function(){--en===0&&It()},[])}function Ii(e){qe.some(function(n){return n._value===e._value})||qe.push(e)}function Oi(e){for(var n=qe.length;n;)if(qe[--n]._value===e._value){qe.splice(n,1);return}}function Qn(e){return new C(En,!1,e)}function q(e,n){var t=T;return function(){var r=hn(),i=T;try{return ze(t,!0),e.apply(this,arguments)}catch(a){n&&n(a)}finally{ze(i,!1),r&&vn()}}}var le={awaits:0,echoes:0,id:0},Bi=0,Gn=[],Zn=0,Xn=0,Fi=0;function je(e,n,t,r){var i=T,a=Object.create(i);a.parent=i,a.ref=0,a.global=!1,a.id=++Fi,Le.env,a.env=At?{Promise:C,PromiseProp:{value:C,configurable:!0,writable:!0},all:C.all,race:C.race,allSettled:C.allSettled,any:C.any,resolve:C.resolve,reject:C.reject}:{},n&&B(a,n),++i.ref,a.finalize=function(){--this.parent.ref||this.parent.finalize()};var o=nn(a,e,t,r);return a.ref===0&&a.finalize(),o}function yn(){return le.id||(le.id=++Bi),++le.awaits,le.echoes+=wr,le.id}function Ve(){return le.awaits?(--le.awaits===0&&(le.id=0),le.echoes=le.awaits*wr,!0):!1}(""+Di).indexOf("[native code]")===-1&&(yn=Ve=Z);function Jn(e){return le.echoes&&e&&e.constructor===Je?(yn(),e.then(function(n){return Ve(),n},function(n){return Ve(),oe(n)})):e}function Ni(e){++Xn,(!le.echoes||--le.echoes===0)&&(le.echoes=le.awaits=le.id=0),Gn.push(T),ze(e,!0)}function Li(){var e=Gn[Gn.length-1];Gn.pop(),ze(e,!1)}function ze(e,n){var t=T;if((n?le.echoes&&(!Zn++||e!==T):Zn&&(!--Zn||e!==T))&&queueMicrotask(n?Ni.bind(null,e):Li),e!==T&&(T=e,t===Le&&(Le.env=Cr()),At)){var r=Le.env.Promise,i=e.env;(t.global||e.global)&&(Object.defineProperty(M,"Promise",i.PromiseProp),r.all=i.all,r.race=i.race,r.resolve=i.resolve,r.reject=i.reject,i.allSettled&&(r.allSettled=i.allSettled),i.any&&(r.any=i.any))}}function Cr(){var e=M.Promise;return At?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(M,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function nn(e,n,t,r,i){var a=T;try{return ze(e,!0),n(t,r,i)}finally{ze(a,!1)}}function Pr(e,n,t,r){return typeof e!="function"?e:function(){var i=T;t&&yn(),ze(n,!0);try{return e.apply(this,arguments)}finally{ze(i,!1),r&&queueMicrotask(Ve)}}}function Ot(e){Promise===Je&&le.echoes===0?Zn===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}var oe=C.reject;function Bt(e,n,t,r){if(!e.idbdb||!e._state.openComplete&&!T.letThrough&&!e._vip){if(e._state.openComplete)return oe(new R.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._state.autoOpen)return oe(new R.DatabaseClosed);e.open().catch(Z)}return e._state.dbReadyPromise.then(function(){return Bt(e,n,t,r)})}else{var i=e._createTransaction(n,t,e._dbSchema);try{i.create(),e._state.PR1398_maxLoop=3}catch(a){return a.name===St.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then(function(){return Bt(e,n,t,r)})):oe(a)}return i._promise(n,function(a,o){return je(function(){return T.trans=i,r(a,o,i)})}).then(function(a){if(n==="readwrite")try{i.idbtrans.commit()}catch{}return n==="readonly"?a:i._completion.then(function(){return a})})}}var Ar="4.0.11",tn="\uFFFF",Ft=-1/0,Ie="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Dr="String expected.",mn=[],qn="__dbnames",Nt="readonly",Lt="readwrite";function rn(e,n){return e?n?function(){return e.apply(this,arguments)&&n.apply(this,arguments)}:e:n}var Tr={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function et(e){return typeof e=="string"&&!/\./.test(e)?function(n){return n[e]===void 0&&e in n&&(n=Me(n),delete n[e]),n}:function(n){return n}}function Mr(){throw R.Type()}function W(e,n){try{var t=Kr(e),r=Kr(n);if(t!==r)return t==="Array"?1:r==="Array"?-1:t==="binary"?1:r==="binary"?-1:t==="string"?1:r==="string"?-1:t==="Date"?1:r!=="Date"?NaN:-1;switch(t){case"number":case"Date":case"string":return e>n?1:e<n?-1:0;case"binary":return Vi(Rr(e),Rr(n));case"Array":return ji(e,n)}}catch{}return NaN}function ji(e,n){for(var t=e.length,r=n.length,i=t<r?t:r,a=0;a<i;++a){var o=W(e[a],n[a]);if(o!==0)return o}return t===r?0:t<r?-1:1}function Vi(e,n){for(var t=e.length,r=n.length,i=t<r?t:r,a=0;a<i;++a)if(e[a]!==n[a])return e[a]<n[a]?-1:1;return t===r?0:t<r?-1:1}function Kr(e){var n=typeof e;if(n!=="object")return n;if(ArrayBuffer.isView(e))return"binary";var t=me(e);return t==="ArrayBuffer"?"binary":t}function Rr(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var Ir=function(){function e(){}return e.prototype._trans=function(n,t,r){var i=this._tx||T.trans,a=this.name,o=Ce&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(n==="readonly"?"read":"write"," ").concat(this.name));function u(d,l,v){if(!v.schema[a])throw new R.NotFound("Table "+a+" not part of transaction");return t(v.idbtrans,v)}var s=hn();try{var c=i&&i.db._novip===this.db._novip?i===T.trans?i._promise(n,u,r):je(function(){return i._promise(n,u,r)},{trans:i,transless:T.transless||T}):Bt(this.db,n,[this.name],u);return o&&(c._consoleTask=o,c=c.catch(function(d){return console.trace(d),oe(d)})),c}finally{s&&vn()}},e.prototype.get=function(n,t){var r=this;return n&&n.constructor===Object?this.where(n).first(t):n==null?oe(new R.Type("Invalid argument to Table.get()")):this._trans("readonly",function(i){return r.core.get({trans:i,key:n}).then(function(a){return r.hook.reading.fire(a)})}).then(t)},e.prototype.where=function(n){if(typeof n=="string")return new this.db.WhereClause(this,n);if(F(n))return new this.db.WhereClause(this,"[".concat(n.join("+"),"]"));var t=j(n);if(t.length===1)return this.where(t[0]).equals(n[t[0]]);var r=this.schema.indexes.concat(this.schema.primKey).filter(function(d){if(d.compound&&t.every(function(v){return d.keyPath.indexOf(v)>=0})){for(var l=0;l<t.length;++l)if(t.indexOf(d.keyPath[l])===-1)return!1;return!0}return!1}).sort(function(d,l){return d.keyPath.length-l.keyPath.length})[0];if(r&&this.db._maxKey!==tn){var i=r.keyPath.slice(0,t.length);return this.where(i).equals(i.map(function(d){return n[d]}))}!r&&Ce&&console.warn("The query ".concat(JSON.stringify(n)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var a=this.schema.idxByName;function o(d,l){return W(d,l)===0}var u=t.reduce(function(d,l){var v=d[0],_=d[1],f=a[l],p=n[l];return[v||f,v||!f?rn(_,f&&f.multi?function(h){var b=X(h,l);return F(b)&&b.some(function(m){return o(p,m)})}:function(h){return o(p,X(h,l))}):_]},[null,null]),s=u[0],c=u[1];return s?this.where(s.name).equals(n[s.keyPath]).filter(c):r?this.filter(c):this.where(t).equals("")},e.prototype.filter=function(n){return this.toCollection().and(n)},e.prototype.count=function(n){return this.toCollection().count(n)},e.prototype.offset=function(n){return this.toCollection().offset(n)},e.prototype.limit=function(n){return this.toCollection().limit(n)},e.prototype.each=function(n){return this.toCollection().each(n)},e.prototype.toArray=function(n){return this.toCollection().toArray(n)},e.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},e.prototype.orderBy=function(n){return new this.db.Collection(new this.db.WhereClause(this,F(n)?"[".concat(n.join("+"),"]"):n))},e.prototype.reverse=function(){return this.toCollection().reverse()},e.prototype.mapToClass=function(n){var t=this,r=t.db,i=t.name;this.schema.mappedClass=n,n.prototype instanceof Mr&&(n=function(s){S(c,s);function c(){return s!==null&&s.apply(this,arguments)||this}return Object.defineProperty(c.prototype,"db",{get:function(){return r},enumerable:!1,configurable:!0}),c.prototype.table=function(){return i},c}(n));for(var a=new Set,o=n.prototype;o;o=G(o))Object.getOwnPropertyNames(o).forEach(function(s){return a.add(s)});var u=function(s){if(!s)return s;var c=Object.create(n.prototype);for(var d in s)if(!a.has(d))try{c[d]=s[d]}catch{}return c};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=u,this.hook("reading",u),n},e.prototype.defineClass=function(){function n(t){B(this,t)}return this.mapToClass(n)},e.prototype.add=function(n,t){var r=this,i=this.schema.primKey,a=i.auto,o=i.keyPath,u=n;return o&&a&&(u=et(o)(n)),this._trans("readwrite",function(s){return r.core.mutate({trans:s,type:"add",keys:t!=null?[t]:null,values:[u]})}).then(function(s){return s.numFailures?C.reject(s.failures[0]):s.lastResult}).then(function(s){if(o)try{U(n,o,s)}catch{}return s})},e.prototype.update=function(n,t){if(typeof n=="object"&&!F(n)){var r=X(n,this.schema.primKey.keyPath);return r===void 0?oe(new R.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(r).modify(t)}else return this.where(":id").equals(n).modify(t)},e.prototype.put=function(n,t){var r=this,i=this.schema.primKey,a=i.auto,o=i.keyPath,u=n;return o&&a&&(u=et(o)(n)),this._trans("readwrite",function(s){return r.core.mutate({trans:s,type:"put",values:[u],keys:t!=null?[t]:null})}).then(function(s){return s.numFailures?C.reject(s.failures[0]):s.lastResult}).then(function(s){if(o)try{U(n,o,s)}catch{}return s})},e.prototype.delete=function(n){var t=this;return this._trans("readwrite",function(r){return t.core.mutate({trans:r,type:"delete",keys:[n]})}).then(function(r){return r.numFailures?C.reject(r.failures[0]):void 0})},e.prototype.clear=function(){var n=this;return this._trans("readwrite",function(t){return n.core.mutate({trans:t,type:"deleteRange",range:Tr})}).then(function(t){return t.numFailures?C.reject(t.failures[0]):void 0})},e.prototype.bulkGet=function(n){var t=this;return this._trans("readonly",function(r){return t.core.getMany({keys:n,trans:r}).then(function(i){return i.map(function(a){return t.hook.reading.fire(a)})})})},e.prototype.bulkAdd=function(n,t,r){var i=this,a=Array.isArray(t)?t:void 0;r=r||(a?void 0:t);var o=r?r.allKeys:void 0;return this._trans("readwrite",function(u){var s=i.schema.primKey,c=s.auto,d=s.keyPath;if(d&&a)throw new R.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(a&&a.length!==n.length)throw new R.InvalidArgument("Arguments objects and keys must have the same length");var l=n.length,v=d&&c?n.map(et(d)):n;return i.core.mutate({trans:u,type:"add",keys:a,values:v,wantResults:o}).then(function(_){var f=_.numFailures,p=_.results,h=_.lastResult,b=_.failures,m=o?p:h;if(f===0)return m;throw new pn("".concat(i.name,".bulkAdd(): ").concat(f," of ").concat(l," operations failed"),b)})})},e.prototype.bulkPut=function(n,t,r){var i=this,a=Array.isArray(t)?t:void 0;r=r||(a?void 0:t);var o=r?r.allKeys:void 0;return this._trans("readwrite",function(u){var s=i.schema.primKey,c=s.auto,d=s.keyPath;if(d&&a)throw new R.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(a&&a.length!==n.length)throw new R.InvalidArgument("Arguments objects and keys must have the same length");var l=n.length,v=d&&c?n.map(et(d)):n;return i.core.mutate({trans:u,type:"put",keys:a,values:v,wantResults:o}).then(function(_){var f=_.numFailures,p=_.results,h=_.lastResult,b=_.failures,m=o?p:h;if(f===0)return m;throw new pn("".concat(i.name,".bulkPut(): ").concat(f," of ").concat(l," operations failed"),b)})})},e.prototype.bulkUpdate=function(n){var t=this,r=this.core,i=n.map(function(u){return u.key}),a=n.map(function(u){return u.changes}),o=[];return this._trans("readwrite",function(u){return r.getMany({trans:u,keys:i,cache:"clone"}).then(function(s){var c=[],d=[];n.forEach(function(v,_){var f=v.key,p=v.changes,h=s[_];if(h){for(var b=0,m=Object.keys(p);b<m.length;b++){var g=m[b],w=p[g];if(g===t.schema.primKey.keyPath){if(W(w,f)!==0)throw new R.Constraint("Cannot update primary key in bulkUpdate()")}else U(h,g,w)}o.push(_),c.push(f),d.push(h)}});var l=c.length;return r.mutate({trans:u,type:"put",keys:c,values:d,updates:{keys:i,changeSpecs:a}}).then(function(v){var _=v.numFailures,f=v.failures;if(_===0)return l;for(var p=0,h=Object.keys(f);p<h.length;p++){var b=h[p],m=o[Number(b)];if(m!=null){var g=f[b];delete f[b],f[m]=g}}throw new pn("".concat(t.name,".bulkUpdate(): ").concat(_," of ").concat(l," operations failed"),f)})})})},e.prototype.bulkDelete=function(n){var t=this,r=n.length;return this._trans("readwrite",function(i){return t.core.mutate({trans:i,type:"delete",keys:n})}).then(function(i){var a=i.numFailures,o=i.lastResult,u=i.failures;if(a===0)return o;throw new pn("".concat(t.name,".bulkDelete(): ").concat(a," of ").concat(r," operations failed"),u)})},e}();function Pn(e){var n={},t=function(u,s){if(s){for(var c=arguments.length,d=new Array(c-1);--c;)d[c-1]=arguments[c];return n[u].subscribe.apply(null,d),e}else if(typeof u=="string")return n[u]};t.addEventType=a;for(var r=1,i=arguments.length;r<i;++r)a(arguments[r]);return t;function a(u,s,c){if(typeof u=="object")return o(u);s||(s=Pi),c||(c=Z);var d={subscribers:[],fire:c,subscribe:function(l){d.subscribers.indexOf(l)===-1&&(d.subscribers.push(l),d.fire=s(d.fire,l))},unsubscribe:function(l){d.subscribers=d.subscribers.filter(function(v){return v!==l}),d.fire=d.subscribers.reduce(s,c)}};return n[u]=t[u]=d,d}function o(u){j(u).forEach(function(s){var c=u[s];if(F(c))a(s,u[s][0],u[s][1]);else if(c==="asap")var d=a(s,kn,function(){for(var v=arguments.length,_=new Array(v);v--;)_[v]=arguments[v];d.subscribers.forEach(function(f){z(function(){f.apply(null,_)})})});else throw new R.InvalidArgument("Invalid event config")})}}function An(e,n){return ve(n).from({prototype:e}),n}function zi(e){return An(Ir.prototype,function(t,r,i){this.db=e,this._tx=i,this.name=t,this.schema=r,this.hook=e._allTables[t]?e._allTables[t].hook:Pn(null,{creating:[Ei,Z],reading:[ki,kn],updating:[Ci,Z],deleting:[Si,Z]})})}function gn(e,n){return!(e.filter||e.algorithm||e.or)&&(n?e.justLimit:!e.replayFilter)}function jt(e,n){e.filter=rn(e.filter,n)}function Vt(e,n,t){var r=e.replayFilter;e.replayFilter=r?function(){return rn(r(),n())}:n,e.justLimit=t&&!r}function $i(e,n){e.isMatch=rn(e.isMatch,n)}function nt(e,n){if(e.isPrimKey)return n.primaryKey;var t=n.getIndexByKeyPath(e.index);if(!t)throw new R.Schema("KeyPath "+e.index+" on object store "+n.name+" is not indexed");return t}function Or(e,n,t){var r=nt(e,n.schema);return n.openCursor({trans:t,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:r,range:e.range}})}function tt(e,n,t,r){var i=e.replayFilter?rn(e.filter,e.replayFilter()):e.filter;if(e.or){var a={},o=function(u,s,c){if(!i||i(s,c,function(v){return s.stop(v)},function(v){return s.fail(v)})){var d=s.primaryKey,l=""+d;l==="[object ArrayBuffer]"&&(l=""+new Uint8Array(d)),H(a,l)||(a[l]=!0,n(u,s,c))}};return Promise.all([e.or._iterate(o,t),Br(Or(e,r,t),e.algorithm,o,!e.keysOnly&&e.valueMapper)])}else return Br(Or(e,r,t),rn(e.algorithm,i),n,!e.keysOnly&&e.valueMapper)}function Br(e,n,t,r){var i=r?function(o,u,s){return t(r(o),u,s)}:t,a=q(i);return e.then(function(o){if(o)return o.start(function(){var u=function(){return o.continue()};(!n||n(o,function(s){return u=s},function(s){o.stop(s),u=Z},function(s){o.fail(s),u=Z}))&&a(o.value,o,function(s){return u=s}),u()})})}var Dn=function(){function e(n){this["@@propmod"]=n}return e.prototype.execute=function(n){var t,r=this["@@propmod"];if(r.add!==void 0){var i=r.add;if(F(i))return N(N([],F(n)?n:[],!0),i,!0).sort();if(typeof i=="number")return(Number(n)||0)+i;if(typeof i=="bigint")try{return BigInt(n)+i}catch{return BigInt(0)+i}throw new TypeError("Invalid term ".concat(i))}if(r.remove!==void 0){var a=r.remove;if(F(a))return F(n)?n.filter(function(u){return!a.includes(u)}).sort():[];if(typeof a=="number")return Number(n)-a;if(typeof a=="bigint")try{return BigInt(n)-a}catch{return BigInt(0)-a}throw new TypeError("Invalid subtrahend ".concat(a))}var o=(t=r.replacePrefix)===null||t===void 0?void 0:t[0];return o&&typeof n=="string"&&n.startsWith(o)?r.replacePrefix[1]+n.substring(o.length):n},e}(),Ui=function(){function e(){}return e.prototype._read=function(n,t){var r=this._ctx;return r.error?r.table._trans(null,oe.bind(null,r.error)):r.table._trans("readonly",n).then(t)},e.prototype._write=function(n){var t=this._ctx;return t.error?t.table._trans(null,oe.bind(null,t.error)):t.table._trans("readwrite",n,"locked")},e.prototype._addAlgorithm=function(n){var t=this._ctx;t.algorithm=rn(t.algorithm,n)},e.prototype._iterate=function(n,t){return tt(this._ctx,n,t,this._ctx.table.core)},e.prototype.clone=function(n){var t=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return n&&B(r,n),t._ctx=r,t},e.prototype.raw=function(){return this._ctx.valueMapper=null,this},e.prototype.each=function(n){var t=this._ctx;return this._read(function(r){return tt(t,n,r,t.table.core)})},e.prototype.count=function(n){var t=this;return this._read(function(r){var i=t._ctx,a=i.table.core;if(gn(i,!0))return a.count({trans:r,query:{index:nt(i,a.schema),range:i.range}}).then(function(u){return Math.min(u,i.limit)});var o=0;return tt(i,function(){return++o,!1},r,a).then(function(){return o})}).then(n)},e.prototype.sortBy=function(n,t){var r=n.split(".").reverse(),i=r[0],a=r.length-1;function o(c,d){return d?o(c[r[d]],d-1):c[i]}var u=this._ctx.dir==="next"?1:-1;function s(c,d){var l=o(c,a),v=o(d,a);return W(l,v)*u}return this.toArray(function(c){return c.sort(s)}).then(t)},e.prototype.toArray=function(n){var t=this;return this._read(function(r){var i=t._ctx;if(i.dir==="next"&&gn(i,!0)&&i.limit>0){var a=i.valueMapper,o=nt(i,i.table.core.schema);return i.table.core.query({trans:r,limit:i.limit,values:!0,query:{index:o,range:i.range}}).then(function(s){var c=s.result;return a?c.map(a):c})}else{var u=[];return tt(i,function(s){return u.push(s)},r,i.table.core).then(function(){return u})}},n)},e.prototype.offset=function(n){var t=this._ctx;return n<=0?this:(t.offset+=n,gn(t)?Vt(t,function(){var r=n;return function(i,a){return r===0?!0:r===1?(--r,!1):(a(function(){i.advance(r),r=0}),!1)}}):Vt(t,function(){var r=n;return function(){return--r<0}}),this)},e.prototype.limit=function(n){return this._ctx.limit=Math.min(this._ctx.limit,n),Vt(this._ctx,function(){var t=n;return function(r,i,a){return--t<=0&&i(a),t>=0}},!0),this},e.prototype.until=function(n,t){return jt(this._ctx,function(r,i,a){return n(r.value)?(i(a),t):!0}),this},e.prototype.first=function(n){return this.limit(1).toArray(function(t){return t[0]}).then(n)},e.prototype.last=function(n){return this.reverse().first(n)},e.prototype.filter=function(n){return jt(this._ctx,function(t){return n(t.value)}),$i(this._ctx,n),this},e.prototype.and=function(n){return this.filter(n)},e.prototype.or=function(n){return new this.db.WhereClause(this._ctx.table,n,this)},e.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},e.prototype.desc=function(){return this.reverse()},e.prototype.eachKey=function(n){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(r,i){n(i.key,i)})},e.prototype.eachUniqueKey=function(n){return this._ctx.unique="unique",this.eachKey(n)},e.prototype.eachPrimaryKey=function(n){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(r,i){n(i.primaryKey,i)})},e.prototype.keys=function(n){var t=this._ctx;t.keysOnly=!t.isMatch;var r=[];return this.each(function(i,a){r.push(a.key)}).then(function(){return r}).then(n)},e.prototype.primaryKeys=function(n){var t=this._ctx;if(t.dir==="next"&&gn(t,!0)&&t.limit>0)return this._read(function(i){var a=nt(t,t.table.core.schema);return t.table.core.query({trans:i,values:!1,limit:t.limit,query:{index:a,range:t.range}})}).then(function(i){var a=i.result;return a}).then(n);t.keysOnly=!t.isMatch;var r=[];return this.each(function(i,a){r.push(a.primaryKey)}).then(function(){return r}).then(n)},e.prototype.uniqueKeys=function(n){return this._ctx.unique="unique",this.keys(n)},e.prototype.firstKey=function(n){return this.limit(1).keys(function(t){return t[0]}).then(n)},e.prototype.lastKey=function(n){return this.reverse().firstKey(n)},e.prototype.distinct=function(){var n=this._ctx,t=n.index&&n.table.schema.idxByName[n.index];if(!t||!t.multi)return this;var r={};return jt(this._ctx,function(i){var a=i.primaryKey.toString(),o=H(r,a);return r[a]=!0,!o}),this},e.prototype.modify=function(n){var t=this,r=this._ctx;return this._write(function(i){var a;if(typeof n=="function")a=n;else{var o=j(n),u=o.length;a=function(m){for(var g=!1,w=0;w<u;++w){var y=o[w],k=n[y],P=X(m,y);k instanceof Dn?(U(m,y,k.execute(P)),g=!0):P!==k&&(U(m,y,k),g=!0)}return g}}var s=r.table.core,c=s.schema.primaryKey,d=c.outbound,l=c.extractKey,v=200,_=t.db._options.modifyChunkSize;_&&(typeof _=="object"?v=_[s.name]||_["*"]||200:v=_);var f=[],p=0,h=[],b=function(m,g){var w=g.failures,y=g.numFailures;p+=m-y;for(var k=0,P=j(w);k<P.length;k++){var E=P[k];f.push(w[E])}};return t.clone().primaryKeys().then(function(m){var g=gn(r)&&r.limit===1/0&&(typeof n!="function"||n===zt)&&{index:r.index,range:r.range},w=function(y){var k=Math.min(v,m.length-y);return s.getMany({trans:i,keys:m.slice(y,y+k),cache:"immutable"}).then(function(P){for(var E=[],I=[],$=d?[]:null,D=[],V=0;V<k;++V){var O=P[V],Y={value:Me(O),primKey:m[y+V]};a.call(Y,Y.value,Y)!==!1&&(Y.value==null?D.push(m[y+V]):!d&&W(l(O),l(Y.value))!==0?(D.push(m[y+V]),E.push(Y.value)):(I.push(Y.value),d&&$.push(m[y+V])))}return Promise.resolve(E.length>0&&s.mutate({trans:i,type:"add",values:E}).then(function(K){for(var te in K.failures)D.splice(parseInt(te),1);b(E.length,K)})).then(function(){return(I.length>0||g&&typeof n=="object")&&s.mutate({trans:i,type:"put",keys:$,values:I,criteria:g,changeSpec:typeof n!="function"&&n,isAdditionalChunk:y>0}).then(function(K){return b(I.length,K)})}).then(function(){return(D.length>0||g&&n===zt)&&s.mutate({trans:i,type:"delete",keys:D,criteria:g,isAdditionalChunk:y>0}).then(function(K){return b(D.length,K)})}).then(function(){return m.length>y+k&&w(y+v)})})};return w(0).then(function(){if(f.length>0)throw new $n("Error modifying one or more objects",f,p,h);return m.length})})})},e.prototype.delete=function(){var n=this._ctx,t=n.range;return gn(n)&&(n.isPrimKey||t.type===3)?this._write(function(r){var i=n.table.core.schema.primaryKey,a=t;return n.table.core.count({trans:r,query:{index:i,range:a}}).then(function(o){return n.table.core.mutate({trans:r,type:"deleteRange",range:a}).then(function(u){var s=u.failures;u.lastResult,u.results;var c=u.numFailures;if(c)throw new $n("Could not delete some values",Object.keys(s).map(function(d){return s[d]}),o-c);return o-c})})}):this.modify(zt)},e}(),zt=function(e,n){return n.value=null};function Wi(e){return An(Ui.prototype,function(t,r){this.db=e;var i=Tr,a=null;if(r)try{i=r()}catch(c){a=c}var o=t._ctx,u=o.table,s=u.hook.reading.fire;this._ctx={table:u,index:o.index,isPrimKey:!o.index||u.schema.primKey.keyPath&&o.index===u.schema.primKey.name,range:i,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:a,or:o.or,valueMapper:s!==kn?s:null}})}function Hi(e,n){return e<n?-1:e===n?0:1}function Yi(e,n){return e>n?-1:e===n?0:1}function ge(e,n,t){var r=e instanceof Nr?new e.Collection(e):e;return r._ctx.error=t?new t(n):new TypeError(n),r}function bn(e){return new e.Collection(e,function(){return Fr("")}).limit(0)}function Qi(e){return e==="next"?function(n){return n.toUpperCase()}:function(n){return n.toLowerCase()}}function Gi(e){return e==="next"?function(n){return n.toLowerCase()}:function(n){return n.toUpperCase()}}function Zi(e,n,t,r,i,a){for(var o=Math.min(e.length,r.length),u=-1,s=0;s<o;++s){var c=n[s];if(c!==r[s])return i(e[s],t[s])<0?e.substr(0,s)+t[s]+t.substr(s+1):i(e[s],r[s])<0?e.substr(0,s)+r[s]+t.substr(s+1):u>=0?e.substr(0,u)+n[u]+t.substr(u+1):null;i(e[s],c)<0&&(u=s)}return o<r.length&&a==="next"?e+t.substr(e.length):o<e.length&&a==="prev"?e.substr(0,t.length):u<0?null:e.substr(0,u)+r[u]+t.substr(u+1)}function rt(e,n,t,r){var i,a,o,u,s,c,d,l=t.length;if(!t.every(function(p){return typeof p=="string"}))return ge(e,Dr);function v(p){i=Qi(p),a=Gi(p),o=p==="next"?Hi:Yi;var h=t.map(function(b){return{lower:a(b),upper:i(b)}}).sort(function(b,m){return o(b.lower,m.lower)});u=h.map(function(b){return b.upper}),s=h.map(function(b){return b.lower}),c=p,d=p==="next"?"":r}v("next");var _=new e.Collection(e,function(){return $e(u[0],s[l-1]+r)});_._ondirectionchange=function(p){v(p)};var f=0;return _._addAlgorithm(function(p,h,b){var m=p.key;if(typeof m!="string")return!1;var g=a(m);if(n(g,s,f))return!0;for(var w=null,y=f;y<l;++y){var k=Zi(m,g,u[y],s[y],o,c);k===null&&w===null?f=y+1:(w===null||o(w,k)>0)&&(w=k)}return h(w!==null?function(){p.continue(w+d)}:b),!1}),_}function $e(e,n,t,r){return{type:2,lower:e,upper:n,lowerOpen:t,upperOpen:r}}function Fr(e){return{type:1,lower:e,upper:e}}var Nr=function(){function e(){}return Object.defineProperty(e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),e.prototype.between=function(n,t,r,i){r=r!==!1,i=i===!0;try{return this._cmp(n,t)>0||this._cmp(n,t)===0&&(r||i)&&!(r&&i)?bn(this):new this.Collection(this,function(){return $e(n,t,!r,!i)})}catch{return ge(this,Ie)}},e.prototype.equals=function(n){return n==null?ge(this,Ie):new this.Collection(this,function(){return Fr(n)})},e.prototype.above=function(n){return n==null?ge(this,Ie):new this.Collection(this,function(){return $e(n,void 0,!0)})},e.prototype.aboveOrEqual=function(n){return n==null?ge(this,Ie):new this.Collection(this,function(){return $e(n,void 0,!1)})},e.prototype.below=function(n){return n==null?ge(this,Ie):new this.Collection(this,function(){return $e(void 0,n,!1,!0)})},e.prototype.belowOrEqual=function(n){return n==null?ge(this,Ie):new this.Collection(this,function(){return $e(void 0,n)})},e.prototype.startsWith=function(n){return typeof n!="string"?ge(this,Dr):this.between(n,n+tn,!0,!0)},e.prototype.startsWithIgnoreCase=function(n){return n===""?this.startsWith(n):rt(this,function(t,r){return t.indexOf(r[0])===0},[n],tn)},e.prototype.equalsIgnoreCase=function(n){return rt(this,function(t,r){return t===r[0]},[n],"")},e.prototype.anyOfIgnoreCase=function(){var n=Re.apply(fn,arguments);return n.length===0?bn(this):rt(this,function(t,r){return r.indexOf(t)!==-1},n,"")},e.prototype.startsWithAnyOfIgnoreCase=function(){var n=Re.apply(fn,arguments);return n.length===0?bn(this):rt(this,function(t,r){return r.some(function(i){return t.indexOf(i)===0})},n,tn)},e.prototype.anyOf=function(){var n=this,t=Re.apply(fn,arguments),r=this._cmp;try{t.sort(r)}catch{return ge(this,Ie)}if(t.length===0)return bn(this);var i=new this.Collection(this,function(){return $e(t[0],t[t.length-1])});i._ondirectionchange=function(o){r=o==="next"?n._ascending:n._descending,t.sort(r)};var a=0;return i._addAlgorithm(function(o,u,s){for(var c=o.key;r(c,t[a])>0;)if(++a,a===t.length)return u(s),!1;return r(c,t[a])===0?!0:(u(function(){o.continue(t[a])}),!1)}),i},e.prototype.notEqual=function(n){return this.inAnyRange([[Ft,n],[n,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},e.prototype.noneOf=function(){var n=Re.apply(fn,arguments);if(n.length===0)return new this.Collection(this);try{n.sort(this._ascending)}catch{return ge(this,Ie)}var t=n.reduce(function(r,i){return r?r.concat([[r[r.length-1][1],i]]):[[Ft,i]]},null);return t.push([n[n.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},e.prototype.inAnyRange=function(n,t){var r=this,i=this._cmp,a=this._ascending,o=this._descending,u=this._min,s=this._max;if(n.length===0)return bn(this);if(!n.every(function(y){return y[0]!==void 0&&y[1]!==void 0&&a(y[0],y[1])<=0}))return ge(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",R.InvalidArgument);var c=!t||t.includeLowers!==!1,d=t&&t.includeUppers===!0;function l(y,k){for(var P=0,E=y.length;P<E;++P){var I=y[P];if(i(k[0],I[1])<0&&i(k[1],I[0])>0){I[0]=u(I[0],k[0]),I[1]=s(I[1],k[1]);break}}return P===E&&y.push(k),y}var v=a;function _(y,k){return v(y[0],k[0])}var f;try{f=n.reduce(l,[]),f.sort(_)}catch{return ge(this,Ie)}var p=0,h=d?function(y){return a(y,f[p][1])>0}:function(y){return a(y,f[p][1])>=0},b=c?function(y){return o(y,f[p][0])>0}:function(y){return o(y,f[p][0])>=0};function m(y){return!h(y)&&!b(y)}var g=h,w=new this.Collection(this,function(){return $e(f[0][0],f[f.length-1][1],!c,!d)});return w._ondirectionchange=function(y){y==="next"?(g=h,v=a):(g=b,v=o),f.sort(_)},w._addAlgorithm(function(y,k,P){for(var E=y.key;g(E);)if(++p,p===f.length)return k(P),!1;return m(E)?!0:(r._cmp(E,f[p][1])===0||r._cmp(E,f[p][0])===0||k(function(){v===a?y.continue(f[p][0]):y.continue(f[p][1])}),!1)}),w},e.prototype.startsWithAnyOf=function(){var n=Re.apply(fn,arguments);return n.every(function(t){return typeof t=="string"})?n.length===0?bn(this):this.inAnyRange(n.map(function(t){return[t,t+tn]})):ge(this,"startsWithAnyOf() only works with strings")},e}();function Xi(e){return An(Nr.prototype,function(t,r,i){if(this.db=e,this._ctx={table:t,index:r===":id"?null:r,or:i},this._cmp=this._ascending=W,this._descending=function(a,o){return W(o,a)},this._max=function(a,o){return W(a,o)>0?a:o},this._min=function(a,o){return W(a,o)<0?a:o},this._IDBKeyRange=e._deps.IDBKeyRange,!this._IDBKeyRange)throw new R.MissingAPI})}function Pe(e){return q(function(n){return Tn(n),e(n.target.error),!1})}function Tn(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var Mn="storagemutated",$t="x-storagemutated-1",Ue=Pn(null,Mn),Ji=function(){function e(){}return e.prototype._lock=function(){return Ge(!T.global),++this._reculock,this._reculock===1&&!T.global&&(T.lockOwnerFor=this),this},e.prototype._unlock=function(){if(Ge(!T.global),--this._reculock===0)for(T.global||(T.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var n=this._blockedFuncs.shift();try{nn(n[1],n[0])}catch{}}return this},e.prototype._locked=function(){return this._reculock&&T.lockOwnerFor!==this},e.prototype.create=function(n){var t=this;if(!this.mode)return this;var r=this.db.idbdb,i=this.db._state.dbOpenError;if(Ge(!this.idbtrans),!n&&!r)switch(i&&i.name){case"DatabaseClosedError":throw new R.DatabaseClosed(i);case"MissingAPIError":throw new R.MissingAPI(i.message,i);default:throw new R.OpenFailed(i)}if(!this.active)throw new R.TransactionInactive;return Ge(this._completion._state===null),n=this.idbtrans=n||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):r.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})),n.onerror=q(function(a){Tn(a),t._reject(n.error)}),n.onabort=q(function(a){Tn(a),t.active&&t._reject(new R.Abort(n.error)),t.active=!1,t.on("abort").fire(a)}),n.oncomplete=q(function(){t.active=!1,t._resolve(),"mutatedParts"in n&&Ue.storagemutated.fire(n.mutatedParts)}),this},e.prototype._promise=function(n,t,r){var i=this;if(n==="readwrite"&&this.mode!=="readwrite")return oe(new R.ReadOnly("Transaction is readonly"));if(!this.active)return oe(new R.TransactionInactive);if(this._locked())return new C(function(o,u){i._blockedFuncs.push([function(){i._promise(n,t,r).then(o,u)},T])});if(r)return je(function(){var o=new C(function(u,s){i._lock();var c=t(u,s,i);c&&c.then&&c.then(u,s)});return o.finally(function(){return i._unlock()}),o._lib=!0,o});var a=new C(function(o,u){var s=t(o,u,i);s&&s.then&&s.then(o,u)});return a._lib=!0,a},e.prototype._root=function(){return this.parent?this.parent._root():this},e.prototype.waitFor=function(n){var t=this._root(),r=C.resolve(n);if(t._waitingFor)t._waitingFor=t._waitingFor.then(function(){return r});else{t._waitingFor=r,t._waitingQueue=[];var i=t.idbtrans.objectStore(t.storeNames[0]);(function o(){for(++t._spinCount;t._waitingQueue.length;)t._waitingQueue.shift()();t._waitingFor&&(i.get(-1/0).onsuccess=o)})()}var a=t._waitingFor;return new C(function(o,u){r.then(function(s){return t._waitingQueue.push(q(o.bind(null,s)))},function(s){return t._waitingQueue.push(q(u.bind(null,s)))}).finally(function(){t._waitingFor===a&&(t._waitingFor=null)})})},e.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new R.Abort))},e.prototype.table=function(n){var t=this._memoizedTables||(this._memoizedTables={});if(H(t,n))return t[n];var r=this.schema[n];if(!r)throw new R.NotFound("Table "+n+" not part of transaction");var i=new this.db.Table(n,r,this);return i.core=this.db.core.table(n),t[n]=i,i},e}();function qi(e){return An(Ji.prototype,function(t,r,i,a,o){var u=this;this.db=e,this.mode=t,this.storeNames=r,this.schema=i,this.chromeTransactionDurability=a,this.idbtrans=null,this.on=Pn(this,"complete","error","abort"),this.parent=o||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new C(function(s,c){u._resolve=s,u._reject=c}),this._completion.then(function(){u.active=!1,u.on.complete.fire()},function(s){var c=u.active;return u.active=!1,u.on.error.fire(s),u.parent?u.parent._reject(s):c&&u.idbtrans&&u.idbtrans.abort(),oe(s)})})}function Ut(e,n,t,r,i,a,o){return{name:e,keyPath:n,unique:t,multi:r,auto:i,compound:a,src:(t&&!o?"&":"")+(r?"*":"")+(i?"++":"")+Lr(n)}}function Lr(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function Wt(e,n,t){return{name:e,primKey:n,indexes:t,mappedClass:null,idxByName:ie(t,function(r){return[r.name,r]})}}function ea(e){return e.length===1?e[0]:e}var Kn=function(e){try{return e.only([[]]),Kn=function(){return[[]]},[[]]}catch{return Kn=function(){return tn},tn}};function Ht(e){return e==null?function(){}:typeof e=="string"?na(e):function(n){return X(n,e)}}function na(e){var n=e.split(".");return n.length===1?function(t){return t[e]}:function(t){return X(t,e)}}function jr(e){return[].slice.call(e)}var ta=0;function Rn(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function ra(e,n,t){function r(l,v){var _=jr(l.objectStoreNames);return{schema:{name:l.name,tables:_.map(function(f){return v.objectStore(f)}).map(function(f){var p=f.keyPath,h=f.autoIncrement,b=F(p),m=p==null,g={},w={name:f.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:m,compound:b,keyPath:p,autoIncrement:h,unique:!0,extractKey:Ht(p)},indexes:jr(f.indexNames).map(function(y){return f.index(y)}).map(function(y){var k=y.name,P=y.unique,E=y.multiEntry,I=y.keyPath,$=F(I),D={name:k,compound:$,keyPath:I,unique:P,multiEntry:E,extractKey:Ht(I)};return g[Rn(I)]=D,D}),getIndexByKeyPath:function(y){return g[Rn(y)]}};return g[":id"]=w.primaryKey,p!=null&&(g[Rn(p)]=w.primaryKey),w})},hasGetAll:_.length>0&&"getAll"in v.objectStore(_[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function i(l){if(l.type===3)return null;if(l.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var v=l.lower,_=l.upper,f=l.lowerOpen,p=l.upperOpen,h=v===void 0?_===void 0?null:n.upperBound(_,!!p):_===void 0?n.lowerBound(v,!!f):n.bound(v,_,!!f,!!p);return h}function a(l){var v=l.name;function _(h){var b=h.trans,m=h.type,g=h.keys,w=h.values,y=h.range;return new Promise(function(k,P){k=q(k);var E=b.objectStore(v),I=E.keyPath==null,$=m==="put"||m==="add";if(!$&&m!=="delete"&&m!=="deleteRange")throw new Error("Invalid operation type: "+m);var D=(g||w||{length:1}).length;if(g&&w&&g.length!==w.length)throw new Error("Given keys array must have same length as given values array.");if(D===0)return k({numFailures:0,failures:{},results:[],lastResult:void 0});var V,O=[],Y=[],K=0,te=function(De){++K,Tn(De)};if(m==="deleteRange"){if(y.type===4)return k({numFailures:K,failures:Y,results:[],lastResult:void 0});y.type===3?O.push(V=E.clear()):O.push(V=E.delete(i(y)))}else{var de=$?I?[w,g]:[w,null]:[g,null],Ae=de[0],he=de[1];if($)for(var _e=0;_e<D;++_e)O.push(V=he&&he[_e]!==void 0?E[m](Ae[_e],he[_e]):E[m](Ae[_e])),V.onerror=te;else for(var _e=0;_e<D;++_e)O.push(V=E[m](Ae[_e])),V.onerror=te}var Ye=function(De){var Bn=De.target.result;O.forEach(function(ke,vt){return ke.error!=null&&(Y[vt]=ke.error)}),k({numFailures:K,failures:Y,results:m==="delete"?g:O.map(function(ke){return ke.result}),lastResult:Bn})};V.onerror=function(De){te(De),Ye(De)},V.onsuccess=Ye})}function f(h){var b=h.trans,m=h.values,g=h.query,w=h.reverse,y=h.unique;return new Promise(function(k,P){k=q(k);var E=g.index,I=g.range,$=b.objectStore(v),D=E.isPrimaryKey?$:$.index(E.name),V=w?y?"prevunique":"prev":y?"nextunique":"next",O=m||!("openKeyCursor"in D)?D.openCursor(i(I),V):D.openKeyCursor(i(I),V);O.onerror=Pe(P),O.onsuccess=q(function(Y){var K=O.result;if(!K){k(null);return}K.___id=++ta,K.done=!1;var te=K.continue.bind(K),de=K.continuePrimaryKey;de&&(de=de.bind(K));var Ae=K.advance.bind(K),he=function(){throw new Error("Cursor not started")},_e=function(){throw new Error("Cursor not stopped")};K.trans=b,K.stop=K.continue=K.continuePrimaryKey=K.advance=he,K.fail=q(P),K.next=function(){var Ye=this,De=1;return this.start(function(){return De--?Ye.continue():Ye.stop()}).then(function(){return Ye})},K.start=function(Ye){var De=new Promise(function(ke,vt){ke=q(ke),O.onerror=Pe(vt),K.fail=vt,K.stop=function(Ua){K.stop=K.continue=K.continuePrimaryKey=K.advance=_e,ke(Ua)}}),Bn=function(){if(O.result)try{Ye()}catch(ke){K.fail(ke)}else K.done=!0,K.start=function(){throw new Error("Cursor behind last entry")},K.stop()};return O.onsuccess=q(function(ke){O.onsuccess=Bn,Bn()}),K.continue=te,K.continuePrimaryKey=de,K.advance=Ae,Bn(),De},k(K)},P)})}function p(h){return function(b){return new Promise(function(m,g){m=q(m);var w=b.trans,y=b.values,k=b.limit,P=b.query,E=k===1/0?void 0:k,I=P.index,$=P.range,D=w.objectStore(v),V=I.isPrimaryKey?D:D.index(I.name),O=i($);if(k===0)return m({result:[]});if(h){var Y=y?V.getAll(O,E):V.getAllKeys(O,E);Y.onsuccess=function(Ae){return m({result:Ae.target.result})},Y.onerror=Pe(g)}else{var K=0,te=y||!("openKeyCursor"in V)?V.openCursor(O):V.openKeyCursor(O),de=[];te.onsuccess=function(Ae){var he=te.result;if(!he)return m({result:de});if(de.push(y?he.value:he.primaryKey),++K===k)return m({result:de});he.continue()},te.onerror=Pe(g)}})}}return{name:v,schema:l,mutate:_,getMany:function(h){var b=h.trans,m=h.keys;return new Promise(function(g,w){g=q(g);for(var y=b.objectStore(v),k=m.length,P=new Array(k),E=0,I=0,$,D=function(K){var te=K.target;(P[te._pos]=te.result)!=null,++I===E&&g(P)},V=Pe(w),O=0;O<k;++O){var Y=m[O];Y!=null&&($=y.get(m[O]),$._pos=O,$.onsuccess=D,$.onerror=V,++E)}E===0&&g(P)})},get:function(h){var b=h.trans,m=h.key;return new Promise(function(g,w){g=q(g);var y=b.objectStore(v),k=y.get(m);k.onsuccess=function(P){return g(P.target.result)},k.onerror=Pe(w)})},query:p(s),openCursor:f,count:function(h){var b=h.query,m=h.trans,g=b.index,w=b.range;return new Promise(function(y,k){var P=m.objectStore(v),E=g.isPrimaryKey?P:P.index(g.name),I=i(w),$=I?E.count(I):E.count();$.onsuccess=q(function(D){return y(D.target.result)}),$.onerror=Pe(k)})}}}var o=r(e,t),u=o.schema,s=o.hasGetAll,c=u.tables.map(function(l){return a(l)}),d={};return c.forEach(function(l){return d[l.name]=l}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(l){var v=d[l];if(!v)throw new Error("Table '".concat(l,"' not found"));return d[l]},MIN_KEY:-1/0,MAX_KEY:Kn(n),schema:u}}function ia(e,n){return n.reduce(function(t,r){var i=r.create;return x(x({},t),i(t))},e)}function aa(e,n,t,r){var i=t.IDBKeyRange;t.indexedDB;var a=ia(ra(n,i,r),e.dbcore);return{dbcore:a}}function it(e,n){var t=n.db,r=aa(e._middlewares,t,e._deps,n);e.core=r.dbcore,e.tables.forEach(function(i){var a=i.name;e.core.schema.tables.some(function(o){return o.name===a})&&(i.core=e.core.table(a),e[a]instanceof e.Table&&(e[a].core=i.core))})}function at(e,n,t,r){t.forEach(function(i){var a=r[i];n.forEach(function(o){var u=Ne(o,i);(!u||"value"in u&&u.value===void 0)&&(o===e.Transaction.prototype||o instanceof e.Transaction?re(o,i,{get:function(){return this.table(i)},set:function(s){ce(this,i,{value:s,writable:!0,configurable:!0,enumerable:!0})}}):o[i]=new e.Table(i,a))})})}function Yt(e,n){n.forEach(function(t){for(var r in t)t[r]instanceof e.Table&&delete t[r]})}function oa(e,n){return e._cfg.version-n._cfg.version}function ua(e,n,t,r){var i=e._dbSchema;t.objectStoreNames.contains("$meta")&&!i.$meta&&(i.$meta=Wt("$meta",zr("")[0],[]),e._storeNames.push("$meta"));var a=e._createTransaction("readwrite",e._storeNames,i);a.create(t),a._completion.catch(r);var o=a._reject.bind(a),u=T.transless||T;je(function(){if(T.trans=a,T.transless=u,n===0)j(i).forEach(function(s){Gt(t,s,i[s].primKey,i[s].indexes)}),it(e,t),C.follow(function(){return e.on.populate.fire(a)}).catch(o);else return it(e,t),ca(e,a,n).then(function(s){return la(e,s,a,t)}).catch(o)})}function sa(e,n){Vr(e._dbSchema,n),n.db.version%10===0&&!n.objectStoreNames.contains("$meta")&&n.db.createObjectStore("$meta").add(Math.ceil(n.db.version/10-1),"version");var t=ut(e,e.idbdb,n);st(e,e._dbSchema,n);for(var r=Qt(t,e._dbSchema),i=function(c){if(c.change.length||c.recreate)return console.warn("Unable to patch indexes of table ".concat(c.name," because it has changes on the type of index or primary key.")),{value:void 0};var d=n.objectStore(c.name);c.add.forEach(function(l){Ce&&console.debug("Dexie upgrade patch: Creating missing index ".concat(c.name,".").concat(l.src)),ot(d,l)})},a=0,o=r.change;a<o.length;a++){var u=o[a],s=i(u);if(typeof s=="object")return s.value}}function ca(e,n,t){return n.storeNames.includes("$meta")?n.table("$meta").get("version").then(function(r){return r??t}):C.resolve(t)}function la(e,n,t,r){var i=[],a=e._versions,o=e._dbSchema=ut(e,e.idbdb,r),u=a.filter(function(c){return c._cfg.version>=n});if(u.length===0)return C.resolve();u.forEach(function(c){i.push(function(){var d=o,l=c._cfg.dbschema;st(e,d,r),st(e,l,r),o=e._dbSchema=l;var v=Qt(d,l);v.add.forEach(function(m){Gt(r,m[0],m[1].primKey,m[1].indexes)}),v.change.forEach(function(m){if(m.recreate)throw new R.Upgrade("Not yet support for changing primary key");var g=r.objectStore(m.name);m.add.forEach(function(w){return ot(g,w)}),m.change.forEach(function(w){g.deleteIndex(w.name),ot(g,w)}),m.del.forEach(function(w){return g.deleteIndex(w)})});var _=c._cfg.contentUpgrade;if(_&&c._cfg.version>n){it(e,r),t._memoizedTables={};var f=ne(l);v.del.forEach(function(m){f[m]=d[m]}),Yt(e,[e.Transaction.prototype]),at(e,[e.Transaction.prototype],j(f),f),t.schema=f;var p=kt(_);p&&yn();var h,b=C.follow(function(){if(h=_(t),h&&p){var m=Ve.bind(null,null);h.then(m,m)}});return h&&typeof h.then=="function"?C.resolve(h):b.then(function(){return h})}}),i.push(function(d){var l=c._cfg.dbschema;fa(l,d),Yt(e,[e.Transaction.prototype]),at(e,[e.Transaction.prototype],e._storeNames,e._dbSchema),t.schema=e._dbSchema}),i.push(function(d){e.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(e.idbdb.version/10)===c._cfg.version?(e.idbdb.deleteObjectStore("$meta"),delete e._dbSchema.$meta,e._storeNames=e._storeNames.filter(function(l){return l!=="$meta"})):d.objectStore("$meta").put(c._cfg.version,"version"))})});function s(){return i.length?C.resolve(i.shift()(t.idbtrans)).then(s):C.resolve()}return s().then(function(){Vr(o,r)})}function Qt(e,n){var t={del:[],add:[],change:[]},r;for(r in e)n[r]||t.del.push(r);for(r in n){var i=e[r],a=n[r];if(!i)t.add.push([r,a]);else{var o={name:r,def:a,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(a.primKey.keyPath||"")||i.primKey.auto!==a.primKey.auto)o.recreate=!0,t.change.push(o);else{var u=i.idxByName,s=a.idxByName,c=void 0;for(c in u)s[c]||o.del.push(c);for(c in s){var d=u[c],l=s[c];d?d.src!==l.src&&o.change.push(l):o.add.push(l)}(o.del.length>0||o.add.length>0||o.change.length>0)&&t.change.push(o)}}}return t}function Gt(e,n,t,r){var i=e.db.createObjectStore(n,t.keyPath?{keyPath:t.keyPath,autoIncrement:t.auto}:{autoIncrement:t.auto});return r.forEach(function(a){return ot(i,a)}),i}function Vr(e,n){j(e).forEach(function(t){n.db.objectStoreNames.contains(t)||(Ce&&console.debug("Dexie: Creating missing table",t),Gt(n,t,e[t].primKey,e[t].indexes))})}function fa(e,n){[].slice.call(n.db.objectStoreNames).forEach(function(t){return e[t]==null&&n.db.deleteObjectStore(t)})}function ot(e,n){e.createIndex(n.name,n.keyPath,{unique:n.unique,multiEntry:n.multi})}function ut(e,n,t){var r={},i=Qe(n.objectStoreNames,0);return i.forEach(function(a){for(var o=t.objectStore(a),u=o.keyPath,s=Ut(Lr(u),u||"",!0,!1,!!o.autoIncrement,u&&typeof u!="string",!0),c=[],d=0;d<o.indexNames.length;++d){var l=o.index(o.indexNames[d]);u=l.keyPath;var v=Ut(l.name,u,!!l.unique,!!l.multiEntry,!1,u&&typeof u!="string",!1);c.push(v)}r[a]=Wt(a,s,c)}),r}function da(e,n,t){e.verno=n.version/10;var r=e._dbSchema=ut(e,n,t);e._storeNames=Qe(n.objectStoreNames,0),at(e,[e._allTables],j(r),r)}function pa(e,n){var t=ut(e,e.idbdb,n),r=Qt(t,e._dbSchema);return!(r.add.length||r.change.some(function(i){return i.add.length||i.change.length}))}function st(e,n,t){for(var r=t.db.objectStoreNames,i=0;i<r.length;++i){var a=r[i],o=t.objectStore(a);e._hasGetAll="getAll"in o;for(var u=0;u<o.indexNames.length;++u){var s=o.indexNames[u],c=o.index(s).keyPath,d=typeof c=="string"?c:"["+Qe(c).join("+")+"]";if(n[a]){var l=n[a].idxByName[d];l&&(l.name=s,delete n[a].idxByName[d],n[a].idxByName[s]=l)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&M.WorkerGlobalScope&&M instanceof M.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function zr(e){return e.split(",").map(function(n,t){n=n.trim();var r=n.replace(/([&*]|\+\+)/g,""),i=/^\[/.test(r)?r.match(/^\[(.*)\]$/)[1].split("+"):r;return Ut(r,i||null,/\&/.test(n),/\*/.test(n),/\+\+/.test(n),F(i),t===0)})}var ha=function(){function e(){}return e.prototype._parseStoresSpec=function(n,t){j(n).forEach(function(r){if(n[r]!==null){var i=zr(n[r]),a=i.shift();if(a.unique=!0,a.multi)throw new R.Schema("Primary key cannot be multi-valued");i.forEach(function(o){if(o.auto)throw new R.Schema("Only primary key can be marked as autoIncrement (++)");if(!o.keyPath)throw new R.Schema("Index must have a name and cannot be an empty string")}),t[r]=Wt(r,a,i)}})},e.prototype.stores=function(n){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?B(this._cfg.storesSource,n):n;var r=t._versions,i={},a={};return r.forEach(function(o){B(i,o._cfg.storesSource),a=o._cfg.dbschema={},o._parseStoresSpec(i,a)}),t._dbSchema=a,Yt(t,[t._allTables,t,t.Transaction.prototype]),at(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],j(a),a),t._storeNames=j(a),this},e.prototype.upgrade=function(n){return this._cfg.contentUpgrade=Ct(this._cfg.contentUpgrade||Z,n),this},e}();function va(e){return An(ha.prototype,function(t){this.db=e,this._cfg={version:t,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}function Zt(e,n){var t=e._dbNamesDB;return t||(t=e._dbNamesDB=new Oe(qn,{addons:[],indexedDB:e,IDBKeyRange:n}),t.version(1).stores({dbnames:"name"})),t.table("dbnames")}function Xt(e){return e&&typeof e.databases=="function"}function ya(e){var n=e.indexedDB,t=e.IDBKeyRange;return Xt(n)?Promise.resolve(n.databases()).then(function(r){return r.map(function(i){return i.name}).filter(function(i){return i!==qn})}):Zt(n,t).toCollection().primaryKeys()}function ma(e,n){var t=e.indexedDB,r=e.IDBKeyRange;!Xt(t)&&n!==qn&&Zt(t,r).put({name:n}).catch(Z)}function ga(e,n){var t=e.indexedDB,r=e.IDBKeyRange;!Xt(t)&&n!==qn&&Zt(t,r).delete(n).catch(Z)}function Jt(e){return je(function(){return T.letThrough=!0,e()})}function ba(){var e=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!e||!indexedDB.databases)return Promise.resolve();var n;return new Promise(function(t){var r=function(){return indexedDB.databases().finally(t)};n=setInterval(r,100),r()}).finally(function(){return clearInterval(n)})}var qt;function er(e){return!("from"in e)}var fe=function(e,n){if(this)B(this,arguments.length?{d:1,from:e,to:arguments.length>1?n:e}:{d:0});else{var t=new fe;return e&&"d"in e&&B(t,e),t}};J(fe.prototype,(qt={add:function(e){return On(this,e),this},addKey:function(e){return In(this,e,e),this},addKeys:function(e){var n=this;return e.forEach(function(t){return In(n,t,t)}),this},hasKey:function(e){var n=ct(this).next(e).value;return n&&W(n.from,e)<=0&&W(n.to,e)>=0}},qt[Se]=function(){return ct(this)},qt));function In(e,n,t){var r=W(n,t);if(!isNaN(r)){if(r>0)throw RangeError();if(er(e))return B(e,{from:n,to:t,d:1});var i=e.l,a=e.r;if(W(t,e.from)<0)return i?In(i,n,t):e.l={from:n,to:t,d:1,l:null,r:null},Ur(e);if(W(n,e.to)>0)return a?In(a,n,t):e.r={from:n,to:t,d:1,l:null,r:null},Ur(e);W(n,e.from)<0&&(e.from=n,e.l=null,e.d=a?a.d+1:1),W(t,e.to)>0&&(e.to=t,e.r=null,e.d=e.l?e.l.d+1:1);var o=!e.r;i&&!e.l&&On(e,i),a&&o&&On(e,a)}}function On(e,n){function t(r,i){var a=i.from,o=i.to,u=i.l,s=i.r;In(r,a,o),u&&t(r,u),s&&t(r,s)}er(n)||t(e,n)}function $r(e,n){var t=ct(n),r=t.next();if(r.done)return!1;for(var i=r.value,a=ct(e),o=a.next(i.from),u=o.value;!r.done&&!o.done;){if(W(u.from,i.to)<=0&&W(u.to,i.from)>=0)return!0;W(i.from,u.from)<0?i=(r=t.next(u.from)).value:u=(o=a.next(i.from)).value}return!1}function ct(e){var n=er(e)?null:{s:0,n:e};return{next:function(t){for(var r=arguments.length>0;n;)switch(n.s){case 0:if(n.s=1,r)for(;n.n.l&&W(t,n.n.from)<0;)n={up:n,n:n.n.l,s:1};else for(;n.n.l;)n={up:n,n:n.n.l,s:1};case 1:if(n.s=2,!r||W(t,n.n.to)<=0)return{value:n.n,done:!1};case 2:if(n.n.r){n.s=3,n={up:n,n:n.n.r,s:0};continue}case 3:n=n.up}return{done:!0}}}}function Ur(e){var n,t,r=(((n=e.r)===null||n===void 0?void 0:n.d)||0)-(((t=e.l)===null||t===void 0?void 0:t.d)||0),i=r>1?"r":r<-1?"l":"";if(i){var a=i==="r"?"l":"r",o=x({},e),u=e[i];e.from=u.from,e.to=u.to,e[i]=u[i],o[i]=u[a],e[a]=o,o.d=Wr(o)}e.d=Wr(e)}function Wr(e){var n=e.r,t=e.l;return(n?t?Math.max(n.d,t.d):n.d:t?t.d:0)+1}function lt(e,n){return j(n).forEach(function(t){e[t]?On(e[t],n[t]):e[t]=zn(n[t])}),e}function nr(e,n){return e.all||n.all||Object.keys(e).some(function(t){return n[t]&&$r(n[t],e[t])})}var an={},tr={},rr=!1;function ft(e,n){lt(tr,e),rr||(rr=!0,setTimeout(function(){rr=!1;var t=tr;tr={},ir(t,!1)},0))}function ir(e,n){n===void 0&&(n=!1);var t=new Set;if(e.all)for(var r=0,i=Object.values(an);r<i.length;r++){var a=i[r];Hr(a,e,t,n)}else for(var o in e){var u=/^idb\:\/\/(.*)\/(.*)\//.exec(o);if(u){var s=u[1],c=u[2],a=an["idb://".concat(s,"/").concat(c)];a&&Hr(a,e,t,n)}}t.forEach(function(d){return d()})}function Hr(e,n,t,r){for(var i=[],a=0,o=Object.entries(e.queries.query);a<o.length;a++){for(var u=o[a],s=u[0],c=u[1],d=[],l=0,v=c;l<v.length;l++){var _=v[l];nr(n,_.obsSet)?_.subscribers.forEach(function(b){return t.add(b)}):r&&d.push(_)}r&&i.push([s,d])}if(r)for(var f=0,p=i;f<p.length;f++){var h=p[f],s=h[0],d=h[1];e.queries.query[s]=d}}function wa(e){var n=e._state,t=e._deps.indexedDB;if(n.isBeingOpened||e.idbdb)return n.dbReadyPromise.then(function(){return n.dbOpenError?oe(n.dbOpenError):e});n.isBeingOpened=!0,n.dbOpenError=null,n.openComplete=!1;var r=n.openCanceller,i=Math.round(e.verno*10),a=!1;function o(){if(n.openCanceller!==r)throw new R.DatabaseClosed("db.open() was cancelled")}var u=n.dbReadyResolve,s=null,c=!1,d=function(){return new C(function(l,v){if(o(),!t)throw new R.MissingAPI;var _=e.name,f=n.autoSchema||!i?t.open(_):t.open(_,i);if(!f)throw new R.MissingAPI;f.onerror=Pe(v),f.onblocked=q(e._fireOnBlocked),f.onupgradeneeded=q(function(p){if(s=f.transaction,n.autoSchema&&!e._options.allowEmptyDB){f.onerror=Tn,s.abort(),f.result.close();var h=t.deleteDatabase(_);h.onsuccess=h.onerror=q(function(){v(new R.NoSuchDatabase("Database ".concat(_," doesnt exist")))})}else{s.onerror=Pe(v);var b=p.oldVersion>Math.pow(2,62)?0:p.oldVersion;c=b<1,e.idbdb=f.result,a&&sa(e,s),ua(e,b/10,s,v)}},v),f.onsuccess=q(function(){s=null;var p=e.idbdb=f.result,h=Qe(p.objectStoreNames);if(h.length>0)try{var b=p.transaction(ea(h),"readonly");if(n.autoSchema)da(e,p,b);else if(st(e,e._dbSchema,b),!pa(e,b)&&!a)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),p.close(),i=p.version+1,a=!0,l(d());it(e,b)}catch{}mn.push(e),p.onversionchange=q(function(m){n.vcFired=!0,e.on("versionchange").fire(m)}),p.onclose=q(function(m){e.on("close").fire(m)}),c&&ma(e._deps,_),l()},v)}).catch(function(l){switch(l?.name){case"UnknownError":if(n.PR1398_maxLoop>0)return n.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),d();break;case"VersionError":if(i>0)return i=0,d();break}return C.reject(l)})};return C.race([r,(typeof navigator>"u"?C.resolve():ba()).then(d)]).then(function(){return o(),n.onReadyBeingFired=[],C.resolve(Jt(function(){return e.on.ready.fire(e.vip)})).then(function l(){if(n.onReadyBeingFired.length>0){var v=n.onReadyBeingFired.reduce(Ct,Z);return n.onReadyBeingFired=[],C.resolve(Jt(function(){return v(e.vip)})).then(l)}})}).finally(function(){n.openCanceller===r&&(n.onReadyBeingFired=null,n.isBeingOpened=!1)}).catch(function(l){n.dbOpenError=l;try{s&&s.abort()}catch{}return r===n.openCanceller&&e._close(),oe(l)}).finally(function(){n.openComplete=!0,u()}).then(function(){if(c){var l={};e.tables.forEach(function(v){v.schema.indexes.forEach(function(_){_.name&&(l["idb://".concat(e.name,"/").concat(v.name,"/").concat(_.name)]=new fe(-1/0,[[[]]]))}),l["idb://".concat(e.name,"/").concat(v.name,"/")]=l["idb://".concat(e.name,"/").concat(v.name,"/:dels")]=new fe(-1/0,[[[]]])}),Ue(Mn).fire(l),ir(l,!0)}return e})}function ar(e){var n=function(o){return e.next(o)},t=function(o){return e.throw(o)},r=a(n),i=a(t);function a(o){return function(u){var s=o(u),c=s.value;return s.done?c:!c||typeof c.then!="function"?F(c)?Promise.all(c).then(r,i):r(c):c.then(r,i)}}return a(n)()}function _a(e,n,t){var r=arguments.length;if(r<2)throw new R.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];t=i.pop();var a=we(i);return[e,a,t]}function Yr(e,n,t,r,i){return C.resolve().then(function(){var a=T.transless||T,o=e._createTransaction(n,t,e._dbSchema,r);o.explicit=!0;var u={trans:o,transless:a};if(r)o.idbtrans=r.idbtrans;else try{o.create(),o.idbtrans._explicit=!0,e._state.PR1398_maxLoop=3}catch(l){return l.name===St.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then(function(){return Yr(e,n,t,null,i)})):oe(l)}var s=kt(i);s&&yn();var c,d=C.follow(function(){if(c=i.call(o,o),c)if(s){var l=Ve.bind(null,null);c.then(l,l)}else typeof c.next=="function"&&typeof c.throw=="function"&&(c=ar(c))},u);return(c&&typeof c.then=="function"?C.resolve(c).then(function(l){return o.active?l:oe(new R.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):d.then(function(){return c})).then(function(l){return r&&o._resolve(),o._completion.then(function(){return l})}).catch(function(l){return o._reject(l),oe(l)})})}function dt(e,n,t){for(var r=F(e)?e.slice():[e],i=0;i<t;++i)r.push(n);return r}function xa(e){return x(x({},e),{table:function(n){var t=e.table(n),r=t.schema,i={},a=[];function o(p,h,b){var m=Rn(p),g=i[m]=i[m]||[],w=p==null?0:typeof p=="string"?1:p.length,y=h>0,k=x(x({},b),{name:y?"".concat(m,"(virtual-from:").concat(b.name,")"):b.name,lowLevelIndex:b,isVirtual:y,keyTail:h,keyLength:w,extractKey:Ht(p),unique:!y&&b.unique});if(g.push(k),k.isPrimaryKey||a.push(k),w>1){var P=w===2?p[0]:p.slice(0,w-1);o(P,h+1,b)}return g.sort(function(E,I){return E.keyTail-I.keyTail}),k}var u=o(r.primaryKey.keyPath,0,r.primaryKey);i[":id"]=[u];for(var s=0,c=r.indexes;s<c.length;s++){var d=c[s];o(d.keyPath,0,d)}function l(p){var h=i[Rn(p)];return h&&h[0]}function v(p,h){return{type:p.type===1?2:p.type,lower:dt(p.lower,p.lowerOpen?e.MAX_KEY:e.MIN_KEY,h),lowerOpen:!0,upper:dt(p.upper,p.upperOpen?e.MIN_KEY:e.MAX_KEY,h),upperOpen:!0}}function _(p){var h=p.query.index;return h.isVirtual?x(x({},p),{query:{index:h.lowLevelIndex,range:v(p.query.range,h.keyTail)}}):p}var f=x(x({},t),{schema:x(x({},r),{primaryKey:u,indexes:a,getIndexByKeyPath:l}),count:function(p){return t.count(_(p))},query:function(p){return t.query(_(p))},openCursor:function(p){var h=p.query.index,b=h.keyTail,m=h.isVirtual,g=h.keyLength;if(!m)return t.openCursor(p);function w(y){function k(E){E!=null?y.continue(dt(E,p.reverse?e.MAX_KEY:e.MIN_KEY,b)):p.unique?y.continue(y.key.slice(0,g).concat(p.reverse?e.MIN_KEY:e.MAX_KEY,b)):y.continue()}var P=Object.create(y,{continue:{value:k},continuePrimaryKey:{value:function(E,I){y.continuePrimaryKey(dt(E,e.MAX_KEY,b),I)}},primaryKey:{get:function(){return y.primaryKey}},key:{get:function(){var E=y.key;return g===1?E[0]:E.slice(0,g)}},value:{get:function(){return y.value}}});return P}return t.openCursor(_(p)).then(function(y){return y&&w(y)})}});return f}})}var ka={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:xa};function or(e,n,t,r){return t=t||{},r=r||"",j(e).forEach(function(i){if(!H(n,i))t[r+i]=void 0;else{var a=e[i],o=n[i];if(typeof a=="object"&&typeof o=="object"&&a&&o){var u=me(a),s=me(o);u!==s?t[r+i]=n[i]:u==="Object"?or(a,o,t,r+i+"."):a!==o&&(t[r+i]=n[i])}else a!==o&&(t[r+i]=n[i])}}),j(n).forEach(function(i){H(e,i)||(t[r+i]=n[i])}),t}function ur(e,n){return n.type==="delete"?n.keys:n.keys||n.values.map(e.extractKey)}var Ea={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return x(x({},e),{table:function(n){var t=e.table(n),r=t.schema.primaryKey,i=x(x({},t),{mutate:function(a){var o=T.trans,u=o.table(n).hook,s=u.deleting,c=u.creating,d=u.updating;switch(a.type){case"add":if(c.fire===Z)break;return o._promise("readwrite",function(){return l(a)},!0);case"put":if(c.fire===Z&&d.fire===Z)break;return o._promise("readwrite",function(){return l(a)},!0);case"delete":if(s.fire===Z)break;return o._promise("readwrite",function(){return l(a)},!0);case"deleteRange":if(s.fire===Z)break;return o._promise("readwrite",function(){return v(a)},!0)}return t.mutate(a);function l(f){var p=T.trans,h=f.keys||ur(r,f);if(!h)throw new Error("Keys missing");return f=f.type==="add"||f.type==="put"?x(x({},f),{keys:h}):x({},f),f.type!=="delete"&&(f.values=N([],f.values,!0)),f.keys&&(f.keys=N([],f.keys,!0)),Sa(t,f,h).then(function(b){var m=h.map(function(g,w){var y=b[w],k={onerror:null,onsuccess:null};if(f.type==="delete")s.fire.call(k,g,y,p);else if(f.type==="add"||y===void 0){var P=c.fire.call(k,g,f.values[w],p);g==null&&P!=null&&(g=P,f.keys[w]=g,r.outbound||U(f.values[w],r.keyPath,g))}else{var E=or(y,f.values[w]),I=d.fire.call(k,E,g,y,p);if(I){var $=f.values[w];Object.keys(I).forEach(function(D){H($,D)?$[D]=I[D]:U($,D,I[D])})}}return k});return t.mutate(f).then(function(g){for(var w=g.failures,y=g.results,k=g.numFailures,P=g.lastResult,E=0;E<h.length;++E){var I=y?y[E]:h[E],$=m[E];I==null?$.onerror&&$.onerror(w[E]):$.onsuccess&&$.onsuccess(f.type==="put"&&b[E]?f.values[E]:I)}return{failures:w,results:y,numFailures:k,lastResult:P}}).catch(function(g){return m.forEach(function(w){return w.onerror&&w.onerror(g)}),Promise.reject(g)})})}function v(f){return _(f.trans,f.range,1e4)}function _(f,p,h){return t.query({trans:f,values:!1,query:{index:r,range:p},limit:h}).then(function(b){var m=b.result;return l({type:"delete",keys:m,trans:f}).then(function(g){return g.numFailures>0?Promise.reject(g.failures[0]):m.length<h?{failures:[],numFailures:0,lastResult:void 0}:_(f,x(x({},p),{lower:m[m.length-1],lowerOpen:!0}),h)})})}}});return i}})}};function Sa(e,n,t){return n.type==="add"?Promise.resolve([]):e.getMany({trans:n.trans,keys:t,cache:"immutable"})}function Qr(e,n,t){try{if(!n||n.keys.length<e.length)return null;for(var r=[],i=0,a=0;i<n.keys.length&&a<e.length;++i)W(n.keys[i],e[a])===0&&(r.push(t?Me(n.values[i]):n.values[i]),++a);return r.length===e.length?r:null}catch{return null}}var Ca={stack:"dbcore",level:-1,create:function(e){return{table:function(n){var t=e.table(n);return x(x({},t),{getMany:function(r){if(!r.cache)return t.getMany(r);var i=Qr(r.keys,r.trans._cache,r.cache==="clone");return i?C.resolve(i):t.getMany(r).then(function(a){return r.trans._cache={keys:r.keys,values:r.cache==="clone"?Me(a):a},a})},mutate:function(r){return r.type!=="add"&&(r.trans._cache=null),t.mutate(r)}})}}}};function Gr(e,n){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!n.schema.primaryKey.outbound}function Zr(e,n){switch(e){case"query":return n.values&&!n.unique;case"get":return!1;case"getMany":return!1;case"count":return!1;case"openCursor":return!1}}var Pa={stack:"dbcore",level:0,name:"Observability",create:function(e){var n=e.schema.name,t=new fe(e.MIN_KEY,e.MAX_KEY);return x(x({},e),{transaction:function(r,i,a){if(T.subscr&&i!=="readonly")throw new R.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(T.querier));return e.transaction(r,i,a)},table:function(r){var i=e.table(r),a=i.schema,o=a.primaryKey,u=a.indexes,s=o.extractKey,c=o.outbound,d=o.autoIncrement&&u.filter(function(f){return f.compound&&f.keyPath.includes(o.keyPath)}),l=x(x({},i),{mutate:function(f){var p,h,b=f.trans,m=f.mutatedParts||(f.mutatedParts={}),g=function(O){var Y="idb://".concat(n,"/").concat(r,"/").concat(O);return m[Y]||(m[Y]=new fe)},w=g(""),y=g(":dels"),k=f.type,P=f.type==="deleteRange"?[f.range]:f.type==="delete"?[f.keys]:f.values.length<50?[ur(o,f).filter(function(O){return O}),f.values]:[],E=P[0],I=P[1],$=f.trans._cache;if(F(E)){w.addKeys(E);var D=k==="delete"||E.length===I.length?Qr(E,$):null;D||y.addKeys(E),(D||I)&&Aa(g,a,D,I)}else if(E){var V={from:(p=E.lower)!==null&&p!==void 0?p:e.MIN_KEY,to:(h=E.upper)!==null&&h!==void 0?h:e.MAX_KEY};y.add(V),w.add(V)}else w.add(t),y.add(t),a.indexes.forEach(function(O){return g(O.name).add(t)});return i.mutate(f).then(function(O){return E&&(f.type==="add"||f.type==="put")&&(w.addKeys(O.results),d&&d.forEach(function(Y){for(var K=f.values.map(function(he){return Y.extractKey(he)}),te=Y.keyPath.findIndex(function(he){return he===o.keyPath}),de=0,Ae=O.results.length;de<Ae;++de)K[de][te]=O.results[de];g(Y.name).addKeys(K)})),b.mutatedParts=lt(b.mutatedParts||{},m),O})}}),v=function(f){var p,h,b=f.query,m=b.index,g=b.range;return[m,new fe((p=g.lower)!==null&&p!==void 0?p:e.MIN_KEY,(h=g.upper)!==null&&h!==void 0?h:e.MAX_KEY)]},_={get:function(f){return[o,new fe(f.key)]},getMany:function(f){return[o,new fe().addKeys(f.keys)]},count:v,query:v,openCursor:v};return j(_).forEach(function(f){l[f]=function(p){var h=T.subscr,b=!!h,m=Gr(T,i)&&Zr(f,p),g=m?p.obsSet={}:h;if(b){var w=function(D){var V="idb://".concat(n,"/").concat(r,"/").concat(D);return g[V]||(g[V]=new fe)},y=w(""),k=w(":dels"),P=_[f](p),E=P[0],I=P[1];if(f==="query"&&E.isPrimaryKey&&!p.values?k.add(I):w(E.name||"").add(I),!E.isPrimaryKey)if(f==="count")k.add(t);else{var $=f==="query"&&c&&p.values&&i.query(x(x({},p),{values:!1}));return i[f].apply(this,arguments).then(function(D){if(f==="query"){if(c&&p.values)return $.then(function(K){var te=K.result;return y.addKeys(te),D});var V=p.values?D.result.map(s):D.result;p.values?y.addKeys(V):k.addKeys(V)}else if(f==="openCursor"){var O=D,Y=p.values;return O&&Object.create(O,{key:{get:function(){return k.addKey(O.primaryKey),O.key}},primaryKey:{get:function(){var K=O.primaryKey;return k.addKey(K),K}},value:{get:function(){return Y&&y.addKey(O.primaryKey),O.value}}})}return D})}}return i[f].apply(this,arguments)}}),l}})}};function Aa(e,n,t,r){function i(a){var o=e(a.name||"");function u(c){return c!=null?a.extractKey(c):null}var s=function(c){return a.multiEntry&&F(c)?c.forEach(function(d){return o.addKey(d)}):o.addKey(c)};(t||r).forEach(function(c,d){var l=t&&u(t[d]),v=r&&u(r[d]);W(l,v)!==0&&(l!=null&&s(l),v!=null&&s(v))})}n.indexes.forEach(i)}function Xr(e,n,t){if(t.numFailures===0)return n;if(n.type==="deleteRange")return null;var r=n.keys?n.keys.length:"values"in n&&n.values?n.values.length:1;if(t.numFailures===r)return null;var i=x({},n);return F(i.keys)&&(i.keys=i.keys.filter(function(a,o){return!(o in t.failures)})),"values"in i&&F(i.values)&&(i.values=i.values.filter(function(a,o){return!(o in t.failures)})),i}function Da(e,n){return n.lower===void 0?!0:n.lowerOpen?W(e,n.lower)>0:W(e,n.lower)>=0}function Ta(e,n){return n.upper===void 0?!0:n.upperOpen?W(e,n.upper)<0:W(e,n.upper)<=0}function sr(e,n){return Da(e,n)&&Ta(e,n)}function Jr(e,n,t,r,i,a){if(!t||t.length===0)return e;var o=n.query.index,u=o.multiEntry,s=n.query.range,c=r.schema.primaryKey,d=c.extractKey,l=o.extractKey,v=(o.lowLevelIndex||o).extractKey,_=t.reduce(function(f,p){var h=f,b=[];if(p.type==="add"||p.type==="put")for(var m=new fe,g=p.values.length-1;g>=0;--g){var w=p.values[g],y=d(w);if(!m.hasKey(y)){var k=l(w);(u&&F(k)?k.some(function(D){return sr(D,s)}):sr(k,s))&&(m.addKey(y),b.push(w))}}switch(p.type){case"add":{var P=new fe().addKeys(n.values?f.map(function(D){return d(D)}):f);h=f.concat(n.values?b.filter(function(D){var V=d(D);return P.hasKey(V)?!1:(P.addKey(V),!0)}):b.map(function(D){return d(D)}).filter(function(D){return P.hasKey(D)?!1:(P.addKey(D),!0)}));break}case"put":{var E=new fe().addKeys(p.values.map(function(D){return d(D)}));h=f.filter(function(D){return!E.hasKey(n.values?d(D):D)}).concat(n.values?b:b.map(function(D){return d(D)}));break}case"delete":var I=new fe().addKeys(p.keys);h=f.filter(function(D){return!I.hasKey(n.values?d(D):D)});break;case"deleteRange":var $=p.range;h=f.filter(function(D){return!sr(d(D),$)});break}return h},e);return _===e?e:(_.sort(function(f,p){return W(v(f),v(p))||W(d(f),d(p))}),n.limit&&n.limit<1/0&&(_.length>n.limit?_.length=n.limit:e.length===n.limit&&_.length<n.limit&&(i.dirty=!0)),a?Object.freeze(_):_)}function qr(e,n){return W(e.lower,n.lower)===0&&W(e.upper,n.upper)===0&&!!e.lowerOpen==!!n.lowerOpen&&!!e.upperOpen==!!n.upperOpen}function Ma(e,n,t,r){if(e===void 0)return n!==void 0?-1:0;if(n===void 0)return 1;var i=W(e,n);if(i===0){if(t&&r)return 0;if(t)return 1;if(r)return-1}return i}function Ka(e,n,t,r){if(e===void 0)return n!==void 0?1:0;if(n===void 0)return-1;var i=W(e,n);if(i===0){if(t&&r)return 0;if(t)return-1;if(r)return 1}return i}function Ra(e,n){return Ma(e.lower,n.lower,e.lowerOpen,n.lowerOpen)<=0&&Ka(e.upper,n.upper,e.upperOpen,n.upperOpen)>=0}function Ia(e,n,t,r){var i=an["idb://".concat(e,"/").concat(n)];if(!i)return[];var a=i.queries[t];if(!a)return[null,!1,i,null];var o=r.query?r.query.index.name:null,u=a[o||""];if(!u)return[null,!1,i,null];switch(t){case"query":var s=u.find(function(l){return l.req.limit===r.limit&&l.req.values===r.values&&qr(l.req.query.range,r.query.range)});if(s)return[s,!0,i,u];var c=u.find(function(l){var v="limit"in l.req?l.req.limit:1/0;return v>=r.limit&&(r.values?l.req.values:!0)&&Ra(l.req.query.range,r.query.range)});return[c,!1,i,u];case"count":var d=u.find(function(l){return qr(l.req.query.range,r.query.range)});return[d,!!d,i,u]}}function Oa(e,n,t,r){e.subscribers.add(t),r.addEventListener("abort",function(){e.subscribers.delete(t),e.subscribers.size===0&&Ba(e,n)})}function Ba(e,n){setTimeout(function(){e.subscribers.size===0&&Ke(n,e)},3e3)}var Fa={stack:"dbcore",level:0,name:"Cache",create:function(e){var n=e.schema.name,t=x(x({},e),{transaction:function(r,i,a){var o=e.transaction(r,i,a);if(i==="readwrite"){var u=new AbortController,s=u.signal,c=function(d){return function(){if(u.abort(),i==="readwrite"){for(var l=new Set,v=0,_=r;v<_.length;v++){var f=_[v],p=an["idb://".concat(n,"/").concat(f)];if(p){var h=e.table(f),b=p.optimisticOps.filter(function(Y){return Y.trans===o});if(o._explicit&&d&&o.mutatedParts)for(var m=0,g=Object.values(p.queries.query);m<g.length;m++)for(var w=g[m],y=0,k=w.slice();y<k.length;y++){var P=k[y];nr(P.obsSet,o.mutatedParts)&&(Ke(w,P),P.subscribers.forEach(function(Y){return l.add(Y)}))}else if(b.length>0){p.optimisticOps=p.optimisticOps.filter(function(Y){return Y.trans!==o});for(var E=0,I=Object.values(p.queries.query);E<I.length;E++)for(var w=I[E],$=0,D=w.slice();$<D.length;$++){var P=D[$];if(P.res!=null&&o.mutatedParts)if(d&&!P.dirty){var V=Object.isFrozen(P.res),O=Jr(P.res,P.req,b,h,P,V);P.dirty?(Ke(w,P),P.subscribers.forEach(function(te){return l.add(te)})):O!==P.res&&(P.res=O,P.promise=C.resolve({result:O}))}else P.dirty&&Ke(w,P),P.subscribers.forEach(function(te){return l.add(te)})}}}}l.forEach(function(Y){return Y()})}}};o.addEventListener("abort",c(!1),{signal:s}),o.addEventListener("error",c(!1),{signal:s}),o.addEventListener("complete",c(!0),{signal:s})}return o},table:function(r){var i=e.table(r),a=i.schema.primaryKey,o=x(x({},i),{mutate:function(u){var s=T.trans;if(a.outbound||s.db._options.cache==="disabled"||s.explicit||s.idbtrans.mode!=="readwrite")return i.mutate(u);var c=an["idb://".concat(n,"/").concat(r)];if(!c)return i.mutate(u);var d=i.mutate(u);return(u.type==="add"||u.type==="put")&&(u.values.length>=50||ur(a,u).some(function(l){return l==null}))?d.then(function(l){var v=x(x({},u),{values:u.values.map(function(f,p){var h;if(l.failures[p])return f;var b=!((h=a.keyPath)===null||h===void 0)&&h.includes(".")?Me(f):x({},f);return U(b,a.keyPath,l.results[p]),b})}),_=Xr(c,v,l);c.optimisticOps.push(_),queueMicrotask(function(){return u.mutatedParts&&ft(u.mutatedParts)})}):(c.optimisticOps.push(u),u.mutatedParts&&ft(u.mutatedParts),d.then(function(l){if(l.numFailures>0){Ke(c.optimisticOps,u);var v=Xr(c,u,l);v&&c.optimisticOps.push(v),u.mutatedParts&&ft(u.mutatedParts)}}),d.catch(function(){Ke(c.optimisticOps,u),u.mutatedParts&&ft(u.mutatedParts)})),d},query:function(u){var s;if(!Gr(T,i)||!Zr("query",u))return i.query(u);var c=((s=T.trans)===null||s===void 0?void 0:s.db._options.cache)==="immutable",d=T,l=d.requery,v=d.signal,_=Ia(n,r,"query",u),f=_[0],p=_[1],h=_[2],b=_[3];if(f&&p)f.obsSet=u.obsSet;else{var m=i.query(u).then(function(g){var w=g.result;if(f&&(f.res=w),c){for(var y=0,k=w.length;y<k;++y)Object.freeze(w[y]);Object.freeze(w)}else g.result=Me(w);return g}).catch(function(g){return b&&f&&Ke(b,f),Promise.reject(g)});f={obsSet:u.obsSet,promise:m,subscribers:new Set,type:"query",req:u,dirty:!1},b?b.push(f):(b=[f],h||(h=an["idb://".concat(n,"/").concat(r)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}}),h.queries.query[u.query.index.name||""]=b)}return Oa(f,b,l,v),f.promise.then(function(g){return{result:Jr(g.result,u,h?.optimisticOps,i,f,c)}})}});return o}});return t}};function pt(e,n){return new Proxy(e,{get:function(t,r,i){return r==="db"?n:Reflect.get(t,r,i)}})}var Oe=function(){function e(n,t){var r=this;this._middlewares={},this.verno=0;var i=e.dependencies;this._options=t=x({addons:e.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange,cache:"cloned"},t),this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange};var a=t.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var o={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Z,dbReadyPromise:null,cancelOpen:Z,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:t.autoOpen};o.dbReadyPromise=new C(function(s){o.dbReadyResolve=s}),o.openCanceller=new C(function(s,c){o.cancelOpen=c}),this._state=o,this.name=n,this.on=Pn(this,"populate","blocked","versionchange","close",{ready:[Ct,Z]}),this.on.ready.subscribe=Vn(this.on.ready.subscribe,function(s){return function(c,d){e.vip(function(){var l=r._state;if(l.openComplete)l.dbOpenError||C.resolve().then(c),d&&s(c);else if(l.onReadyBeingFired)l.onReadyBeingFired.push(c),d&&s(c);else{s(c);var v=r;d||s(function _(){v.on.ready.unsubscribe(c),v.on.ready.unsubscribe(_)})}})}}),this.Collection=Wi(this),this.Table=zi(this),this.Transaction=qi(this),this.Version=va(this),this.WhereClause=Xi(this),this.on("versionchange",function(s){s.newVersion>0?console.warn("Another connection wants to upgrade database '".concat(r.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(r.name,"'. Closing db now to resume the delete request.")),r.close({disableAutoOpen:!1})}),this.on("blocked",function(s){!s.newVersion||s.newVersion<s.oldVersion?console.warn("Dexie.delete('".concat(r.name,"') was blocked")):console.warn("Upgrade '".concat(r.name,"' blocked by other connection holding version ").concat(s.oldVersion/10))}),this._maxKey=Kn(t.IDBKeyRange),this._createTransaction=function(s,c,d,l){return new r.Transaction(s,c,d,r._options.chromeTransactionDurability,l)},this._fireOnBlocked=function(s){r.on("blocked").fire(s),mn.filter(function(c){return c.name===r.name&&c!==r&&!c._state.vcFired}).map(function(c){return c.on("versionchange").fire(s)})},this.use(Ca),this.use(Fa),this.use(Pa),this.use(ka),this.use(Ea);var u=new Proxy(this,{get:function(s,c,d){if(c==="_vip")return!0;if(c==="table")return function(v){return pt(r.table(v),u)};var l=Reflect.get(s,c,d);return l instanceof Ir?pt(l,u):c==="tables"?l.map(function(v){return pt(v,u)}):c==="_createTransaction"?function(){var v=l.apply(this,arguments);return pt(v,u)}:l}});this.vip=u,a.forEach(function(s){return s(r)})}return e.prototype.version=function(n){if(isNaN(n)||n<.1)throw new R.Type("Given version is not a positive number");if(n=Math.round(n*10)/10,this.idbdb||this._state.isBeingOpened)throw new R.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,n);var t=this._versions,r=t.filter(function(i){return i._cfg.version===n})[0];return r||(r=new this.Version(n),t.push(r),t.sort(oa),r.stores({}),this._state.autoSchema=!1,r)},e.prototype._whenReady=function(n){var t=this;return this.idbdb&&(this._state.openComplete||T.letThrough||this._vip)?n():new C(function(r,i){if(t._state.openComplete)return i(new R.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen){i(new R.DatabaseClosed);return}t.open().catch(Z)}t._state.dbReadyPromise.then(r,i)}).then(n)},e.prototype.use=function(n){var t=n.stack,r=n.create,i=n.level,a=n.name;a&&this.unuse({stack:t,name:a});var o=this._middlewares[t]||(this._middlewares[t]=[]);return o.push({stack:t,create:r,level:i??10,name:a}),o.sort(function(u,s){return u.level-s.level}),this},e.prototype.unuse=function(n){var t=n.stack,r=n.name,i=n.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(function(a){return i?a.create!==i:r?a.name!==r:!1})),this},e.prototype.open=function(){var n=this;return nn(Le,function(){return wa(n)})},e.prototype._close=function(){var n=this._state,t=mn.indexOf(this);if(t>=0&&mn.splice(t,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}n.isBeingOpened||(n.dbReadyPromise=new C(function(r){n.dbReadyResolve=r}),n.openCanceller=new C(function(r,i){n.cancelOpen=i}))},e.prototype.close=function(n){var t=n===void 0?{disableAutoOpen:!0}:n,r=t.disableAutoOpen,i=this._state;r?(i.isBeingOpened&&i.cancelOpen(new R.DatabaseClosed),this._close(),i.autoOpen=!1,i.dbOpenError=new R.DatabaseClosed):(this._close(),i.autoOpen=this._options.autoOpen||i.isBeingOpened,i.openComplete=!1,i.dbOpenError=null)},e.prototype.delete=function(n){var t=this;n===void 0&&(n={disableAutoOpen:!0});var r=arguments.length>0&&typeof arguments[0]!="object",i=this._state;return new C(function(a,o){var u=function(){t.close(n);var s=t._deps.indexedDB.deleteDatabase(t.name);s.onsuccess=q(function(){ga(t._deps,t.name),a()}),s.onerror=Pe(o),s.onblocked=t._fireOnBlocked};if(r)throw new R.InvalidArgument("Invalid closeOptions argument to db.delete()");i.isBeingOpened?i.dbReadyPromise.then(u):u()})},e.prototype.backendDB=function(){return this.idbdb},e.prototype.isOpen=function(){return this.idbdb!==null},e.prototype.hasBeenClosed=function(){var n=this._state.dbOpenError;return n&&n.name==="DatabaseClosed"},e.prototype.hasFailed=function(){return this._state.dbOpenError!==null},e.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(e.prototype,"tables",{get:function(){var n=this;return j(this._allTables).map(function(t){return n._allTables[t]})},enumerable:!1,configurable:!0}),e.prototype.transaction=function(){var n=_a.apply(this,arguments);return this._transaction.apply(this,n)},e.prototype._transaction=function(n,t,r){var i=this,a=T.trans;(!a||a.db!==this||n.indexOf("!")!==-1)&&(a=null);var o=n.indexOf("?")!==-1;n=n.replace("!","").replace("?","");var u,s;try{if(s=t.map(function(d){var l=d instanceof i.Table?d.name:d;if(typeof l!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return l}),n=="r"||n===Nt)u=Nt;else if(n=="rw"||n==Lt)u=Lt;else throw new R.InvalidArgument("Invalid transaction mode: "+n);if(a){if(a.mode===Nt&&u===Lt)if(o)a=null;else throw new R.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");a&&s.forEach(function(d){if(a&&a.storeNames.indexOf(d)===-1)if(o)a=null;else throw new R.SubTransaction("Table "+d+" not included in parent transaction.")}),o&&a&&!a.active&&(a=null)}}catch(d){return a?a._promise(null,function(l,v){v(d)}):oe(d)}var c=Yr.bind(null,this,u,s,a,r);return a?a._promise(u,c,"lock"):T.trans?nn(T.transless,function(){return i._whenReady(c)}):this._whenReady(c)},e.prototype.table=function(n){if(!H(this._allTables,n))throw new R.InvalidTable("Table ".concat(n," does not exist"));return this._allTables[n]},e}(),Na=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",La=function(){function e(n){this._subscribe=n}return e.prototype.subscribe=function(n,t,r){return this._subscribe(!n||typeof n=="function"?{next:n,error:t,complete:r}:n)},e.prototype[Na]=function(){return this},e}(),ht;try{ht={indexedDB:M.indexedDB||M.mozIndexedDB||M.webkitIndexedDB||M.msIndexedDB,IDBKeyRange:M.IDBKeyRange||M.webkitIDBKeyRange}}catch{ht={indexedDB:null,IDBKeyRange:null}}function ei(e){var n=!1,t,r=new La(function(i){var a=kt(e);function o(b){var m=hn();try{a&&yn();var g=je(e,b);return a&&(g=g.finally(Ve)),g}finally{m&&vn()}}var u=!1,s,c={},d={},l={get closed(){return u},unsubscribe:function(){u||(u=!0,s&&s.abort(),v&&Ue.storagemutated.unsubscribe(p))}};i.start&&i.start(l);var v=!1,_=function(){return Ot(h)};function f(){return nr(d,c)}var p=function(b){lt(c,b),f()&&_()},h=function(){if(!(u||!ht.indexedDB)){c={};var b={};s&&s.abort(),s=new AbortController;var m={subscr:b,signal:s.signal,requery:_,querier:e,trans:null},g=o(m);Promise.resolve(g).then(function(w){n=!0,t=w,!(u||m.signal.aborted)&&(c={},d=b,!_t(d)&&!v&&(Ue(Mn,p),v=!0),Ot(function(){return!u&&i.next&&i.next(w)}))},function(w){n=!1,["DatabaseClosedError","AbortError"].includes(w?.name)||u||Ot(function(){u||i.error&&i.error(w)})})}};return setTimeout(_,0),l});return r.hasValue=function(){return n},r.getValue=function(){return t},r}var on=Oe;J(on,x(x({},Un),{delete:function(e){var n=new on(e,{addons:[]});return n.delete()},exists:function(e){return new on(e,{addons:[]}).open().then(function(n){return n.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return ya(on.dependencies).then(e)}catch{return oe(new R.MissingAPI)}},defineClass:function(){function e(n){B(this,n)}return e},ignoreTransaction:function(e){return T.trans?nn(T.transless,e):e()},vip:Jt,async:function(e){return function(){try{var n=ar(e.apply(this,arguments));return!n||typeof n.then!="function"?C.resolve(n):n}catch(t){return oe(t)}}},spawn:function(e,n,t){try{var r=ar(e.apply(t,n||[]));return!r||typeof r.then!="function"?C.resolve(r):r}catch(i){return oe(i)}},currentTransaction:{get:function(){return T.trans||null}},waitFor:function(e,n){var t=C.resolve(typeof e=="function"?on.ignoreTransaction(e):e).timeout(n||6e4);return T.trans?T.trans.waitFor(t):t},Promise:C,debug:{get:function(){return Ce},set:function(e){br(e)}},derive:ve,extend:B,props:J,override:Vn,Events:Pn,on:Ue,liveQuery:ei,extendObservabilitySet:lt,getByKeyPath:X,setByKeyPath:U,delByKeyPath:ue,shallowClone:ne,deepClone:Me,getObjectDiff:or,cmp:W,asap:z,minKey:Ft,addons:[],connections:mn,errnames:St,dependencies:ht,cache:an,semVer:Ar,version:Ar.split(".").map(function(e){return parseInt(e)}).reduce(function(e,n,t){return e+n/Math.pow(10,t*2)})})),on.maxKey=Kn(on.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Ue(Mn,function(e){if(!We){var n;n=new CustomEvent($t,{detail:e}),We=!0,dispatchEvent(n),We=!1}}),addEventListener($t,function(e){var n=e.detail;We||cr(n)}));function cr(e){var n=We;try{We=!0,Ue.storagemutated.fire(e),ir(e,!0)}finally{We=n}}var We=!1,He,lr=function(){};typeof BroadcastChannel<"u"&&(lr=function(){He=new BroadcastChannel($t),He.onmessage=function(e){return e.data&&cr(e.data)}},lr(),typeof He.unref=="function"&&He.unref(),Ue(Mn,function(e){We||He.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!Oe.disableBfCache&&e.persisted){Ce&&console.debug("Dexie: handling persisted pagehide"),He?.close();for(var n=0,t=mn;n<t.length;n++){var r=t[n];r.close({disableAutoOpen:!1})}}}),addEventListener("pageshow",function(e){!Oe.disableBfCache&&e.persisted&&(Ce&&console.debug("Dexie: handling persisted pageshow"),lr(),cr({all:new fe(-1/0,[[]])}))}));function ja(e){return new Dn({add:e})}function Va(e){return new Dn({remove:e})}function za(e,n){return new Dn({replacePrefix:[e,n]})}C.rejectionMapper=xi,br(Ce);var $a=Object.freeze({__proto__:null,Dexie:Oe,liveQuery:ei,Entity:Mr,cmp:W,PropModification:Dn,replacePrefix:za,add:ja,remove:Va,default:Oe,RangeSet:fe,mergeRanges:On,rangesOverlap:$r});return x(Oe,$a,{default:Oe}),Oe})});var fr=se(be(),1),ee={editButton:"M17.318 1.975a3.329 3.329 0 114.707 4.707L8.451 20.256c-.49.49-1.082.867-1.735 1.103L2.34 22.94a1 1 0 01-1.28-1.28l1.581-4.376a4.726 4.726 0 011.103-1.735L17.318 1.975zm3.293 1.414a1.329 1.329 0 00-1.88 0L5.159 16.963c-.283.283-.5.624-.636 1l-.857 2.372 2.371-.857a2.726 2.726 0 001.001-.636L20.611 5.268a1.329 1.329 0 000-1.879z",settings:"M7.96 5.33a2.67 2.67 90 100 5.34 2.67 2.67 90 000-5.34ZM6.67 8A1.33 1.33 90 119.33 8 1.33 1.33 90 016.67 8Zm4.82-4.81a.95.94 90 01-1.1-.75L10.05.55A.47.47 90 009.68.17 8.1 8.1 90 006.32.17.47.47 90 005.96.55L5.61 2.44a.95.95 90 01-1.25.71L2.55 2.51a.47.47 90 00-.51.13C1.28 3.47.71 4.46.36 5.53a.47.47 90 00.14.51L1.97 7.28a.94.94 90 010 1.43L.5 9.95a.47.47 90 00-.14.51 7.98 7.98 90 001.68 2.9.47.47 90 00.51.13l1.81-.65a.94.94 90 011.25.72l.34 1.89c.04.18.18.33.37.37a8.1 8.1 90 003.36 0 .47.47 90 00.37-.37l.34-1.89a.95.95 90 011.25-.72l1.81.65c.18.06.38.01.51-.13.76-.84 1.34-1.82 1.68-2.9a.47.47 90 00-.14-.5L14.03 8.72a.94.94 90 010-1.44L15.5 6.04a.47.47 90 00.14-.5 7.98 7.98 90 00-1.68-2.9.47.47 90 00-.51-.13l-1.81.65a.95.95 90 01-.15.04Zm-8.82.78 1.25.44a2.28 2.28 90 003-1.73l.24-1.3a6.81 6.81 90 011.68 0l.24 1.3a2.28 2.28 90 003.01 1.73l1.24-.44c.34.44.63.93.84 1.44l-1 .85a2.27 2.27 90 000 3.48l1 .85a6.65 6.65 90 01-.84 1.44l-1.24-.44A2.28 2.28 90 009.08 13.32l-.24 1.29a6.8 6.8 90 01-1.69 0l-.23-1.29A2.28 2.28 90 003.91 11.59l-1.24.44a6.65 6.65 90 01-.84-1.44l1-.86a2.27 2.27 90 000-3.47l-1-.85c.21-.51.5-1 .84-1.44Z",github:"M12.2135 0C18.947 0 24.4267 5.5 24.4066 12.3041c0 5.4391-3.4983 10.0428-8.3513 11.6728-.6065.1223-.829-.265-.829-.591 0-.4072.02-1.7315.02-3.3815 0-1.1613-.384-1.8945-.829-2.2815 2.73-.3058 5.581-1.3445 5.581-6.0708 0-1.3445-.465-2.4445-1.2537-3.3.1213-.3055.5463-1.5688-.1212-3.2595 0 0-1.0312-.326-3.3567 1.263-.9707-.2648-2.0219-.4075-3.0532-.4075A11.7425 11.7425 90 009.16 6.3556c-2.3252-1.589-3.3565-1.263-3.3565-1.263-.6675 1.6907-.2427 2.954-.1215 3.2595-.7685.8555-1.2535 1.9555-1.2535 3.3 0 4.7263 2.8509 5.7855 5.5607 6.0708-.3437.3055-.6675.8555-.7685 1.65-.7077.326-2.467.8555-3.5587-1.0185 0 0-.6472-1.1815-1.8807-1.263 0 0-1.193 0-.081.7538 0 0 .809.3665 1.355 1.7925 0 0 .7075 2.2002 4.105 1.4667 0 1.0188.02 1.9965.02 2.2818 0 .3258-.2222.713-.829.5905C3.4983 22.3472 0 17.7432 0 12.3042 0 5.5 5.4597 0 12.2135 0Z",close:"M31.098 29.794 16.955 15.65 31.097 1.51 29.683.093 15.54 14.237 1.4.094-.016 1.508 14.126 15.65-.016 29.795l1.414 1.414L15.54 17.065l14.144 14.143",warning:"MM13 14V9H11v5Zm0 2H11v2h2Zm8.884 3.5A1 1 0 0121 21H3a1 1 0 01-.884-1.468l9-17c.346-.654 1.422-.654 1.768 0Z",more:"M3 8A1.5 1.5 0 110 8a1.5 1.5 0 013 0zm6.5 0a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM16 8a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z",questionMark:"M12 2c5.523 0 10 4.478 10 10s-4.477 10-10 10S2 17.522 2 12 6.477 2 12 2Zm0 1.667c-4.595 0-8.333 3.738-8.333 8.333S7.405 20.333 12 20.333 20.333 16.595 20.333 12c0-4.595-3.738-8.333-8.333-8.333ZM12 15.5a1 1 0 110 2 1 1 0 010-2Zm0-8.75a2.75 2.75 0 012.75 2.75c0 1.01-.297 1.574-1.051 2.359l-.169.171c-.622.622-.78.886-.78 1.47a.75.75 0 01-1.5 0c0-1.01.297-1.574 1.051-2.359l.169-.171c.622-.622.78-.886.78-1.47a1.25 1.25 0 00-2.493-.128l-.007.128a.75.75 0 01-1.5 0A2.75 2.75 0 0112 6.75Z",dropdown:"M20.4614 6.3469a1.506 1.506 90 00-2.1125.1919L12 14.1564 5.651 6.5389a1.4997 1.4997 90 10-2.3028 1.922l7.5004 9.0004a1.4992 1.4992 90 002.3028 0l7.5004-9.0005a1.5019 1.5019 90 00-.1904-2.1139Z",palette:"M12 2c5.461 0 9.965 4.012 9.992 8.84 0 3.051-2.504 5.554-5.555 5.554H14.441a1.64 1.64 0 00-1.668 1.668c0 .473.148.836.438 1.125.257.29.437.688.437 1.125C13.648 21.254 12.926 22 12 22 6.5 22 2 17.5 2 12S6.5 2 12 2Z",duplicate:"M15 3.5c0-.5-.5-1-1-1H11V1c0-.5-.5-1-1-1H2C1.5 0 1 .5 1 1V11.5c0 .5.5 1 1 1H4.5V15c0 .5.5 1 1 1H14c.5 0 1-.5 1-1ZM2.5 2c0-.25.25-.5.5-.5H9c.25 0 .5.25.5.5v8.5c0 .25-.25.5-.5.5H3c-.25 0-.5-.25-.5-.5Zm4 12.5c-.25 0-.5-.25-.5-.5V12.5h4c.5 0 1-.5 1-1V4h2c.25 0 .5.25.5.5V14c0 .25-.25.5-.5.5Z"},Te=(A,S=16)=>({size:x=S,fill:N="currentColor"})=>(0,fr.jsx)("svg",{viewBox:`0 0 ${S} ${S}`,width:x,height:x,fill:N,children:(0,fr.jsx)("path",{d:A})});ee.React={editButton:Te(ee.editButton,24),settings:Te(ee.settings,16),github:Te(ee.github,24),close:Te(ee.close,32),warning:Te(ee.warning,24),more:Te(ee.more,16),questionMark:Te(ee.questionMark,24),dropdown:Te(ee.dropdown,24),palette:Te(ee.palette,24),duplicate:Te(ee.duplicate,16)};ee.HTML={editButton:`<path d="${ee.editButton}"/>`,settings:`<path d="${ee.settings}"/>`,github:`<path d="${ee.github}"/>`,close:`<path d="${ee.close}"/>`,warning:`<path d="${ee.warning}"/>`,more:`<path d="${ee.more}"/>`,questionMark:`<path d="${ee.questionMark}"/>`,dropdown:`<path d="${ee.dropdown}"/>`,palette:`<path d="${ee.palette}"/>`,duplicate:`<path d="${ee.duplicate}"/>`};var wn=ee;(()=>{let A=`.Modal__overlay {
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  display: flex;
  justify-content: center;
  align-items: center;
  background-color: rgba(var(--spice-rgb-shadow), 0.5);
  border-radius: 7px;
}

.Modal {
  background-color: unset;
}

.Modal__container {
  display: flex;
  flex-direction: column;
  background-color: rgba(var(--spice-rgb-main), 0.9) !important;
  backdrop-filter: blur(20px) saturate(1.4) brightness(1.2);
  width: 500px;
  max-height: 500px;
  border-radius: 7px;
  box-shadow: 0 0px 20px rgba(var(--spice-rgb-shadow), 0.5) !important;
}

.Modal__container--large {
  max-height: 80vh;
  width: clamp(550px, 60vw, 650px);
}

.Modal__header {
  display: flex;
  justify-content: space-between;
  padding: 32px 32px 12px;
  border-bottom: 1px solid rgba(var(--spice-rgb-selected-row), 0.1);
}

.Modal__titleContainer {
  display: flex;
  gap: 8px;
}

.Modal__icon {
  display: flex;
  align-items: center;
}

.Modal__title {
  display: flex;
}

.Modal__buttonContainer {
  display: flex;
  align-items: center;
  gap: 8px;
}

.Modal__button {
  background-color: var(--spice-highlight);
  border-radius: 8px;
  height: 34px;
  cursor: pointer;
  padding: 8px;
  border: 0;
}

.Modal__button:hover {
  transform: scale(1.1);
}

.Modal__button:active {
  transform: scale(0.9);
}

.Modal__content {
  display: flex;
  padding: 16px 24px !important;
  overflow: auto;
  scrollbar-gutter: stable both-edges;
}
`,S="shared-popupModal.css";if(document.getElementById(S))return;let x=document.createElement("style");x.id=S,x.textContent=A,document.head.appendChild(x)})();var Ln=se(Fn(),1),ai=se(dr(),1);var pe=se(be(),1),Be=null,Nn=null,mt=()=>{Nn&&Be&&(Nn.unmount(),Be.remove(),document.body.style.overflow="auto",document.removeEventListener("keydown",oi),document.removeEventListener("mousedown",ui),Be=null,Nn=null)},oi=A=>{A.key==="Escape"&&mt()},ui=A=>{A.target.classList.contains("Modal__overlay")&&mt()},si=({title:A="",content:S,isLarge:x=!0,buttons:N=null,icon:M=""}={})=>{Be=document.getElementById("popup-modal"),Be||(Be=document.createElement("popup-modal"),Be.id="popup-modal",document.body.appendChild(Be)),Nn=ai.default.createRoot(Be),document.addEventListener("keydown",oi),document.addEventListener("mousedown",ui);let j=(0,Ln.memo)(()=>(0,pe.jsx)("div",{className:"Modal__overlay",children:(0,pe.jsx)("div",{className:"Modal",children:(0,pe.jsxs)("div",{className:`Modal__container${x?" Modal__container--large":""}`,children:[(0,pe.jsxs)("div",{className:"Modal__header",children:[(0,pe.jsxs)("div",{className:"Modal__titleContainer",children:[(0,pe.jsx)("div",{className:"Modal__icon",children:M}),(0,pe.jsx)("h1",{className:"Modal__title",children:A})]}),(0,pe.jsxs)("div",{className:"Modal__buttonContainer",children:[N,(0,pe.jsx)(Spicetify.ReactComponent.TooltipWrapper,{label:"Close",placement:"top",children:(0,pe.jsx)("button",{type:"button",className:"Modal__button Modal__button--close",onClick:()=>mt(),children:(0,pe.jsx)(wn.React.close,{size:18})})})]})]}),(0,pe.jsx)("div",{className:"Modal__content",children:Ln.default.isValidElement(S)?S:Ln.default.createElement(S)})]})})}));Nn.render((0,pe.jsx)(j,{}))};si.hide=mt;var ci=si;var gt=se(li(),1),fi=Symbol.for("Dexie"),bt=globalThis[fi]||(globalThis[fi]=gt.default);if(gt.default.semVer!==bt.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${gt.default.semVer} and ${bt.semVer}`);var{liveQuery:vo,mergeRanges:yo,rangesOverlap:mo,RangeSet:go,cmp:bo,Entity:wo,PropModification:_o,replacePrefix:xo,add:ko,remove:Eo}=bt;var di=bt;var xe=se(Fn(),1);var vr=se(Fn(),1),pi=se(dr(),1),wt=se(be(),1);function Xa({titleText:A,descriptionText:S,cancelText:x="Cancel",confirmText:N="Confirm",onConfirm:M,onClose:j,onOpen:F,onOutside:B,confirmLabel:G,allowHTML:L}){let H=vr.default.memo(()=>{let[J,ce]=Spicetify.React.useState(!0),re=document.querySelector(".ReactModalPortal:last-of-type");return vr.default.useEffect(()=>{J&&F?.()},[J,F]),(0,wt.jsx)(Spicetify.ReactComponent.RemoteConfigProvider,{configuration:Spicetify.Platform.RemoteConfiguration,children:(0,wt.jsx)(Spicetify.ReactComponent.ConfirmDialog,{titleText:A,descriptionText:S,cancelText:x,confirmText:N,isOpen:J,onOutside:()=>{ce(!1),B?.(),re?.remove()},onClose:()=>{ce(!1),j?.(),re?.remove()},onConfirm:()=>{ce(!1),M?.(),re?.remove()},confirmLabel:G,allowHTML:L})})});pi.default.createRoot(document.createElement("div")).render((0,wt.jsx)(H,{}))}var hi=Xa;var _n=se(Fn(),1);(()=>{let A=`.dropdown {
  position: relative;
  min-width: 100px;
  width: fit-content;
  font-size: 14px !important;
  cursor: pointer;

  .dropdown--disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .dropdown__button {
    display: flex;
    border: none;
    justify-content: space-between;
    align-items: center;
    padding: 0 8px;
    background: rgba(var(--spice-rgb-selected-row), 0.1);
    color: rgba(var(--spice-rgb-text), 0.8);
    border-radius: 4px;
    height: 32px;
    width: 100%;
  }

  .dropdown__arrow {
    display: flex;
  }

  .dropdown__menu {
    background: var(--spice-card);
    border-radius: 4px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    color: rgba(var(--spice-rgb-text), 0.8);
    border: solid rgba(var(--spice-rgb-subtext), 0.1) 1px;
    overflow-y: scroll;
    scrollbar-width: none;
    max-height: 250px;
  }

  .dropdown__option {
    display: flex;
    align-items: center;
    padding: 0 8px;
    height: 32px;
    cursor: pointer;

    &:first-child {
      border-top-left-radius: 4px;
      border-top-right-radius: 4px;
    }

    &:last-child {
      border-bottom-left-radius: 4px;
      border-bottom-right-radius: 4px;
    }

    &:hover,
    .dropdown__option--selected {
      background: var(--spice-button);
    }
  }
}
`,S="shared-dropdown.css";if(document.getElementById(S))return;let x=document.createElement("style");x.id=S,x.textContent=A,document.head.appendChild(x)})();var Fe=se(be(),1),Ja=(0,_n.memo)(({value:A,options:S,onChange:x,disabled:N})=>{let M=(0,_n.useId)(),j=(0,_n.useRef)(null),F=`--dropdown-anchor-${M.replace(/:/g,"id")}`,B=L=>{x?.({target:{value:L.value}}),j.current?.hidePopover()},G=S.find(L=>L.value===A)?.label||"Select...";return(0,Fe.jsxs)("div",{className:`dropdown${N?" dropdown--disabled":""}`,children:[(0,Fe.jsxs)("button",{className:"dropdown__button",popovertarget:M,popovertargetaction:"toggle",disabled:N,style:{anchorName:F},children:[(0,Fe.jsx)("div",{className:"dropdown__text",children:G}),(0,Fe.jsx)("div",{className:"dropdown__arrow",children:(0,Fe.jsx)(wn.React.dropdown,{size:12})})]}),(0,Fe.jsx)("div",{popover:"auto",id:M,ref:j,className:"dropdown__menu",style:{top:`calc(anchor(${F} bottom) + 4px)`,left:`anchor(${F} left)`,width:`anchor-size(${F} width)`},children:S.map(L=>(0,Fe.jsx)("div",{className:`dropdown__option${A===L.value?" dropdown__option--selected":""}`,onClick:()=>B(L),children:L.label},L.value))})]})}),vi=Ja;var Q=se(be(),1),un=new di("findDupeTracks");un.version(1).stores({tracks:"&trackUri, trackName, albumUri, playCount, isrc"});async function qa(A=100){let S=await Spicetify.Platform.LibraryAPI.getContents({offset:0,limit:A}),x=S.items.filter(M=>M.type==="playlist"&&M.isOwnedBySelf),N=S.totalLength;if(N>A){let M=Math.ceil((N-A)/A),j=Array.from({length:M},(B,G)=>A*(G+1));(await Promise.all(j.map(B=>Spicetify.Platform.LibraryAPI.getContents({offset:B,limit:A})))).forEach(B=>{x=x.concat(B.items.filter(G=>G.type==="playlist"&&G.isOwnedBySelf))})}return x}async function eo(A,S=5e3){let x=await Spicetify.Platform.PlaylistAPI.getContents(A,{offset:0,limit:S}),N=x.items,M=x.totalLength;if(M>S){let L=Math.ceil((M-S)/S),H=Array.from({length:L},(ce,re)=>S*(re+1)),J=await Promise.all(H.map(ce=>Spicetify.Platform.PlaylistAPI.getContents(A,{offset:ce,limit:S}).then(re=>re.items)));N=N.concat(J.flat())}let j=N.map(L=>L.uri),F=await un.tracks.bulkGet(j),B=new Map(F.filter(Boolean).map(L=>[L.trackUri,L])),G=N.map(L=>{let H=B.get(L.uri);return{trackUri:L.uri,trackName:L.name,albumUri:L.album.uri,playCount:H?.playCount??null,isrc:H?.isrc??null}});return await un.tracks.bulkPut(G),{items:N,totalLength:M}}async function no(A){let S=new Map,x=await un.tracks.bulkGet(A),N=[];x.forEach((j,F)=>{let B=A[F];j?.isrc?S.set(B,j.isrc):N.push(B)});let M=[];if(N.length>0){let j=N.map(L=>Spicetify.URI.fromString(L).id),F=50,B=[];for(let L=0;L<j.length;L+=F){let J=`https://api.spotify.com/v1/tracks?ids=${j.slice(L,L+F).join(",")}`;B.push(Spicetify.CosmosAsync.get(J))}(await Promise.all(B)).forEach(L=>{L.tracks.forEach(H=>{let J=H?.external_ids?.isrc,ce=H?.uri;J&&ce&&(S.set(ce,J),M.push({key:ce,changes:{isrc:J}}))})})}return M.length>0&&await un.tracks.bulkUpdate(M),S}async function to(A){let S=new Map,x=A.map(B=>B.uri),N=await un.tracks.bulkGet(x),M=new Map,j=new Map;N.forEach(B=>{let G=B.trackUri;if(j.set(G,B),B.playCount!==null&&B.playCount!==void 0)S.set(G,B.playCount);else{let L=A.find(H=>H.uri===G);L?.album?.uri&&(S.set(G,null),M.set(G,L.album.uri))}});let F=[];if(M.size>0){let B=new Map;M.forEach((L,H)=>{B.set(L,B.get(L)||new Set),B.get(L).add(H)});let G=Array.from(B.entries()).map(async([L,H])=>{(await Spicetify.GraphQL.Request(Spicetify.GraphQL.Definitions.getAlbum,{uri:L,locale:Spicetify.Locale.getLocale(),offset:0,limit:5e3}))?.data?.albumUnion?.tracksV2?.items?.forEach(re=>{let ve=re?.track?.uri;if(H.has(ve)){let sn=re.track.playcount,Ne=sn?Number.parseInt(sn,10):0;S.set(ve,Ne),F.push({key:ve,changes:{playCount:Ne}})}})});await Promise.all(G)}return F.length>0&&await un.tracks.bulkUpdate(F),A.forEach(B=>{(!S.has(B.uri)||S.get(B.uri)===null)&&S.set(B.uri,j.get(B.uri)?.playCount??0)}),S}var yi=(A,S)=>S[A]??0,ro=A=>{let x=["live","remix","mix","acoustic","instrumental","radio","version","ver","edit","mono","stereo","deluxe","intro","outro","remastered","bonus","feat","ft","explicit","clean","piano","guitar","cover","original","extended","album","single"].join("|"),N=new RegExp(`\\b(${x})\\b`,"gi");return A.toLowerCase().replace(/\(.*?\)|\[.*?\]/g,"").replace(N,"").replace(/-/g," ").replace(/[^\p{L}\p{N}\s]/gu,"").replace(/\s+/g," ").trim()};function io({selectedPlaylist:A}){let[S,x]=(0,xe.useState)([]),[N,M]=(0,xe.useState)(A?.uri||""),[j,F]=(0,xe.useState)([]),[B,G]=(0,xe.useState)({}),[L,H]=(0,xe.useState)(new Map),[J,ce]=(0,xe.useState)({exact:[],isrc:[],likely:[],possible:[]});(0,xe.useEffect)(()=>{let z=!0;return(async()=>{let ie=await qa();if(!z)return;x(ie);let X=A?.uri||ie[0]?.uri||"";M(X)})(),()=>{z=!1}},[A]);let re=(z,ie,X)=>{let U=new Set,ue=(ae,zn,_t)=>{let Ee=new Map,Me=0;for(let me of ae){if(U.has(me.uri)){Me++;continue}let Se=_t(zn(me));Se&&(Ee.set(Se,Ee.get(Se)||[]),Ee.get(Se).push(me))}let ln=[],xt=0;for(let me of Ee.values())if(me.length>1){let Se=performance.now();me.sort((xn,Ke)=>yi(Ke.uri,ie)-yi(xn.uri,ie)),xt+=performance.now()-Se,me.forEach(xn=>U.add(xn.uri)),ln.push({mainTrack:me[0],duplicates:me.slice(1)})}return ln},ne=ue(z,ae=>ae.uri,ae=>ae),ye=ue(z,ae=>X.get(ae.uri),ae=>ae),we=ue(z,ae=>ae.name,ae=>ae.toLowerCase().trim()),Ze=ue(z,ae=>ae.name,ro);ce({exact:ne,isrc:ye,likely:we,possible:Ze})},ve=async(z,ie,X)=>{await Spicetify.Platform.PlaylistAPI.remove(N,[{uri:z.uri,uid:z.uid}]),ce(U=>{let ue=U[ie],ne=ue[X],ye=ne.duplicates.filter(ae=>!(ae.uri===z.uri&&ae.uid===z.uid)),we;ne.mainTrack.uri===z.uri&&ne.mainTrack.uid===z.uid?we=ye.length>0?{mainTrack:ye[0],duplicates:ye.slice(1)}:null:we={...ne,duplicates:ye};let Ze=[...ue];return we&&we.duplicates.length>0?Ze[X]=we:Ze.splice(X,1),{...U,[ie]:Ze}}),F(U=>U.filter(ue=>!(ue.uri===z.uri&&ue.uid===z.uid)))},sn=async(z,ie,X)=>{if(z==="exact"||z==="isrc"){await ve(X,z,ie);return}hi({titleText:"Remove Track",descriptionText:`Are you sure you want to remove "${X.name}"? This cannot be undone.`,confirmText:"Remove",onConfirm:()=>ve(X,z,ie)})};(0,xe.useEffect)(()=>{let z={exact:[],isrc:[],likely:[],possible:[]};F([]),ce(z),G({}),H(new Map),(async()=>{let U=(await eo(N)).items;if(F(U),U.length>0){let ue=U.map(we=>we.uri),[ne,ye]=await Promise.all([to(U),no(ue)]);G(ne),H(ye),re(U,ne,ye)}})()},[N]);let Ne=(0,xe.memo)(({track:z})=>{let ie=B.get(z.uri),X=ie!=null?ie.toLocaleString():"N/A",U=L.get(z.uri)||"N/A",ue=z.album?.name||"N/A",ne=z.artists?.map(ye=>ye.name).join(", ")||"N/A";return(0,Q.jsxs)("div",{className:"find-dupes-group__details",children:["Artists: ",ne,(0,Q.jsxs)("span",{className:"find-dupes-group__album",children:[" Album: ",ue]}),(0,Q.jsxs)("span",{className:"find-dupes-group__playcount",children:[" Plays: ",X]}),(0,Q.jsxs)("span",{className:"find-dupes-group__isrc",children:[" ISRC: ",U]})]})}),cn=(z,ie,X)=>(0,Q.jsxs)("div",{className:"find-dupes__group-section",children:[(0,Q.jsx)("p",{className:"find-dupes__group-section-heading",children:`${z} (${ie.length} found)`}),ie.length>0?(0,Q.jsx)("ul",{className:"find-dupes__group-list",children:ie.map((U,ue)=>(0,Q.jsxs)("li",{className:`find-dupes-group find-dupes-group--${X}`,children:[(0,Q.jsxs)("div",{className:"find-dupes-group__source",children:["Source: ",U.mainTrack.name,(0,Q.jsx)(Ne,{track:U.mainTrack})]}),(0,Q.jsx)("div",{className:"find-dupes-group__duplicates-heading",children:"Duplicates:"}),(0,Q.jsx)("ul",{className:"find-dupes-group__duplicates-list",children:U.duplicates.map(ne=>(0,Q.jsxs)("li",{className:"find-dupes-group__duplicate-item",children:[(0,Q.jsxs)("div",{className:"find-dupes-group__duplicate-content",children:[(0,Q.jsx)("span",{className:"find-dupes-group__duplicate-name",children:ne.name}),(0,Q.jsx)(Ne,{track:ne})]}),(0,Q.jsx)("button",{type:"button",className:"find-dupes-group__delete-button",onClick:()=>sn(X,ue,ne),"aria-label":`Remove duplicate track ${ne.name}`,children:"Delete"})]},`${ne.uri}-${ne.uid||ne.uri}`))})]},`${U.mainTrack.uri}-${U.mainTrack.uid||ue}`))}):(0,Q.jsx)("p",{children:"No duplicates found in this category."})]}),Qe=S.find(z=>z.uri===N),Vn=Qe?Qe.name:"Select a playlist",Ge=S.map(z=>({value:z.uri,label:z.name}));return(0,Q.jsxs)("div",{className:"find-dupes",children:[(0,Q.jsxs)("div",{className:"find-dupes__header",children:[(0,Q.jsx)("span",{className:"find-dupes__header-label",children:"Select Playlist:"}),(0,Q.jsx)(vi,{value:N,options:Ge,onChange:z=>M(z.target.value),disabled:S.length===0,"aria-label":"Select a playlist to scan for duplicates"})]}),N&&(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsxs)("p",{className:"find-dupes__details",children:["Playlist: ",Vn," (",j.length," tracks analyzed)"]}),(0,Q.jsxs)(Q.Fragment,{children:[cn("Exact Duplicates (Same URI)",J.exact,"exact"),cn("ISRC Duplicates (Same Recording)",J.isrc,"isrc"),cn("Likely Duplicates (Same Name)",J.likely,"likely"),cn("Possible Duplicates (Similar Name)",J.possible,"possible")]})]})]})}var mi=io;(()=>{let A=`.find-dupes {
  display: flex;
  flex-direction: column;
  gap: 10px;
  width: 100%;
}

.find-dupes__header {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 10px;
}

.find-dupes__header-label {
  color: var(--spice-text);
  font-weight: bold;
}

.find-dupes__details {
  font-size: 1.25em;
  color: var(--spice-text);
}

.find-dupes__group-section {
  background-color: var(--spice-player);
  border: 1px solid rgba(var(--spice-rgb-selected-row), 0.1);
  border-radius: 6px;
  padding: 15px;
}

.find-dupes__group-section-heading {
  margin-bottom: 15px;
  font-weight: bold;
  font-size: 1.2em;
  color: var(--spice-text);
}

.find-dupes__group-list {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.find-dupes-group {
  padding: 15px;
  border-radius: 4px;
  border: 1px solid rgba(var(--spice-rgb-selected-row), 0.1);
  border-left-width: 5px;
  border-left-style: solid;
  transition: background-color 0.2s ease;
  list-style: none;
}

.find-dupes-group--exact {
  border-left-color: #f24e5c;
}
.find-dupes-group--likely {
  border-left-color: #ffc726;
}
.find-dupes-group--possible {
  border-left-color: #58ff33;
}

.find-dupes-group__source {
  font-weight: bold;
  margin-bottom: 10px;
  color: var(--spice-text);
  font-size: 1.05em;
}

.find-dupes-group__duplicates-heading {
  margin-top: 10px;
  margin-bottom: 5px;
  font-weight: normal;
  color: var(--spice-subtext);
  font-size: 0.95em;
}

.find-dupes-group__duplicates-list {
  list-style: none;
  padding: 0 0 0 15px;
  margin: 0;
  display: flex;
  flex-direction: column;
}

.find-dupes-group__duplicate-item {
  padding: 10px 0;
  font-size: 1em;
  color: #e0e0e0;
  border-bottom: 1px solid rgba(var(--spice-rgb-selected-row), 0.1);
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 10px;
}

.find-dupes-group__duplicate-item:last-child {
  border-bottom: none;
}

.find-dupes-group__duplicate-name {
  display: block;
  margin-bottom: 3px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.find-dupes-group__details {
  color: var(--spice-subtext);
  font-size: 0.9em;
  margin-top: 3px;
  display: block;
  overflow: hidden;
  text-overflow: ellipsis;
}

.find-dupes-group__album {
  display: inline-block;
  margin-left: 5px;
}

.find-dupes-group__delete-button {
  background-color: #f24e5c;
  color: white;
  border: none;
  padding: 6px 12px;
  border-radius: 4px;
  cursor: pointer;
  font-size: 0.85em;
  font-weight: bold;
  transition: background-color 0.2s ease, transform 0.1s ease;
}

.find-dupes-group__delete-button:hover {
  background-color: #d32f2f;
}

.find-dupes-group__delete-button:active {
  background-color: #b71c1c;
  transform: scale(0.98);
}
`,S="findDupeTracks-styles.css";if(document.getElementById(S))return;let x=document.createElement("style");x.id=S,x.textContent=A,document.head.appendChild(x)})();var gi=se(be(),1),jn=null,ao=new Spicetify.ContextMenuV2.Item({children:"Find Duplicates",leadingIcon:wn.duplicate,onClick:async()=>{let A=await Spicetify.Platform.PlaylistAPI.getMetadata(jn),S={uri:jn,name:A.name};ci({title:"Find Duplicates",content:(0,gi.jsx)(mi,{selectedPlaylist:S}),isLarge:!0})},shouldAdd:(A,S,x)=>{let N=Spicetify.ContextMenuV2.parseProps(A);if(!N||!Array.isArray(N))return jn=null,!1;let[M]=N,j=Spicetify.URI.isPlaylistV1OrV2(M[0]);return j?jn=M[0]:jn=null,j}});ao.register();
/*! Bundled license information:

dexie/dist/dexie.js:
  (*! *****************************************************************************
  Copyright (c) Microsoft Corporation.
  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.
  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** *)
*/
})();
