await new Promise((resolve) => Spicetify.Events.webpackLoaded.on(resolve));
var Xo=Object.create;var An=Object.defineProperty;var Vo=Object.getOwnPropertyDescriptor;var Jo=Object.getOwnPropertyNames;var qo=Object.getPrototypeOf,es=Object.prototype.hasOwnProperty;var ts=(f,r)=>()=>(f&&(r=f(f=0)),r);var Ci=(f,r)=>()=>(r||f((r={exports:{}}).exports,r),r.exports),ns=(f,r)=>{for(var l in r)An(f,l,{get:r[l],enumerable:!0})},ki=(f,r,l,C)=>{if(r&&typeof r=="object"||typeof r=="function")for(let g of Jo(r))!es.call(f,g)&&g!==l&&An(f,g,{get:()=>r[g],enumerable:!(C=Vo(r,g))||C.enumerable});return f};var Ne=(f,r,l)=>(l=f!=null?Xo(qo(f)):{},ki(r||!f||!f.__esModule?An(l,"default",{value:f,enumerable:!0}):l,f)),rs=f=>ki(An({},"__esModule",{value:!0}),f);var Ei={};ns(Ei,{Children:()=>is,Component:()=>as,Fragment:()=>os,Profiler:()=>ss,PureComponent:()=>us,StrictMode:()=>cs,Suspense:()=>ls,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:()=>fs,act:()=>ds,cloneElement:()=>ps,createContext:()=>hs,createElement:()=>ms,createFactory:()=>vs,createRef:()=>ys,default:()=>Is,forwardRef:()=>gs,isValidElement:()=>kr,lazy:()=>bs,memo:()=>Se,startTransition:()=>_s,unstable_act:()=>ws,useCallback:()=>xs,useContext:()=>Ss,useDebugValue:()=>Cs,useDeferredValue:()=>ks,useEffect:()=>at,useId:()=>Er,useImperativeHandle:()=>Es,useInsertionEffect:()=>Ps,useLayoutEffect:()=>As,useMemo:()=>Pr,useReducer:()=>Rs,useRef:()=>Be,useState:()=>Le,useSyncExternalStore:()=>Rn,useTransition:()=>Ds,version:()=>Ts});var is,as,os,ss,us,cs,ls,fs,ds,ps,hs,ms,vs,ys,gs,kr,bs,Se,_s,ws,xs,Ss,Cs,ks,at,Er,Es,Ps,As,Pr,Rs,Be,Le,Rn,Ds,Ts,Is,je=ts(()=>{({Children:is,Component:as,Fragment:os,Profiler:ss,PureComponent:us,StrictMode:cs,Suspense:ls,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:fs,act:ds,cloneElement:ps,createContext:hs,createElement:ms,createFactory:vs,createRef:ys,forwardRef:gs,isValidElement:kr,lazy:bs,memo:Se,startTransition:_s,unstable_act:ws,useCallback:xs,useContext:Ss,useDebugValue:Cs,useDeferredValue:ks,useEffect:at,useId:Er,useImperativeHandle:Es,useInsertionEffect:Ps,useLayoutEffect:As,useMemo:Pr,useReducer:Rs,useRef:Be,useState:Le,useSyncExternalStore:Rn,useTransition:Ds,version:Ts}=Spicetify.React),Is=Spicetify.React});var $e=Ci((Lu,Ii)=>{"use no memo";"use strict";var Os=Object.create,In=Object.defineProperty,Ms=Object.getOwnPropertyDescriptor,Ks=Object.getOwnPropertyNames,Ns=Object.getPrototypeOf,Bs=Object.prototype.hasOwnProperty,js=(f,r)=>{for(var l in r)In(f,l,{get:r[l],enumerable:!0})},Di=(f,r,l,C)=>{if(r&&typeof r=="object"||typeof r=="function")for(let g of Ks(r))!Bs.call(f,g)&&g!==l&&In(f,g,{get:()=>r[g],enumerable:!(C=Ms(r,g))||C.enumerable});return f},$s=(f,r,l)=>(l=f!=null?Os(Ns(f)):{},Di(r||!f||!f.__esModule?In(l,"default",{value:f,enumerable:!0}):l,f)),Fs=f=>Di(In({},"__esModule",{value:!0}),f),Ti={};js(Ti,{$dispatcherGuard:()=>Hs,$makeReadOnly:()=>Zs,$reset:()=>Ws,$structuralCheck:()=>Vs,c:()=>Us,clearRenderCounterRegistry:()=>Ys,renderCounterRegistry:()=>Xt,useRenderCounter:()=>Xs});Ii.exports=Fs(Ti);var Ot=$s((je(),rs(Ei))),{useRef:Ls,useEffect:zs,isValidElement:Tt}=Ot,Pi,Ar=(Pi=Ot.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE)!=null?Pi:Ot.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Rr=Symbol.for("react.memo_cache_sentinel"),Ai,Us=typeof((Ai=Ot.__COMPILER_RUNTIME)==null?void 0:Ai.c)=="function"?Ot.__COMPILER_RUNTIME.c:function(r){return Ot.useMemo(()=>{let l=new Array(r);for(let C=0;C<r;C++)l[C]=Rr;return l[Rr]=!0,l},[])},Tn={};["readContext","useCallback","useContext","useEffect","useImperativeHandle","useInsertionEffect","useLayoutEffect","useMemo","useReducer","useRef","useState","useDebugValue","useDeferredValue","useTransition","useMutableSource","useSyncExternalStore","useId","unstable_isNewReconciler","getCacheSignal","getCacheForType","useCacheRefresh"].forEach(f=>{Tn[f]=()=>{throw new Error(`[React] Unexpected React hook call (${f}) from a React compiled function. Check that all hooks are called directly and named according to convention ('use[A-Z]') `)}});var Qt=null;Tn.useMemoCache=f=>{if(Qt==null)throw new Error("React Compiler internal invariant violation: unexpected null dispatcher");return Qt.useMemoCache(f)};function Dn(f){return Ar.ReactCurrentDispatcher.current=f,Ar.ReactCurrentDispatcher.current}var It=[];function Hs(f){let r=Ar.ReactCurrentDispatcher.current;if(f===0){if(It.push(r),It.length===1&&(Qt=r),r===Tn)throw new Error("[React] Unexpected call to custom hook or component from a React compiled function. Check that (1) all hooks are called directly and named according to convention ('use[A-Z]') and (2) components are returned as JSX instead of being directly invoked.");Dn(Tn)}else if(f===1){let l=It.pop();if(l==null)throw new Error("React Compiler internal error: unexpected null in guard stack");It.length===0&&(Qt=null),Dn(l)}else if(f===2)It.push(r),Dn(Qt);else if(f===3){let l=It.pop();if(l==null)throw new Error("React Compiler internal error: unexpected null in guard stack");Dn(l)}else throw new Error("React Compiler internal error: unreachable block"+f)}function Ws(f){for(let r=0;r<f.length;r++)f[r]=Rr}function Zs(){throw new Error("TODO: implement $makeReadOnly in react-compiler-runtime")}var Xt=new Map;function Ys(){for(let f of Xt.values())f.forEach(r=>{r.count=0})}function Gs(f,r){let l=Xt.get(f);l==null&&(l=new Set,Xt.set(f,l)),l.add(r)}function Qs(f,r){let l=Xt.get(f);l?.delete(r)}function Xs(f){let r=Ls(null);r.current!=null&&(r.current.count+=1),zs(()=>{if(r.current==null){let l={count:0};Gs(f,l),r.current=l}return()=>{r.current!==null&&Qs(f,r.current)}})}var Ri=new Set;function Vs(f,r,l,C,g,k){function h(P,x,O,T){let B=`${C}:${k} [${g}] ${l}${O} changed from ${P} to ${x} at depth ${T}`;Ri.has(B)||(Ri.add(B),console.error(B))}let b=2;function _(P,x,O,T){if(!(T>b)){if(P===x)return;if(typeof P!=typeof x)h(`type ${typeof P}`,`type ${typeof x}`,O,T);else if(typeof P=="object"){let B=Array.isArray(P),j=Array.isArray(x);if(P===null&&x!==null)h("null",`type ${typeof x}`,O,T);else if(x===null)h(`type ${typeof P}`,"null",O,T);else if(P instanceof Map)if(!(x instanceof Map))h("Map instance","other value",O,T);else if(P.size!==x.size)h(`Map instance with size ${P.size}`,`Map instance with size ${x.size}`,O,T);else for(let[N,H]of P)x.has(N)?_(H,x.get(N),`${O}.get(${N})`,T+1):h(`Map instance with key ${N}`,`Map instance without key ${N}`,O,T);else if(x instanceof Map)h("other value","Map instance",O,T);else if(P instanceof Set)if(!(x instanceof Set))h("Set instance","other value",O,T);else if(P.size!==x.size)h(`Set instance with size ${P.size}`,`Set instance with size ${x.size}`,O,T);else for(let N of x)P.has(N)||h(`Set instance without element ${N}`,`Set instance with element ${N}`,O,T);else if(x instanceof Set)h("other value","Set instance",O,T);else if(B||j)if(B!==j)h(`type ${B?"array":"object"}`,`type ${j?"array":"object"}`,O,T);else if(P.length!==x.length)h(`array with length ${P.length}`,`array with length ${x.length}`,O,T);else for(let N=0;N<P.length;N++)_(P[N],x[N],`${O}[${N}]`,T+1);else if(Tt(P)||Tt(x))Tt(P)!==Tt(x)?h(`type ${Tt(P)?"React element":"object"}`,`type ${Tt(x)?"React element":"object"}`,O,T):P.type!==x.type?h(`React element of type ${P.type}`,`React element of type ${x.type}`,O,T):_(P.props,x.props,`[props of ${O}]`,T+1);else{for(let N in x)N in P||h(`object without key ${N}`,`object with key ${N}`,O,T);for(let N in P)N in x?_(P[N],x[N],`${O}.${N}`,T+1):h(`object with key ${N}`,`object without key ${N}`,O,T)}}else{if(typeof P=="function")return;isNaN(P)||isNaN(x)?isNaN(P)!==isNaN(x)&&h(`${isNaN(P)?"NaN":"non-NaN value"}`,`${isNaN(x)?"NaN":"non-NaN value"}`,O,T):P!==x&&h(P,x,O,T)}}}_(f,r,"",0)}});var ji=Ci((Or,Mr)=>{(function(f,r){typeof Or=="object"&&typeof Mr<"u"?Mr.exports=r():typeof define=="function"&&define.amd?define(r):(f=typeof globalThis<"u"?globalThis:f||self,f.Dexie=r())})(Or,function(){"use strict";var f=function(e,t){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n[a]=i[a])},f(e,t)};function r(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");f(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var l=function(){return l=Object.assign||function(t){for(var n,i=1,a=arguments.length;i<a;i++){n=arguments[i];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},l.apply(this,arguments)};function C(e,t,n){if(n||arguments.length===2)for(var i=0,a=t.length,o;i<a;i++)(o||!(i in t))&&(o||(o=Array.prototype.slice.call(t,0,i)),o[i]=t[i]);return e.concat(o||Array.prototype.slice.call(t))}var g=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,k=Object.keys,h=Array.isArray;typeof Promise<"u"&&!g.Promise&&(g.Promise=Promise);function b(e,t){return typeof t!="object"||k(t).forEach(function(n){e[n]=t[n]}),e}var _=Object.getPrototypeOf,P={}.hasOwnProperty;function x(e,t){return P.call(e,t)}function O(e,t){typeof t=="function"&&(t=t(_(e))),(typeof Reflect>"u"?k:Reflect.ownKeys)(t).forEach(function(n){B(e,n,t[n])})}var T=Object.defineProperty;function B(e,t,n,i){T(e,t,b(n&&x(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},i))}function j(e){return{from:function(t){return e.prototype=Object.create(t.prototype),B(e.prototype,"constructor",e),{extend:O.bind(null,e.prototype)}}}}var N=Object.getOwnPropertyDescriptor;function H(e,t){var n=N(e,t),i;return n||(i=_(e))&&H(i,t)}var X=[].slice;function Y(e,t,n){return X.call(e,t,n)}function W(e,t){return t(e)}function ne(e){if(!e)throw new Error("Assertion Failed")}function de(e){g.setImmediate?setImmediate(e):setTimeout(e,0)}function ce(e,t){return e.reduce(function(n,i,a){var o=t(i,a);return o&&(n[o[0]]=o[1]),n},{})}function ae(e,t){if(typeof t=="string"&&x(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var n=[],i=0,a=t.length;i<a;++i){var o=ae(e,t[i]);n.push(o)}return n}var s=t.indexOf(".");if(s!==-1){var u=e[t.substr(0,s)];return u==null?void 0:ae(u,t.substr(s+1))}}function ie(e,t,n){if(!(!e||t===void 0)&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){ne(typeof n!="string"&&"length"in n);for(var i=0,a=t.length;i<a;++i)ie(e,t[i],n[i])}else{var o=t.indexOf(".");if(o!==-1){var s=t.substr(0,o),u=t.substr(o+1);if(u==="")n===void 0?h(e)&&!isNaN(parseInt(s))?e.splice(s,1):delete e[s]:e[s]=n;else{var c=e[s];(!c||!x(e,s))&&(c=e[s]={}),ie(c,u,n)}}else n===void 0?h(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function me(e,t){typeof t=="string"?ie(e,t,void 0):"length"in t&&[].map.call(t,function(n){ie(e,n,void 0)})}function ve(e){var t={};for(var n in e)x(e,n)&&(t[n]=e[n]);return t}var be=[].concat;function pe(e){return be.apply([],e)}var fe="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(pe([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return g[e]}),ye=new Set(fe.map(function(e){return g[e]}));function ee(e){var t={};for(var n in e)if(x(e,n)){var i=e[n];t[n]=!i||typeof i!="object"||ye.has(i.constructor)?i:ee(i)}return t}function q(e){for(var t in e)if(x(e,t))return!1;return!0}var le=null;function we(e){le=new WeakMap;var t=Ie(e);return le=null,t}function Ie(e){if(!e||typeof e!="object")return e;var t=le.get(e);if(t)return t;if(h(e)){t=[],le.set(e,t);for(var n=0,i=e.length;n<i;++n)t.push(Ie(e[n]))}else if(ye.has(e.constructor))t=e;else{var a=_(e);t=a===Object.prototype?{}:Object.create(a),le.set(e,t);for(var o in e)x(e,o)&&(t[o]=Ie(e[o]))}return t}var Oe={}.toString;function _t(e){return Oe.call(e).slice(8,-1)}var Qe=typeof Symbol<"u"?Symbol.iterator:"@@iterator",wt=typeof Qe=="symbol"?function(e){var t;return e!=null&&(t=e[Qe])&&t.apply(e)}:function(){return null};function ze(e,t){var n=e.indexOf(t);return n>=0&&e.splice(n,1),n>=0}var Ae={};function Me(e){var t,n,i,a;if(arguments.length===1){if(h(e))return e.slice();if(this===Ae&&typeof e=="string")return[e];if(a=wt(e)){for(n=[];i=a.next(),!i.done;)n.push(i.value);return n}if(e==null)return[e];if(t=e.length,typeof t=="number"){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var xt=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Mt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"],De=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],jn=Mt.concat(De),Ca={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function St(e,t){this.name=e,this.message=t}j(St).from(Error).extend({toString:function(){return this.name+": "+this.message}});function jr(e,t){return e+". Errors: "+Object.keys(t).map(function(n){return t[n].toString()}).filter(function(n,i,a){return a.indexOf(n)===i}).join(`
`)}function qt(e,t,n,i){this.failures=t,this.failedKeys=i,this.successCount=n,this.message=jr(e,t)}j(qt).from(St);function Ct(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(n){return t[n]}),this.failuresByPos=t,this.message=jr(e,this.failures)}j(Ct).from(St);var $n=jn.reduce(function(e,t){return e[t]=t+"Error",e},{}),ka=St,Q=jn.reduce(function(e,t){var n=t+"Error";function i(a,o){this.name=n,a?typeof a=="string"?(this.message="".concat(a).concat(o?`
 `+o:""),this.inner=o||null):typeof a=="object"&&(this.message="".concat(a.name," ").concat(a.message),this.inner=a):(this.message=Ca[t]||n,this.inner=null)}return j(i).from(ka),e[t]=i,e},{});Q.Syntax=SyntaxError,Q.Type=TypeError,Q.Range=RangeError;var $r=De.reduce(function(e,t){return e[t+"Error"]=Q[t],e},{});function Ea(e,t){if(!e||e instanceof St||e instanceof TypeError||e instanceof SyntaxError||!e.name||!$r[e.name])return e;var n=new $r[e.name](t||e.message,e);return"stack"in e&&B(n,"stack",{get:function(){return this.inner.stack}}),n}var en=jn.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=Q[t]),e},{});en.ModifyError=qt,en.DexieError=St,en.BulkError=Ct;function he(){}function Kt(e){return e}function Pa(e,t){return e==null||e===Kt?t:function(n){return t(e(n))}}function ct(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function Aa(e,t){return e===he?t:function(){var n=e.apply(this,arguments);n!==void 0&&(arguments[0]=n);var i=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?ct(i,this.onsuccess):i),a&&(this.onerror=this.onerror?ct(a,this.onerror):a),o!==void 0?o:n}}function Ra(e,t){return e===he?t:function(){e.apply(this,arguments);var n=this.onsuccess,i=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?ct(n,this.onsuccess):n),i&&(this.onerror=this.onerror?ct(i,this.onerror):i)}}function Da(e,t){return e===he?t:function(n){var i=e.apply(this,arguments);b(n,i);var a=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var s=t.apply(this,arguments);return a&&(this.onsuccess=this.onsuccess?ct(a,this.onsuccess):a),o&&(this.onerror=this.onerror?ct(o,this.onerror):o),i===void 0?s===void 0?void 0:s:b(i,s)}}function Ta(e,t){return e===he?t:function(){return t.apply(this,arguments)===!1?!1:e.apply(this,arguments)}}function Fn(e,t){return e===he?t:function(){var n=e.apply(this,arguments);if(n&&typeof n.then=="function"){for(var i=this,a=arguments.length,o=new Array(a);a--;)o[a]=arguments[a];return n.then(function(){return t.apply(i,o)})}return t.apply(this,arguments)}}var Ue=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Fr(e,t){Ue=e}var Nt={},Lr=100,Ln=typeof Promise>"u"?[]:(function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,_(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,_(t),e]})(),zr=Ln[0],Ur=Ln[1],Ia=Ln[2],Oa=Ur&&Ur.then,lt=zr&&zr.constructor,zn=!!Ia;function Ma(){queueMicrotask(Na)}var Bt=function(e,t){jt.push([e,t]),tn&&(Ma(),tn=!1)},Un=!0,tn=!0,ft=[],nn=[],Hn=Kt,Xe={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:he,pgp:!1,env:{},finalize:he},Z=Xe,jt=[],dt=0,rn=[];function L(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=Z;if(typeof e!="function"){if(e!==Nt)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Zn(this,this._value);return}this._state=null,this._value=null,++t.ref,Wr(this,e)}var Wn={get:function(){var e=Z,t=un;function n(i,a){var o=this,s=!e.global&&(e!==Z||t!==un),u=s&&!Je(),c=new L(function(d,v){Yn(o,new Hr(Gr(i,e,s,u),Gr(a,e,s,u),d,v,e))});return this._consoleTask&&(c._consoleTask=this._consoleTask),c}return n.prototype=Nt,n},set:function(e){B(this,"then",e&&e.prototype===Nt?Wn:{get:function(){return e},set:Wn.set})}};O(L.prototype,{then:Wn,_then:function(e,t){Yn(this,new Hr(null,null,e,t,Z))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=arguments[0],n=arguments[1];return typeof t=="function"?this.then(null,function(i){return i instanceof t?n(i):an(i)}):this.then(null,function(i){return i&&i.name===t?n(i):an(i)})},finally:function(e){return this.then(function(t){return L.resolve(e()).then(function(){return t})},function(t){return L.resolve(e()).then(function(){return an(t)})})},timeout:function(e,t){var n=this;return e<1/0?new L(function(i,a){var o=setTimeout(function(){return a(new Q.Timeout(t))},e);n.then(i,a).finally(clearTimeout.bind(null,o))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&B(L.prototype,Symbol.toStringTag,"Dexie.Promise"),Xe.env=Yr();function Hr(e,t,n,i,a){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=n,this.reject=i,this.psd=a}O(L,{all:function(){var e=Me.apply(null,arguments).map(cn);return new L(function(t,n){e.length===0&&t([]);var i=e.length;e.forEach(function(a,o){return L.resolve(a).then(function(s){e[o]=s,--i||t(e)},n)})})},resolve:function(e){if(e instanceof L)return e;if(e&&typeof e.then=="function")return new L(function(n,i){e.then(n,i)});var t=new L(Nt,!0,e);return t},reject:an,race:function(){var e=Me.apply(null,arguments).map(cn);return new L(function(t,n){e.map(function(i){return L.resolve(i).then(t,n)})})},PSD:{get:function(){return Z},set:function(e){return Z=e}},totalEchoes:{get:function(){return un}},newPSD:Ve,usePSD:pt,scheduler:{get:function(){return Bt},set:function(e){Bt=e}},rejectionMapper:{get:function(){return Hn},set:function(e){Hn=e}},follow:function(e,t){return new L(function(n,i){return Ve(function(a,o){var s=Z;s.unhandleds=[],s.onunhandled=o,s.finalize=ct(function(){var u=this;Ba(function(){u.unhandleds.length===0?a():o(u.unhandleds[0])})},s.finalize),e()},t,n,i)})}}),lt&&(lt.allSettled&&B(L,"allSettled",function(){var e=Me.apply(null,arguments).map(cn);return new L(function(t){e.length===0&&t([]);var n=e.length,i=new Array(n);e.forEach(function(a,o){return L.resolve(a).then(function(s){return i[o]={status:"fulfilled",value:s}},function(s){return i[o]={status:"rejected",reason:s}}).then(function(){return--n||t(i)})})})}),lt.any&&typeof AggregateError<"u"&&B(L,"any",function(){var e=Me.apply(null,arguments).map(cn);return new L(function(t,n){e.length===0&&n(new AggregateError([]));var i=e.length,a=new Array(i);e.forEach(function(o,s){return L.resolve(o).then(function(u){return t(u)},function(u){a[s]=u,--i||n(new AggregateError(a))})})})}),lt.withResolvers&&(L.withResolvers=lt.withResolvers));function Wr(e,t){try{t(function(n){if(e._state===null){if(n===e)throw new TypeError("A promise cannot be resolved with itself.");var i=e._lib&&kt();n&&typeof n.then=="function"?Wr(e,function(a,o){n instanceof L?n._then(a,o):n.then(a,o)}):(e._state=!0,e._value=n,Zr(e)),i&&Et()}},Zn.bind(null,e))}catch(n){Zn(e,n)}}function Zn(e,t){if(nn.push(t),e._state===null){var n=e._lib&&kt();t=Hn(t),e._state=!1,e._value=t,ja(e),Zr(e),n&&Et()}}function Zr(e){var t=e._listeners;e._listeners=[];for(var n=0,i=t.length;n<i;++n)Yn(e,t[n]);var a=e._PSD;--a.ref||a.finalize(),dt===0&&(++dt,Bt(function(){--dt===0&&Gn()},[]))}function Yn(e,t){if(e._state===null){e._listeners.push(t);return}var n=e._state?t.onFulfilled:t.onRejected;if(n===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++dt,Bt(Ka,[n,e,t])}function Ka(e,t,n){try{var i,a=t._value;!t._state&&nn.length&&(nn=[]),i=Ue&&t._consoleTask?t._consoleTask.run(function(){return e(a)}):e(a),!t._state&&nn.indexOf(a)===-1&&$a(t),n.resolve(i)}catch(o){n.reject(o)}finally{--dt===0&&Gn(),--n.psd.ref||n.psd.finalize()}}function Na(){pt(Xe,function(){kt()&&Et()})}function kt(){var e=Un;return Un=!1,tn=!1,e}function Et(){var e,t,n;do for(;jt.length>0;)for(e=jt,jt=[],n=e.length,t=0;t<n;++t){var i=e[t];i[0].apply(null,i[1])}while(jt.length>0);Un=!0,tn=!0}function Gn(){var e=ft;ft=[],e.forEach(function(i){i._PSD.onunhandled.call(null,i._value,i)});for(var t=rn.slice(0),n=t.length;n;)t[--n]()}function Ba(e){function t(){e(),rn.splice(rn.indexOf(t),1)}rn.push(t),++dt,Bt(function(){--dt===0&&Gn()},[])}function ja(e){ft.some(function(t){return t._value===e._value})||ft.push(e)}function $a(e){for(var t=ft.length;t;)if(ft[--t]._value===e._value){ft.splice(t,1);return}}function an(e){return new L(Nt,!1,e)}function ge(e,t){var n=Z;return function(){var i=kt(),a=Z;try{return qe(n,!0),e.apply(this,arguments)}catch(o){t&&t(o)}finally{qe(a,!1),i&&Et()}}}var Ce={awaits:0,echoes:0,id:0},Fa=0,on=[],sn=0,un=0,La=0;function Ve(e,t,n,i){var a=Z,o=Object.create(a);o.parent=a,o.ref=0,o.global=!1,o.id=++La,Xe.env,o.env=zn?{Promise:L,PromiseProp:{value:L,configurable:!0,writable:!0},all:L.all,race:L.race,allSettled:L.allSettled,any:L.any,resolve:L.resolve,reject:L.reject}:{},t&&b(o,t),++a.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()};var s=pt(o,e,n,i);return o.ref===0&&o.finalize(),s}function Pt(){return Ce.id||(Ce.id=++Fa),++Ce.awaits,Ce.echoes+=Lr,Ce.id}function Je(){return Ce.awaits?(--Ce.awaits===0&&(Ce.id=0),Ce.echoes=Ce.awaits*Lr,!0):!1}(""+Oa).indexOf("[native code]")===-1&&(Pt=Je=he);function cn(e){return Ce.echoes&&e&&e.constructor===lt?(Pt(),e.then(function(t){return Je(),t},function(t){return Je(),xe(t)})):e}function za(e){++un,(!Ce.echoes||--Ce.echoes===0)&&(Ce.echoes=Ce.awaits=Ce.id=0),on.push(Z),qe(e,!0)}function Ua(){var e=on[on.length-1];on.pop(),qe(e,!1)}function qe(e,t){var n=Z;if((t?Ce.echoes&&(!sn++||e!==Z):sn&&(!--sn||e!==Z))&&queueMicrotask(t?za.bind(null,e):Ua),e!==Z&&(Z=e,n===Xe&&(Xe.env=Yr()),zn)){var i=Xe.env.Promise,a=e.env;(n.global||e.global)&&(Object.defineProperty(g,"Promise",a.PromiseProp),i.all=a.all,i.race=a.race,i.resolve=a.resolve,i.reject=a.reject,a.allSettled&&(i.allSettled=a.allSettled),a.any&&(i.any=a.any))}}function Yr(){var e=g.Promise;return zn?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(g,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function pt(e,t,n,i,a){var o=Z;try{return qe(e,!0),t(n,i,a)}finally{qe(o,!1)}}function Gr(e,t,n,i){return typeof e!="function"?e:function(){var a=Z;n&&Pt(),qe(t,!0);try{return e.apply(this,arguments)}finally{qe(a,!1),i&&queueMicrotask(Je)}}}function Qn(e){Promise===lt&&Ce.echoes===0?sn===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}var xe=L.reject;function Xn(e,t,n,i){if(!e.idbdb||!e._state.openComplete&&!Z.letThrough&&!e._vip){if(e._state.openComplete)return xe(new Q.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._state.autoOpen)return xe(new Q.DatabaseClosed);e.open().catch(he)}return e._state.dbReadyPromise.then(function(){return Xn(e,t,n,i)})}else{var a=e._createTransaction(t,n,e._dbSchema);try{a.create(),e._state.PR1398_maxLoop=3}catch(o){return o.name===$n.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then(function(){return Xn(e,t,n,i)})):xe(o)}return a._promise(t,function(o,s){return Ve(function(){return Z.trans=a,i(o,s,a)})}).then(function(o){if(t==="readwrite")try{a.idbtrans.commit()}catch{}return t==="readonly"?o:a._completion.then(function(){return o})})}}var Qr="4.2.1",ht="\uFFFF",Vn=-1/0,Ye="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Xr="String expected.",At=[],ln="__dbnames",Jn="readonly",qn="readwrite";function mt(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var Vr={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function fn(e){return typeof e=="string"&&!/\./.test(e)?function(t){return t[e]===void 0&&e in t&&(t=we(t),delete t[e]),t}:function(t){return t}}function Jr(){throw Q.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function oe(e,t){try{var n=qr(e),i=qr(t);if(n!==i)return n==="Array"?1:i==="Array"?-1:n==="binary"?1:i==="binary"?-1:n==="string"?1:i==="string"?-1:n==="Date"?1:i!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return Wa(ei(e),ei(t));case"Array":return Ha(e,t)}}catch{}return NaN}function Ha(e,t){for(var n=e.length,i=t.length,a=n<i?n:i,o=0;o<a;++o){var s=oe(e[o],t[o]);if(s!==0)return s}return n===i?0:n<i?-1:1}function Wa(e,t){for(var n=e.length,i=t.length,a=n<i?n:i,o=0;o<a;++o)if(e[o]!==t[o])return e[o]<t[o]?-1:1;return n===i?0:n<i?-1:1}function qr(e){var t=typeof e;if(t!=="object")return t;if(ArrayBuffer.isView(e))return"binary";var n=_t(e);return n==="ArrayBuffer"?"binary":n}function ei(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}function dn(e,t,n){var i=e.schema.yProps;return i?(t&&n.numFailures>0&&(t=t.filter(function(a,o){return!n.failures[o]})),Promise.all(i.map(function(a){var o=a.updatesTable;return t?e.db.table(o).where("k").anyOf(t).delete():e.db.table(o).clear()})).then(function(){return n})):n}var $t=(function(){function e(t){this["@@propmod"]=t}return e.prototype.execute=function(t){var n,i=this["@@propmod"];if(i.add!==void 0){var a=i.add;if(h(a))return C(C([],h(t)?t:[],!0),a,!0).sort();if(typeof a=="number")return(Number(t)||0)+a;if(typeof a=="bigint")try{return BigInt(t)+a}catch{return BigInt(0)+a}throw new TypeError("Invalid term ".concat(a))}if(i.remove!==void 0){var o=i.remove;if(h(o))return h(t)?t.filter(function(u){return!o.includes(u)}).sort():[];if(typeof o=="number")return Number(t)-o;if(typeof o=="bigint")try{return BigInt(t)-o}catch{return BigInt(0)-o}throw new TypeError("Invalid subtrahend ".concat(o))}var s=(n=i.replacePrefix)===null||n===void 0?void 0:n[0];return s&&typeof t=="string"&&t.startsWith(s)?i.replacePrefix[1]+t.substring(s.length):t},e})();function ti(e,t){for(var n=k(t),i=n.length,a=!1,o=0;o<i;++o){var s=n[o],u=t[s],c=ae(e,s);u instanceof $t?(ie(e,s,u.execute(c)),a=!0):c!==u&&(ie(e,s,u),a=!0)}return a}var ni=(function(){function e(){}return e.prototype._trans=function(t,n,i){var a=this._tx||Z.trans,o=this.name,s=Ue&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(t==="readonly"?"read":"write"," ").concat(this.name));function u(v,p,S){if(!S.schema[o])throw new Q.NotFound("Table "+o+" not part of transaction");return n(S.idbtrans,S)}var c=kt();try{var d=a&&a.db._novip===this.db._novip?a===Z.trans?a._promise(t,u,i):Ve(function(){return a._promise(t,u,i)},{trans:a,transless:Z.transless||Z}):Xn(this.db,t,[this.name],u);return s&&(d._consoleTask=s,d=d.catch(function(v){return console.trace(v),xe(v)})),d}finally{c&&Et()}},e.prototype.get=function(t,n){var i=this;return t&&t.constructor===Object?this.where(t).first(n):t==null?xe(new Q.Type("Invalid argument to Table.get()")):this._trans("readonly",function(a){return i.core.get({trans:a,key:t}).then(function(o){return i.hook.reading.fire(o)})}).then(n)},e.prototype.where=function(t){if(typeof t=="string")return new this.db.WhereClause(this,t);if(h(t))return new this.db.WhereClause(this,"[".concat(t.join("+"),"]"));var n=k(t);if(n.length===1)return this.where(n[0]).equals(t[n[0]]);var i=this.schema.indexes.concat(this.schema.primKey).filter(function(v){if(v.compound&&n.every(function(S){return v.keyPath.indexOf(S)>=0})){for(var p=0;p<n.length;++p)if(n.indexOf(v.keyPath[p])===-1)return!1;return!0}return!1}).sort(function(v,p){return v.keyPath.length-p.keyPath.length})[0];if(i&&this.db._maxKey!==ht){var a=i.keyPath.slice(0,n.length);return this.where(a).equals(a.map(function(v){return t[v]}))}!i&&Ue&&console.warn("The query ".concat(JSON.stringify(t)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(n.join("+"),"]"));var o=this.schema.idxByName;function s(v,p){return oe(v,p)===0}var u=n.reduce(function(v,p){var S=v[0],M=v[1],m=o[p],y=t[p];return[S||m,S||!m?mt(M,m&&m.multi?function(w){var E=ae(w,p);return h(E)&&E.some(function(R){return s(y,R)})}:function(w){return s(y,ae(w,p))}):M]},[null,null]),c=u[0],d=u[1];return c?this.where(c.name).equals(t[c.keyPath]).filter(d):i?this.filter(d):this.where(n).equals("")},e.prototype.filter=function(t){return this.toCollection().and(t)},e.prototype.count=function(t){return this.toCollection().count(t)},e.prototype.offset=function(t){return this.toCollection().offset(t)},e.prototype.limit=function(t){return this.toCollection().limit(t)},e.prototype.each=function(t){return this.toCollection().each(t)},e.prototype.toArray=function(t){return this.toCollection().toArray(t)},e.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},e.prototype.orderBy=function(t){return new this.db.Collection(new this.db.WhereClause(this,h(t)?"[".concat(t.join("+"),"]"):t))},e.prototype.reverse=function(){return this.toCollection().reverse()},e.prototype.mapToClass=function(t){var n=this,i=n.db,a=n.name;this.schema.mappedClass=t,t.prototype instanceof Jr&&(t=(function(c){r(d,c);function d(){return c!==null&&c.apply(this,arguments)||this}return Object.defineProperty(d.prototype,"db",{get:function(){return i},enumerable:!1,configurable:!0}),d.prototype.table=function(){return a},d})(t));for(var o=new Set,s=t.prototype;s;s=_(s))Object.getOwnPropertyNames(s).forEach(function(c){return o.add(c)});var u=function(c){if(!c)return c;var d=Object.create(t.prototype);for(var v in c)if(!o.has(v))try{d[v]=c[v]}catch{}return d};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=u,this.hook("reading",u),t},e.prototype.defineClass=function(){function t(n){b(this,n)}return this.mapToClass(t)},e.prototype.add=function(t,n){var i=this,a=this.schema.primKey,o=a.auto,s=a.keyPath,u=t;return s&&o&&(u=fn(s)(t)),this._trans("readwrite",function(c){return i.core.mutate({trans:c,type:"add",keys:n!=null?[n]:null,values:[u]})}).then(function(c){return c.numFailures?L.reject(c.failures[0]):c.lastResult}).then(function(c){if(s)try{ie(t,s,c)}catch{}return c})},e.prototype.upsert=function(t,n){var i=this,a=this.schema.primKey.keyPath;return this._trans("readwrite",function(o){return i.core.get({trans:o,key:t}).then(function(s){var u=s??{};return ti(u,n),a&&ie(u,a,t),i.core.mutate({trans:o,type:"put",values:[u],keys:[t],upsert:!0,updates:{keys:[t],changeSpecs:[n]}}).then(function(c){return c.numFailures?L.reject(c.failures[0]):!!s})})})},e.prototype.update=function(t,n){if(typeof t=="object"&&!h(t)){var i=ae(t,this.schema.primKey.keyPath);return i===void 0?xe(new Q.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(i).modify(n)}else return this.where(":id").equals(t).modify(n)},e.prototype.put=function(t,n){var i=this,a=this.schema.primKey,o=a.auto,s=a.keyPath,u=t;return s&&o&&(u=fn(s)(t)),this._trans("readwrite",function(c){return i.core.mutate({trans:c,type:"put",values:[u],keys:n!=null?[n]:null})}).then(function(c){return c.numFailures?L.reject(c.failures[0]):c.lastResult}).then(function(c){if(s)try{ie(t,s,c)}catch{}return c})},e.prototype.delete=function(t){var n=this;return this._trans("readwrite",function(i){return n.core.mutate({trans:i,type:"delete",keys:[t]}).then(function(a){return dn(n,[t],a)}).then(function(a){return a.numFailures?L.reject(a.failures[0]):void 0})})},e.prototype.clear=function(){var t=this;return this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"deleteRange",range:Vr}).then(function(i){return dn(t,null,i)})}).then(function(n){return n.numFailures?L.reject(n.failures[0]):void 0})},e.prototype.bulkGet=function(t){var n=this;return this._trans("readonly",function(i){return n.core.getMany({keys:t,trans:i}).then(function(a){return a.map(function(o){return n.hook.reading.fire(o)})})})},e.prototype.bulkAdd=function(t,n,i){var a=this,o=Array.isArray(n)?n:void 0;i=i||(o?void 0:n);var s=i?i.allKeys:void 0;return this._trans("readwrite",function(u){var c=a.schema.primKey,d=c.auto,v=c.keyPath;if(v&&o)throw new Q.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(o&&o.length!==t.length)throw new Q.InvalidArgument("Arguments objects and keys must have the same length");var p=t.length,S=v&&d?t.map(fn(v)):t;return a.core.mutate({trans:u,type:"add",keys:o,values:S,wantResults:s}).then(function(M){var m=M.numFailures,y=M.results,w=M.lastResult,E=M.failures,R=s?y:w;if(m===0)return R;throw new Ct("".concat(a.name,".bulkAdd(): ").concat(m," of ").concat(p," operations failed"),E)})})},e.prototype.bulkPut=function(t,n,i){var a=this,o=Array.isArray(n)?n:void 0;i=i||(o?void 0:n);var s=i?i.allKeys:void 0;return this._trans("readwrite",function(u){var c=a.schema.primKey,d=c.auto,v=c.keyPath;if(v&&o)throw new Q.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(o&&o.length!==t.length)throw new Q.InvalidArgument("Arguments objects and keys must have the same length");var p=t.length,S=v&&d?t.map(fn(v)):t;return a.core.mutate({trans:u,type:"put",keys:o,values:S,wantResults:s}).then(function(M){var m=M.numFailures,y=M.results,w=M.lastResult,E=M.failures,R=s?y:w;if(m===0)return R;throw new Ct("".concat(a.name,".bulkPut(): ").concat(m," of ").concat(p," operations failed"),E)})})},e.prototype.bulkUpdate=function(t){var n=this,i=this.core,a=t.map(function(u){return u.key}),o=t.map(function(u){return u.changes}),s=[];return this._trans("readwrite",function(u){return i.getMany({trans:u,keys:a,cache:"clone"}).then(function(c){var d=[],v=[];t.forEach(function(S,M){var m=S.key,y=S.changes,w=c[M];if(w){for(var E=0,R=Object.keys(y);E<R.length;E++){var D=R[E],I=y[D];if(D===n.schema.primKey.keyPath){if(oe(I,m)!==0)throw new Q.Constraint("Cannot update primary key in bulkUpdate()")}else ie(w,D,I)}s.push(M),d.push(m),v.push(w)}});var p=d.length;return i.mutate({trans:u,type:"put",keys:d,values:v,updates:{keys:a,changeSpecs:o}}).then(function(S){var M=S.numFailures,m=S.failures;if(M===0)return p;for(var y=0,w=Object.keys(m);y<w.length;y++){var E=w[y],R=s[Number(E)];if(R!=null){var D=m[E];delete m[E],m[R]=D}}throw new Ct("".concat(n.name,".bulkUpdate(): ").concat(M," of ").concat(p," operations failed"),m)})})})},e.prototype.bulkDelete=function(t){var n=this,i=t.length;return this._trans("readwrite",function(a){return n.core.mutate({trans:a,type:"delete",keys:t}).then(function(o){return dn(n,t,o)})}).then(function(a){var o=a.numFailures,s=a.lastResult,u=a.failures;if(o===0)return s;throw new Ct("".concat(n.name,".bulkDelete(): ").concat(o," of ").concat(i," operations failed"),u)})},e})();function Ft(e){var t={},n=function(u,c){if(c){for(var d=arguments.length,v=new Array(d-1);--d;)v[d-1]=arguments[d];return t[u].subscribe.apply(null,v),e}else if(typeof u=="string")return t[u]};n.addEventType=o;for(var i=1,a=arguments.length;i<a;++i)o(arguments[i]);return n;function o(u,c,d){if(typeof u=="object")return s(u);c||(c=Ta),d||(d=he);var v={subscribers:[],fire:d,subscribe:function(p){v.subscribers.indexOf(p)===-1&&(v.subscribers.push(p),v.fire=c(v.fire,p))},unsubscribe:function(p){v.subscribers=v.subscribers.filter(function(S){return S!==p}),v.fire=v.subscribers.reduce(c,d)}};return t[u]=n[u]=v,v}function s(u){k(u).forEach(function(c){var d=u[c];if(h(d))o(c,u[c][0],u[c][1]);else if(d==="asap")var v=o(c,Kt,function(){for(var S=arguments.length,M=new Array(S);S--;)M[S]=arguments[S];v.subscribers.forEach(function(m){de(function(){m.apply(null,M)})})});else throw new Q.InvalidArgument("Invalid event config")})}}function Lt(e,t){return j(t).from({prototype:e}),t}function Za(e){return Lt(ni.prototype,function(n,i,a){this.db=e,this._tx=a,this.name=n,this.schema=i,this.hook=e._allTables[n]?e._allTables[n].hook:Ft(null,{creating:[Aa,he],reading:[Pa,Kt],updating:[Da,he],deleting:[Ra,he]})})}function Rt(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function er(e,t){e.filter=mt(e.filter,t)}function tr(e,t,n){var i=e.replayFilter;e.replayFilter=i?function(){return mt(i(),t())}:t,e.justLimit=n&&!i}function Ya(e,t){e.isMatch=mt(e.isMatch,t)}function pn(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new Q.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function ri(e,t,n){var i=pn(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:i,range:e.range}})}function hn(e,t,n,i){var a=e.replayFilter?mt(e.filter,e.replayFilter()):e.filter;if(e.or){var o={},s=function(u,c,d){if(!a||a(c,d,function(S){return c.stop(S)},function(S){return c.fail(S)})){var v=c.primaryKey,p=""+v;p==="[object ArrayBuffer]"&&(p=""+new Uint8Array(v)),x(o,p)||(o[p]=!0,t(u,c,d))}};return Promise.all([e.or._iterate(s,n),ii(ri(e,i,n),e.algorithm,s,!e.keysOnly&&e.valueMapper)])}else return ii(ri(e,i,n),mt(e.algorithm,a),t,!e.keysOnly&&e.valueMapper)}function ii(e,t,n,i){var a=i?function(s,u,c){return n(i(s),u,c)}:n,o=ge(a);return e.then(function(s){if(s)return s.start(function(){var u=function(){return s.continue()};(!t||t(s,function(c){return u=c},function(c){s.stop(c),u=he},function(c){s.fail(c),u=he}))&&o(s.value,s,function(c){return u=c}),u()})})}var Ga=(function(){function e(){}return e.prototype._read=function(t,n){var i=this._ctx;return i.error?i.table._trans(null,xe.bind(null,i.error)):i.table._trans("readonly",t).then(n)},e.prototype._write=function(t){var n=this._ctx;return n.error?n.table._trans(null,xe.bind(null,n.error)):n.table._trans("readwrite",t,"locked")},e.prototype._addAlgorithm=function(t){var n=this._ctx;n.algorithm=mt(n.algorithm,t)},e.prototype._iterate=function(t,n){return hn(this._ctx,t,n,this._ctx.table.core)},e.prototype.clone=function(t){var n=Object.create(this.constructor.prototype),i=Object.create(this._ctx);return t&&b(i,t),n._ctx=i,n},e.prototype.raw=function(){return this._ctx.valueMapper=null,this},e.prototype.each=function(t){var n=this._ctx;return this._read(function(i){return hn(n,t,i,n.table.core)})},e.prototype.count=function(t){var n=this;return this._read(function(i){var a=n._ctx,o=a.table.core;if(Rt(a,!0))return o.count({trans:i,query:{index:pn(a,o.schema),range:a.range}}).then(function(u){return Math.min(u,a.limit)});var s=0;return hn(a,function(){return++s,!1},i,o).then(function(){return s})}).then(t)},e.prototype.sortBy=function(t,n){var i=t.split(".").reverse(),a=i[0],o=i.length-1;function s(d,v){return v?s(d[i[v]],v-1):d[a]}var u=this._ctx.dir==="next"?1:-1;function c(d,v){var p=s(d,o),S=s(v,o);return oe(p,S)*u}return this.toArray(function(d){return d.sort(c)}).then(n)},e.prototype.toArray=function(t){var n=this;return this._read(function(i){var a=n._ctx;if(a.dir==="next"&&Rt(a,!0)&&a.limit>0){var o=a.valueMapper,s=pn(a,a.table.core.schema);return a.table.core.query({trans:i,limit:a.limit,values:!0,query:{index:s,range:a.range}}).then(function(c){var d=c.result;return o?d.map(o):d})}else{var u=[];return hn(a,function(c){return u.push(c)},i,a.table.core).then(function(){return u})}},t)},e.prototype.offset=function(t){var n=this._ctx;return t<=0?this:(n.offset+=t,Rt(n)?tr(n,function(){var i=t;return function(a,o){return i===0?!0:i===1?(--i,!1):(o(function(){a.advance(i),i=0}),!1)}}):tr(n,function(){var i=t;return function(){return--i<0}}),this)},e.prototype.limit=function(t){return this._ctx.limit=Math.min(this._ctx.limit,t),tr(this._ctx,function(){var n=t;return function(i,a,o){return--n<=0&&a(o),n>=0}},!0),this},e.prototype.until=function(t,n){return er(this._ctx,function(i,a,o){return t(i.value)?(a(o),n):!0}),this},e.prototype.first=function(t){return this.limit(1).toArray(function(n){return n[0]}).then(t)},e.prototype.last=function(t){return this.reverse().first(t)},e.prototype.filter=function(t){return er(this._ctx,function(n){return t(n.value)}),Ya(this._ctx,t),this},e.prototype.and=function(t){return this.filter(t)},e.prototype.or=function(t){return new this.db.WhereClause(this._ctx.table,t,this)},e.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},e.prototype.desc=function(){return this.reverse()},e.prototype.eachKey=function(t){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(i,a){t(a.key,a)})},e.prototype.eachUniqueKey=function(t){return this._ctx.unique="unique",this.eachKey(t)},e.prototype.eachPrimaryKey=function(t){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(i,a){t(a.primaryKey,a)})},e.prototype.keys=function(t){var n=this._ctx;n.keysOnly=!n.isMatch;var i=[];return this.each(function(a,o){i.push(o.key)}).then(function(){return i}).then(t)},e.prototype.primaryKeys=function(t){var n=this._ctx;if(n.dir==="next"&&Rt(n,!0)&&n.limit>0)return this._read(function(a){var o=pn(n,n.table.core.schema);return n.table.core.query({trans:a,values:!1,limit:n.limit,query:{index:o,range:n.range}})}).then(function(a){var o=a.result;return o}).then(t);n.keysOnly=!n.isMatch;var i=[];return this.each(function(a,o){i.push(o.primaryKey)}).then(function(){return i}).then(t)},e.prototype.uniqueKeys=function(t){return this._ctx.unique="unique",this.keys(t)},e.prototype.firstKey=function(t){return this.limit(1).keys(function(n){return n[0]}).then(t)},e.prototype.lastKey=function(t){return this.reverse().firstKey(t)},e.prototype.distinct=function(){var t=this._ctx,n=t.index&&t.table.schema.idxByName[t.index];if(!n||!n.multi)return this;var i={};return er(this._ctx,function(a){var o=a.primaryKey.toString(),s=x(i,o);return i[o]=!0,!s}),this},e.prototype.modify=function(t){var n=this,i=this._ctx;return this._write(function(a){var o;typeof t=="function"?o=t:o=function(E){return ti(E,t)};var s=i.table.core,u=s.schema.primaryKey,c=u.outbound,d=u.extractKey,v=200,p=n.db._options.modifyChunkSize;p&&(typeof p=="object"?v=p[s.name]||p["*"]||200:v=p);var S=[],M=0,m=[],y=function(E,R){var D=R.failures,I=R.numFailures;M+=E-I;for(var A=0,$=k(D);A<$.length;A++){var z=$[A];S.push(D[z])}},w=t===ai;return n.clone().primaryKeys().then(function(E){var R=Rt(i)&&i.limit===1/0&&(typeof t!="function"||w)&&{index:i.index,range:i.range},D=function(I){var A=Math.min(v,E.length-I),$=E.slice(I,I+A);return(w?Promise.resolve([]):s.getMany({trans:a,keys:$,cache:"immutable"})).then(function(z){var F=[],V=[],re=c?[]:null,U=w?$:[];if(!w)for(var te=0;te<A;++te){var J=z[te],se={value:we(J),primKey:E[I+te]};o.call(se,se.value,se)!==!1&&(se.value==null?U.push(E[I+te]):!c&&oe(d(J),d(se.value))!==0?(U.push(E[I+te]),F.push(se.value)):(V.push(se.value),c&&re.push(E[I+te])))}return Promise.resolve(F.length>0&&s.mutate({trans:a,type:"add",values:F}).then(function(G){for(var _e in G.failures)U.splice(parseInt(_e),1);y(F.length,G)})).then(function(){return(V.length>0||R&&typeof t=="object")&&s.mutate({trans:a,type:"put",keys:re,values:V,criteria:R,changeSpec:typeof t!="function"&&t,isAdditionalChunk:I>0}).then(function(G){return y(V.length,G)})}).then(function(){return(U.length>0||R&&w)&&s.mutate({trans:a,type:"delete",keys:U,criteria:R,isAdditionalChunk:I>0}).then(function(G){return dn(i.table,U,G)}).then(function(G){return y(U.length,G)})}).then(function(){return E.length>I+A&&D(I+v)})})};return D(0).then(function(){if(S.length>0)throw new qt("Error modifying one or more objects",S,M,m);return E.length})})})},e.prototype.delete=function(){var t=this._ctx,n=t.range;return Rt(t)&&!t.table.schema.yProps&&(t.isPrimKey||n.type===3)?this._write(function(i){var a=t.table.core.schema.primaryKey,o=n;return t.table.core.count({trans:i,query:{index:a,range:o}}).then(function(s){return t.table.core.mutate({trans:i,type:"deleteRange",range:o}).then(function(u){var c=u.failures,d=u.numFailures;if(d)throw new qt("Could not delete some values",Object.keys(c).map(function(v){return c[v]}),s-d);return s-d})})}):this.modify(ai)},e})(),ai=function(e,t){return t.value=null};function Qa(e){return Lt(Ga.prototype,function(n,i){this.db=e;var a=Vr,o=null;if(i)try{a=i()}catch(d){o=d}var s=n._ctx,u=s.table,c=u.hook.reading.fire;this._ctx={table:u,index:s.index,isPrimKey:!s.index||u.schema.primKey.keyPath&&s.index===u.schema.primKey.name,range:a,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:o,or:s.or,valueMapper:c!==Kt?c:null}})}function Xa(e,t){return e<t?-1:e===t?0:1}function Va(e,t){return e>t?-1:e===t?0:1}function Te(e,t,n){var i=e instanceof si?new e.Collection(e):e;return i._ctx.error=n?new n(t):new TypeError(t),i}function Dt(e){return new e.Collection(e,function(){return oi("")}).limit(0)}function Ja(e){return e==="next"?function(t){return t.toUpperCase()}:function(t){return t.toLowerCase()}}function qa(e){return e==="next"?function(t){return t.toLowerCase()}:function(t){return t.toUpperCase()}}function eo(e,t,n,i,a,o){for(var s=Math.min(e.length,i.length),u=-1,c=0;c<s;++c){var d=t[c];if(d!==i[c])return a(e[c],n[c])<0?e.substr(0,c)+n[c]+n.substr(c+1):a(e[c],i[c])<0?e.substr(0,c)+i[c]+n.substr(c+1):u>=0?e.substr(0,u)+t[u]+n.substr(u+1):null;a(e[c],d)<0&&(u=c)}return s<i.length&&o==="next"?e+n.substr(e.length):s<e.length&&o==="prev"?e.substr(0,n.length):u<0?null:e.substr(0,u)+i[u]+n.substr(u+1)}function mn(e,t,n,i){var a,o,s,u,c,d,v,p=n.length;if(!n.every(function(y){return typeof y=="string"}))return Te(e,Xr);function S(y){a=Ja(y),o=qa(y),s=y==="next"?Xa:Va;var w=n.map(function(E){return{lower:o(E),upper:a(E)}}).sort(function(E,R){return s(E.lower,R.lower)});u=w.map(function(E){return E.upper}),c=w.map(function(E){return E.lower}),d=y,v=y==="next"?"":i}S("next");var M=new e.Collection(e,function(){return et(u[0],c[p-1]+i)});M._ondirectionchange=function(y){S(y)};var m=0;return M._addAlgorithm(function(y,w,E){var R=y.key;if(typeof R!="string")return!1;var D=o(R);if(t(D,c,m))return!0;for(var I=null,A=m;A<p;++A){var $=eo(R,D,u[A],c[A],s,d);$===null&&I===null?m=A+1:(I===null||s(I,$)>0)&&(I=$)}return w(I!==null?function(){y.continue(I+v)}:E),!1}),M}function et(e,t,n,i){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:i}}function oi(e){return{type:1,lower:e,upper:e}}var si=(function(){function e(){}return Object.defineProperty(e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),e.prototype.between=function(t,n,i,a){i=i!==!1,a=a===!0;try{return this._cmp(t,n)>0||this._cmp(t,n)===0&&(i||a)&&!(i&&a)?Dt(this):new this.Collection(this,function(){return et(t,n,!i,!a)})}catch{return Te(this,Ye)}},e.prototype.equals=function(t){return t==null?Te(this,Ye):new this.Collection(this,function(){return oi(t)})},e.prototype.above=function(t){return t==null?Te(this,Ye):new this.Collection(this,function(){return et(t,void 0,!0)})},e.prototype.aboveOrEqual=function(t){return t==null?Te(this,Ye):new this.Collection(this,function(){return et(t,void 0,!1)})},e.prototype.below=function(t){return t==null?Te(this,Ye):new this.Collection(this,function(){return et(void 0,t,!1,!0)})},e.prototype.belowOrEqual=function(t){return t==null?Te(this,Ye):new this.Collection(this,function(){return et(void 0,t)})},e.prototype.startsWith=function(t){return typeof t!="string"?Te(this,Xr):this.between(t,t+ht,!0,!0)},e.prototype.startsWithIgnoreCase=function(t){return t===""?this.startsWith(t):mn(this,function(n,i){return n.indexOf(i[0])===0},[t],ht)},e.prototype.equalsIgnoreCase=function(t){return mn(this,function(n,i){return n===i[0]},[t],"")},e.prototype.anyOfIgnoreCase=function(){var t=Me.apply(Ae,arguments);return t.length===0?Dt(this):mn(this,function(n,i){return i.indexOf(n)!==-1},t,"")},e.prototype.startsWithAnyOfIgnoreCase=function(){var t=Me.apply(Ae,arguments);return t.length===0?Dt(this):mn(this,function(n,i){return i.some(function(a){return n.indexOf(a)===0})},t,ht)},e.prototype.anyOf=function(){var t=this,n=Me.apply(Ae,arguments),i=this._cmp;try{n.sort(i)}catch{return Te(this,Ye)}if(n.length===0)return Dt(this);var a=new this.Collection(this,function(){return et(n[0],n[n.length-1])});a._ondirectionchange=function(s){i=s==="next"?t._ascending:t._descending,n.sort(i)};var o=0;return a._addAlgorithm(function(s,u,c){for(var d=s.key;i(d,n[o])>0;)if(++o,o===n.length)return u(c),!1;return i(d,n[o])===0?!0:(u(function(){s.continue(n[o])}),!1)}),a},e.prototype.notEqual=function(t){return this.inAnyRange([[Vn,t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},e.prototype.noneOf=function(){var t=Me.apply(Ae,arguments);if(t.length===0)return new this.Collection(this);try{t.sort(this._ascending)}catch{return Te(this,Ye)}var n=t.reduce(function(i,a){return i?i.concat([[i[i.length-1][1],a]]):[[Vn,a]]},null);return n.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})},e.prototype.inAnyRange=function(t,n){var i=this,a=this._cmp,o=this._ascending,s=this._descending,u=this._min,c=this._max;if(t.length===0)return Dt(this);if(!t.every(function(A){return A[0]!==void 0&&A[1]!==void 0&&o(A[0],A[1])<=0}))return Te(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Q.InvalidArgument);var d=!n||n.includeLowers!==!1,v=n&&n.includeUppers===!0;function p(A,$){for(var z=0,F=A.length;z<F;++z){var V=A[z];if(a($[0],V[1])<0&&a($[1],V[0])>0){V[0]=u(V[0],$[0]),V[1]=c(V[1],$[1]);break}}return z===F&&A.push($),A}var S=o;function M(A,$){return S(A[0],$[0])}var m;try{m=t.reduce(p,[]),m.sort(M)}catch{return Te(this,Ye)}var y=0,w=v?function(A){return o(A,m[y][1])>0}:function(A){return o(A,m[y][1])>=0},E=d?function(A){return s(A,m[y][0])>0}:function(A){return s(A,m[y][0])>=0};function R(A){return!w(A)&&!E(A)}var D=w,I=new this.Collection(this,function(){return et(m[0][0],m[m.length-1][1],!d,!v)});return I._ondirectionchange=function(A){A==="next"?(D=w,S=o):(D=E,S=s),m.sort(M)},I._addAlgorithm(function(A,$,z){for(var F=A.key;D(F);)if(++y,y===m.length)return $(z),!1;return R(F)?!0:(i._cmp(F,m[y][1])===0||i._cmp(F,m[y][0])===0||$(function(){S===o?A.continue(m[y][0]):A.continue(m[y][1])}),!1)}),I},e.prototype.startsWithAnyOf=function(){var t=Me.apply(Ae,arguments);return t.every(function(n){return typeof n=="string"})?t.length===0?Dt(this):this.inAnyRange(t.map(function(n){return[n,n+ht]})):Te(this,"startsWithAnyOf() only works with strings")},e})();function to(e){return Lt(si.prototype,function(n,i,a){if(this.db=e,this._ctx={table:n,index:i===":id"?null:i,or:a},this._cmp=this._ascending=oe,this._descending=function(o,s){return oe(s,o)},this._max=function(o,s){return oe(o,s)>0?o:s},this._min=function(o,s){return oe(o,s)<0?o:s},this._IDBKeyRange=e._deps.IDBKeyRange,!this._IDBKeyRange)throw new Q.MissingAPI})}function He(e){return ge(function(t){return zt(t),e(t.target.error),!1})}function zt(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var Ut="storagemutated",nr="x-storagemutated-1",tt=Ft(null,Ut),no=(function(){function e(){}return e.prototype._lock=function(){return ne(!Z.global),++this._reculock,this._reculock===1&&!Z.global&&(Z.lockOwnerFor=this),this},e.prototype._unlock=function(){if(ne(!Z.global),--this._reculock===0)for(Z.global||(Z.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{pt(t[1],t[0])}catch{}}return this},e.prototype._locked=function(){return this._reculock&&Z.lockOwnerFor!==this},e.prototype.create=function(t){var n=this;if(!this.mode)return this;var i=this.db.idbdb,a=this.db._state.dbOpenError;if(ne(!this.idbtrans),!t&&!i)switch(a&&a.name){case"DatabaseClosedError":throw new Q.DatabaseClosed(a);case"MissingAPIError":throw new Q.MissingAPI(a.message,a);default:throw new Q.OpenFailed(a)}if(!this.active)throw new Q.TransactionInactive;return ne(this._completion._state===null),t=this.idbtrans=t||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):i.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})),t.onerror=ge(function(o){zt(o),n._reject(t.error)}),t.onabort=ge(function(o){zt(o),n.active&&n._reject(new Q.Abort(t.error)),n.active=!1,n.on("abort").fire(o)}),t.oncomplete=ge(function(){n.active=!1,n._resolve(),"mutatedParts"in t&&tt.storagemutated.fire(t.mutatedParts)}),this},e.prototype._promise=function(t,n,i){var a=this;if(t==="readwrite"&&this.mode!=="readwrite")return xe(new Q.ReadOnly("Transaction is readonly"));if(!this.active)return xe(new Q.TransactionInactive);if(this._locked())return new L(function(s,u){a._blockedFuncs.push([function(){a._promise(t,n,i).then(s,u)},Z])});if(i)return Ve(function(){var s=new L(function(u,c){a._lock();var d=n(u,c,a);d&&d.then&&d.then(u,c)});return s.finally(function(){return a._unlock()}),s._lib=!0,s});var o=new L(function(s,u){var c=n(s,u,a);c&&c.then&&c.then(s,u)});return o._lib=!0,o},e.prototype._root=function(){return this.parent?this.parent._root():this},e.prototype.waitFor=function(t){var n=this._root(),i=L.resolve(t);if(n._waitingFor)n._waitingFor=n._waitingFor.then(function(){return i});else{n._waitingFor=i,n._waitingQueue=[];var a=n.idbtrans.objectStore(n.storeNames[0]);(function s(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(a.get(-1/0).onsuccess=s)})()}var o=n._waitingFor;return new L(function(s,u){i.then(function(c){return n._waitingQueue.push(ge(s.bind(null,c)))},function(c){return n._waitingQueue.push(ge(u.bind(null,c)))}).finally(function(){n._waitingFor===o&&(n._waitingFor=null)})})},e.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Q.Abort))},e.prototype.table=function(t){var n=this._memoizedTables||(this._memoizedTables={});if(x(n,t))return n[t];var i=this.schema[t];if(!i)throw new Q.NotFound("Table "+t+" not part of transaction");var a=new this.db.Table(t,i,this);return a.core=this.db.core.table(t),n[t]=a,a},e})();function ro(e){return Lt(no.prototype,function(n,i,a,o,s){var u=this;n!=="readonly"&&i.forEach(function(c){var d,v=(d=a[c])===null||d===void 0?void 0:d.yProps;v&&(i=i.concat(v.map(function(p){return p.updatesTable})))}),this.db=e,this.mode=n,this.storeNames=i,this.schema=a,this.chromeTransactionDurability=o,this.idbtrans=null,this.on=Ft(this,"complete","error","abort"),this.parent=s||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new L(function(c,d){u._resolve=c,u._reject=d}),this._completion.then(function(){u.active=!1,u.on.complete.fire()},function(c){var d=u.active;return u.active=!1,u.on.error.fire(c),u.parent?u.parent._reject(c):d&&u.idbtrans&&u.idbtrans.abort(),xe(c)})})}function rr(e,t,n,i,a,o,s,u){return{name:e,keyPath:t,unique:n,multi:i,auto:a,compound:o,src:(n&&!s?"&":"")+(i?"*":"")+(a?"++":"")+ui(t),type:u}}function ui(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function ir(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:ce(n,function(i){return[i.name,i]})}}function io(e){return e.length===1?e[0]:e}var Ht=function(e){try{return e.only([[]]),Ht=function(){return[[]]},[[]]}catch{return Ht=function(){return ht},ht}};function ar(e){return e==null?function(){}:typeof e=="string"?ao(e):function(t){return ae(t,e)}}function ao(e){var t=e.split(".");return t.length===1?function(n){return n[e]}:function(n){return ae(n,e)}}function ci(e){return[].slice.call(e)}var oo=0;function Wt(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function so(e,t,n){function i(p,S){var M=ci(p.objectStoreNames);return{schema:{name:p.name,tables:M.map(function(m){return S.objectStore(m)}).map(function(m){var y=m.keyPath,w=m.autoIncrement,E=h(y),R=y==null,D={},I={name:m.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:R,compound:E,keyPath:y,autoIncrement:w,unique:!0,extractKey:ar(y)},indexes:ci(m.indexNames).map(function(A){return m.index(A)}).map(function(A){var $=A.name,z=A.unique,F=A.multiEntry,V=A.keyPath,re=h(V),U={name:$,compound:re,keyPath:V,unique:z,multiEntry:F,extractKey:ar(V)};return D[Wt(V)]=U,U}),getIndexByKeyPath:function(A){return D[Wt(A)]}};return D[":id"]=I.primaryKey,y!=null&&(D[Wt(y)]=I.primaryKey),I})},hasGetAll:M.length>0&&"getAll"in S.objectStore(M[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function a(p){if(p.type===3)return null;if(p.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var S=p.lower,M=p.upper,m=p.lowerOpen,y=p.upperOpen,w=S===void 0?M===void 0?null:t.upperBound(M,!!y):M===void 0?t.lowerBound(S,!!m):t.bound(S,M,!!m,!!y);return w}function o(p){var S=p.name;function M(w){var E=w.trans,R=w.type,D=w.keys,I=w.values,A=w.range;return new Promise(function($,z){$=ge($);var F=E.objectStore(S),V=F.keyPath==null,re=R==="put"||R==="add";if(!re&&R!=="delete"&&R!=="deleteRange")throw new Error("Invalid operation type: "+R);var U=(D||I||{length:1}).length;if(D&&I&&D.length!==I.length)throw new Error("Given keys array must have same length as given values array.");if(U===0)return $({numFailures:0,failures:{},results:[],lastResult:void 0});var te,J=[],se=[],G=0,_e=function(Ze){++G,zt(Ze)};if(R==="deleteRange"){if(A.type===4)return $({numFailures:G,failures:se,results:[],lastResult:void 0});A.type===3?J.push(te=F.clear()):J.push(te=F.delete(a(A)))}else{var Ee=re?V?[I,D]:[I,null]:[D,null],We=Ee[0],Re=Ee[1];if(re)for(var Ke=0;Ke<U;++Ke)J.push(te=Re&&Re[Ke]!==void 0?F[R](We[Ke],Re[Ke]):F[R](We[Ke])),te.onerror=_e;else for(var Ke=0;Ke<U;++Ke)J.push(te=F[R](We[Ke])),te.onerror=_e}var it=function(Ze){var Gt=Ze.target.result;J.forEach(function(Fe,Pn){return Fe.error!=null&&(se[Pn]=Fe.error)}),$({numFailures:G,failures:se,results:R==="delete"?D:J.map(function(Fe){return Fe.result}),lastResult:Gt})};te.onerror=function(Ze){_e(Ze),it(Ze)},te.onsuccess=it})}function m(w){var E=w.trans,R=w.values,D=w.query,I=w.reverse,A=w.unique;return new Promise(function($,z){$=ge($);var F=D.index,V=D.range,re=E.objectStore(S),U=F.isPrimaryKey?re:re.index(F.name),te=I?A?"prevunique":"prev":A?"nextunique":"next",J=R||!("openKeyCursor"in U)?U.openCursor(a(V),te):U.openKeyCursor(a(V),te);J.onerror=He(z),J.onsuccess=ge(function(se){var G=J.result;if(!G){$(null);return}G.___id=++oo,G.done=!1;var _e=G.continue.bind(G),Ee=G.continuePrimaryKey;Ee&&(Ee=Ee.bind(G));var We=G.advance.bind(G),Re=function(){throw new Error("Cursor not started")},Ke=function(){throw new Error("Cursor not stopped")};G.trans=E,G.stop=G.continue=G.continuePrimaryKey=G.advance=Re,G.fail=ge(z),G.next=function(){var it=this,Ze=1;return this.start(function(){return Ze--?it.continue():it.stop()}).then(function(){return it})},G.start=function(it){var Ze=new Promise(function(Fe,Pn){Fe=ge(Fe),J.onerror=He(Pn),G.fail=Pn,G.stop=function(Qo){G.stop=G.continue=G.continuePrimaryKey=G.advance=Ke,Fe(Qo)}}),Gt=function(){if(J.result)try{it()}catch(Fe){G.fail(Fe)}else G.done=!0,G.start=function(){throw new Error("Cursor behind last entry")},G.stop()};return J.onsuccess=ge(function(Fe){J.onsuccess=Gt,Gt()}),G.continue=_e,G.continuePrimaryKey=Ee,G.advance=We,Gt(),Ze},$(G)},z)})}function y(w){return function(E){return new Promise(function(R,D){R=ge(R);var I=E.trans,A=E.values,$=E.limit,z=E.query,F=$===1/0?void 0:$,V=z.index,re=z.range,U=I.objectStore(S),te=V.isPrimaryKey?U:U.index(V.name),J=a(re);if($===0)return R({result:[]});if(w){var se=A?te.getAll(J,F):te.getAllKeys(J,F);se.onsuccess=function(We){return R({result:We.target.result})},se.onerror=He(D)}else{var G=0,_e=A||!("openKeyCursor"in te)?te.openCursor(J):te.openKeyCursor(J),Ee=[];_e.onsuccess=function(We){var Re=_e.result;if(!Re)return R({result:Ee});if(Ee.push(A?Re.value:Re.primaryKey),++G===$)return R({result:Ee});Re.continue()},_e.onerror=He(D)}})}}return{name:S,schema:p,mutate:M,getMany:function(w){var E=w.trans,R=w.keys;return new Promise(function(D,I){D=ge(D);for(var A=E.objectStore(S),$=R.length,z=new Array($),F=0,V=0,re,U=function(G){var _e=G.target;(z[_e._pos]=_e.result)!=null,++V===F&&D(z)},te=He(I),J=0;J<$;++J){var se=R[J];se!=null&&(re=A.get(R[J]),re._pos=J,re.onsuccess=U,re.onerror=te,++F)}F===0&&D(z)})},get:function(w){var E=w.trans,R=w.key;return new Promise(function(D,I){D=ge(D);var A=E.objectStore(S),$=A.get(R);$.onsuccess=function(z){return D(z.target.result)},$.onerror=He(I)})},query:y(c),openCursor:m,count:function(w){var E=w.query,R=w.trans,D=E.index,I=E.range;return new Promise(function(A,$){var z=R.objectStore(S),F=D.isPrimaryKey?z:z.index(D.name),V=a(I),re=V?F.count(V):F.count();re.onsuccess=ge(function(U){return A(U.target.result)}),re.onerror=He($)})}}}var s=i(e,n),u=s.schema,c=s.hasGetAll,d=u.tables.map(function(p){return o(p)}),v={};return d.forEach(function(p){return v[p.name]=p}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(p){var S=v[p];if(!S)throw new Error("Table '".concat(p,"' not found"));return v[p]},MIN_KEY:-1/0,MAX_KEY:Ht(t),schema:u}}function uo(e,t){return t.reduce(function(n,i){var a=i.create;return l(l({},n),a(n))},e)}function co(e,t,n,i){var a=n.IDBKeyRange;n.indexedDB;var o=uo(so(t,a,i),e.dbcore);return{dbcore:o}}function vn(e,t){var n=t.db,i=co(e._middlewares,n,e._deps,t);e.core=i.dbcore,e.tables.forEach(function(a){var o=a.name;e.core.schema.tables.some(function(s){return s.name===o})&&(a.core=e.core.table(o),e[o]instanceof e.Table&&(e[o].core=a.core))})}function yn(e,t,n,i){n.forEach(function(a){var o=i[a];t.forEach(function(s){var u=H(s,a);(!u||"value"in u&&u.value===void 0)&&(s===e.Transaction.prototype||s instanceof e.Transaction?B(s,a,{get:function(){return this.table(a)},set:function(c){T(this,a,{value:c,writable:!0,configurable:!0,enumerable:!0})}}):s[a]=new e.Table(a,o))})})}function or(e,t){t.forEach(function(n){for(var i in n)n[i]instanceof e.Table&&delete n[i]})}function lo(e,t){return e._cfg.version-t._cfg.version}function fo(e,t,n,i){var a=e._dbSchema;n.objectStoreNames.contains("$meta")&&!a.$meta&&(a.$meta=ir("$meta",fi("")[0],[]),e._storeNames.push("$meta"));var o=e._createTransaction("readwrite",e._storeNames,a);o.create(n),o._completion.catch(i);var s=o._reject.bind(o),u=Z.transless||Z;Ve(function(){if(Z.trans=o,Z.transless=u,t===0)k(a).forEach(function(c){ur(n,c,a[c].primKey,a[c].indexes)}),vn(e,n),L.follow(function(){return e.on.populate.fire(o)}).catch(s);else return vn(e,n),ho(e,o,t).then(function(c){return mo(e,c,o,n)}).catch(s)})}function po(e,t){li(e._dbSchema,t),t.db.version%10===0&&!t.objectStoreNames.contains("$meta")&&t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var n=bn(e,e.idbdb,t);_n(e,e._dbSchema,t);for(var i=sr(n,e._dbSchema),a=function(d){if(d.change.length||d.recreate)return console.warn("Unable to patch indexes of table ".concat(d.name," because it has changes on the type of index or primary key.")),{value:void 0};var v=t.objectStore(d.name);d.add.forEach(function(p){Ue&&console.debug("Dexie upgrade patch: Creating missing index ".concat(d.name,".").concat(p.src)),gn(v,p)})},o=0,s=i.change;o<s.length;o++){var u=s[o],c=a(u);if(typeof c=="object")return c.value}}function ho(e,t,n){return t.storeNames.includes("$meta")?t.table("$meta").get("version").then(function(i){return i??n}):L.resolve(n)}function mo(e,t,n,i){var a=[],o=e._versions,s=e._dbSchema=bn(e,e.idbdb,i),u=o.filter(function(d){return d._cfg.version>=t});if(u.length===0)return L.resolve();u.forEach(function(d){a.push(function(){var v=s,p=d._cfg.dbschema;_n(e,v,i),_n(e,p,i),s=e._dbSchema=p;var S=sr(v,p);S.add.forEach(function(R){ur(i,R[0],R[1].primKey,R[1].indexes)}),S.change.forEach(function(R){if(R.recreate)throw new Q.Upgrade("Not yet support for changing primary key");var D=i.objectStore(R.name);R.add.forEach(function(I){return gn(D,I)}),R.change.forEach(function(I){D.deleteIndex(I.name),gn(D,I)}),R.del.forEach(function(I){return D.deleteIndex(I)})});var M=d._cfg.contentUpgrade;if(M&&d._cfg.version>t){vn(e,i),n._memoizedTables={};var m=ve(p);S.del.forEach(function(R){m[R]=v[R]}),or(e,[e.Transaction.prototype]),yn(e,[e.Transaction.prototype],k(m),m),n.schema=m;var y=xt(M);y&&Pt();var w,E=L.follow(function(){if(w=M(n),w&&y){var R=Je.bind(null,null);w.then(R,R)}});return w&&typeof w.then=="function"?L.resolve(w):E.then(function(){return w})}}),a.push(function(v){var p=d._cfg.dbschema;vo(p,v),or(e,[e.Transaction.prototype]),yn(e,[e.Transaction.prototype],e._storeNames,e._dbSchema),n.schema=e._dbSchema}),a.push(function(v){e.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(e.idbdb.version/10)===d._cfg.version?(e.idbdb.deleteObjectStore("$meta"),delete e._dbSchema.$meta,e._storeNames=e._storeNames.filter(function(p){return p!=="$meta"})):v.objectStore("$meta").put(d._cfg.version,"version"))})});function c(){return a.length?L.resolve(a.shift()(n.idbtrans)).then(c):L.resolve()}return c().then(function(){li(s,i)})}function sr(e,t){var n={del:[],add:[],change:[]},i;for(i in e)t[i]||n.del.push(i);for(i in t){var a=e[i],o=t[i];if(!a)n.add.push([i,o]);else{var s={name:i,def:o,recreate:!1,del:[],add:[],change:[]};if(""+(a.primKey.keyPath||"")!=""+(o.primKey.keyPath||"")||a.primKey.auto!==o.primKey.auto)s.recreate=!0,n.change.push(s);else{var u=a.idxByName,c=o.idxByName,d=void 0;for(d in u)c[d]||s.del.push(d);for(d in c){var v=u[d],p=c[d];v?v.src!==p.src&&s.change.push(p):s.add.push(p)}(s.del.length>0||s.add.length>0||s.change.length>0)&&n.change.push(s)}}}return n}function ur(e,t,n,i){var a=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return i.forEach(function(o){return gn(a,o)}),a}function li(e,t){k(e).forEach(function(n){t.db.objectStoreNames.contains(n)||(Ue&&console.debug("Dexie: Creating missing table",n),ur(t,n,e[n].primKey,e[n].indexes))})}function vo(e,t){[].slice.call(t.db.objectStoreNames).forEach(function(n){return e[n]==null&&t.db.deleteObjectStore(n)})}function gn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function bn(e,t,n){var i={},a=Y(t.objectStoreNames,0);return a.forEach(function(o){for(var s=n.objectStore(o),u=s.keyPath,c=rr(ui(u),u||"",!0,!1,!!s.autoIncrement,u&&typeof u!="string",!0),d=[],v=0;v<s.indexNames.length;++v){var p=s.index(s.indexNames[v]);u=p.keyPath;var S=rr(p.name,u,!!p.unique,!!p.multiEntry,!1,u&&typeof u!="string",!1);d.push(S)}i[o]=ir(o,c,d)}),i}function yo(e,t,n){e.verno=t.version/10;var i=e._dbSchema=bn(e,t,n);e._storeNames=Y(t.objectStoreNames,0),yn(e,[e._allTables],k(i),i)}function go(e,t){var n=bn(e,e.idbdb,t),i=sr(n,e._dbSchema);return!(i.add.length||i.change.some(function(a){return a.add.length||a.change.length}))}function _n(e,t,n){for(var i=n.db.objectStoreNames,a=0;a<i.length;++a){var o=i[a],s=n.objectStore(o);e._hasGetAll="getAll"in s;for(var u=0;u<s.indexNames.length;++u){var c=s.indexNames[u],d=s.index(c).keyPath,v=typeof d=="string"?d:"["+Y(d).join("+")+"]";if(t[o]){var p=t[o].idxByName[v];p&&(p.name=c,delete t[o].idxByName[v],t[o].idxByName[c]=p)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&g.WorkerGlobalScope&&g instanceof g.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function fi(e){return e.split(",").map(function(t,n){var i,a=t.split(":"),o=(i=a[1])===null||i===void 0?void 0:i.trim();t=a[0].trim();var s=t.replace(/([&*]|\+\+)/g,""),u=/^\[/.test(s)?s.match(/^\[(.*)\]$/)[1].split("+"):s;return rr(s,u||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),h(u),n===0,o)})}var bo=(function(){function e(){}return e.prototype._createTableSchema=function(t,n,i){return ir(t,n,i)},e.prototype._parseIndexSyntax=function(t){return fi(t)},e.prototype._parseStoresSpec=function(t,n){var i=this;k(t).forEach(function(a){if(t[a]!==null){var o=i._parseIndexSyntax(t[a]),s=o.shift();if(!s)throw new Q.Schema("Invalid schema for table "+a+": "+t[a]);if(s.unique=!0,s.multi)throw new Q.Schema("Primary key cannot be multiEntry*");o.forEach(function(c){if(c.auto)throw new Q.Schema("Only primary key can be marked as autoIncrement (++)");if(!c.keyPath)throw new Q.Schema("Index must have a name and cannot be an empty string")});var u=i._createTableSchema(a,s,o);n[a]=u}})},e.prototype.stores=function(t){var n=this.db;this._cfg.storesSource=this._cfg.storesSource?b(this._cfg.storesSource,t):t;var i=n._versions,a={},o={};return i.forEach(function(s){b(a,s._cfg.storesSource),o=s._cfg.dbschema={},s._parseStoresSpec(a,o)}),n._dbSchema=o,or(n,[n._allTables,n,n.Transaction.prototype]),yn(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],k(o),o),n._storeNames=k(o),this},e.prototype.upgrade=function(t){return this._cfg.contentUpgrade=Fn(this._cfg.contentUpgrade||he,t),this},e})();function _o(e){return Lt(bo.prototype,function(n){this.db=e,this._cfg={version:n,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}function cr(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new Ge(ln,{addons:[],indexedDB:e,IDBKeyRange:t}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function lr(e){return e&&typeof e.databases=="function"}function wo(e){var t=e.indexedDB,n=e.IDBKeyRange;return lr(t)?Promise.resolve(t.databases()).then(function(i){return i.map(function(a){return a.name}).filter(function(a){return a!==ln})}):cr(t,n).toCollection().primaryKeys()}function xo(e,t){var n=e.indexedDB,i=e.IDBKeyRange;!lr(n)&&t!==ln&&cr(n,i).put({name:t}).catch(he)}function So(e,t){var n=e.indexedDB,i=e.IDBKeyRange;!lr(n)&&t!==ln&&cr(n,i).delete(t).catch(he)}function fr(e){return Ve(function(){return Z.letThrough=!0,e()})}function Co(){var e=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!e||!indexedDB.databases)return Promise.resolve();var t;return new Promise(function(n){var i=function(){return indexedDB.databases().finally(n)};t=setInterval(i,100),i()}).finally(function(){return clearInterval(t)})}var dr;function pr(e){return!("from"in e)}var ke=function(e,t){if(this)b(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0});else{var n=new ke;return e&&"d"in e&&b(n,e),n}};O(ke.prototype,(dr={add:function(e){return Yt(this,e),this},addKey:function(e){return Zt(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(n){return Zt(t,n,n)}),this},hasKey:function(e){var t=wn(this).next(e).value;return t&&oe(t.from,e)<=0&&oe(t.to,e)>=0}},dr[Qe]=function(){return wn(this)},dr));function Zt(e,t,n){var i=oe(t,n);if(!isNaN(i)){if(i>0)throw RangeError();if(pr(e))return b(e,{from:t,to:n,d:1});var a=e.l,o=e.r;if(oe(n,e.from)<0)return a?Zt(a,t,n):e.l={from:t,to:n,d:1,l:null,r:null},pi(e);if(oe(t,e.to)>0)return o?Zt(o,t,n):e.r={from:t,to:n,d:1,l:null,r:null},pi(e);oe(t,e.from)<0&&(e.from=t,e.l=null,e.d=o?o.d+1:1),oe(n,e.to)>0&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1);var s=!e.r;a&&!e.l&&Yt(e,a),o&&s&&Yt(e,o)}}function Yt(e,t){function n(i,a){var o=a.from,s=a.to,u=a.l,c=a.r;Zt(i,o,s),u&&n(i,u),c&&n(i,c)}pr(t)||n(e,t)}function di(e,t){var n=wn(t),i=n.next();if(i.done)return!1;for(var a=i.value,o=wn(e),s=o.next(a.from),u=s.value;!i.done&&!s.done;){if(oe(u.from,a.to)<=0&&oe(u.to,a.from)>=0)return!0;oe(a.from,u.from)<0?a=(i=n.next(u.from)).value:u=(s=o.next(a.from)).value}return!1}function wn(e){var t=pr(e)?null:{s:0,n:e};return{next:function(n){for(var i=arguments.length>0;t;)switch(t.s){case 0:if(t.s=1,i)for(;t.n.l&&oe(n,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!i||oe(n,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function pi(e){var t,n,i=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((n=e.l)===null||n===void 0?void 0:n.d)||0),a=i>1?"r":i<-1?"l":"";if(a){var o=a==="r"?"l":"r",s=l({},e),u=e[a];e.from=u.from,e.to=u.to,e[a]=u[a],s[a]=u[o],e[o]=s,s.d=hi(s)}e.d=hi(e)}function hi(e){var t=e.r,n=e.l;return(t?n?Math.max(t.d,n.d):t.d:n?n.d:0)+1}function xn(e,t){return k(t).forEach(function(n){e[n]?Yt(e[n],t[n]):e[n]=ee(t[n])}),e}function hr(e,t){return e.all||t.all||Object.keys(e).some(function(n){return t[n]&&di(t[n],e[n])})}var vt={},mr={},vr=!1;function Sn(e,t){xn(mr,e),vr||(vr=!0,setTimeout(function(){vr=!1;var n=mr;mr={},yr(n,!1)},0))}function yr(e,t){t===void 0&&(t=!1);var n=new Set;if(e.all)for(var i=0,a=Object.values(vt);i<a.length;i++){var o=a[i];mi(o,e,n,t)}else for(var s in e){var u=/^idb\:\/\/(.*)\/(.*)\//.exec(s);if(u){var c=u[1],d=u[2],o=vt["idb://".concat(c,"/").concat(d)];o&&mi(o,e,n,t)}}n.forEach(function(v){return v()})}function mi(e,t,n,i){for(var a=[],o=0,s=Object.entries(e.queries.query);o<s.length;o++){for(var u=s[o],c=u[0],d=u[1],v=[],p=0,S=d;p<S.length;p++){var M=S[p];hr(t,M.obsSet)?M.subscribers.forEach(function(E){return n.add(E)}):i&&v.push(M)}i&&a.push([c,v])}if(i)for(var m=0,y=a;m<y.length;m++){var w=y[m],c=w[0],v=w[1];e.queries.query[c]=v}}function ko(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?xe(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var i=t.openCanceller,a=Math.round(e.verno*10),o=!1;function s(){if(t.openCanceller!==i)throw new Q.DatabaseClosed("db.open() was cancelled")}var u=t.dbReadyResolve,c=null,d=!1,v=function(){return new L(function(p,S){if(s(),!n)throw new Q.MissingAPI;var M=e.name,m=t.autoSchema||!a?n.open(M):n.open(M,a);if(!m)throw new Q.MissingAPI;m.onerror=He(S),m.onblocked=ge(e._fireOnBlocked),m.onupgradeneeded=ge(function(y){if(c=m.transaction,t.autoSchema&&!e._options.allowEmptyDB){m.onerror=zt,c.abort(),m.result.close();var w=n.deleteDatabase(M);w.onsuccess=w.onerror=ge(function(){S(new Q.NoSuchDatabase("Database ".concat(M," doesnt exist")))})}else{c.onerror=He(S);var E=y.oldVersion>Math.pow(2,62)?0:y.oldVersion;d=E<1,e.idbdb=m.result,o&&po(e,c),fo(e,E/10,c,S)}},S),m.onsuccess=ge(function(){c=null;var y=e.idbdb=m.result,w=Y(y.objectStoreNames);if(w.length>0)try{var E=y.transaction(io(w),"readonly");if(t.autoSchema)yo(e,y,E);else if(_n(e,e._dbSchema,E),!go(e,E)&&!o)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),y.close(),a=y.version+1,o=!0,p(v());vn(e,E)}catch{}At.push(e),y.onversionchange=ge(function(R){t.vcFired=!0,e.on("versionchange").fire(R)}),y.onclose=ge(function(){e.close({disableAutoOpen:!1})}),d&&xo(e._deps,M),p()},S)}).catch(function(p){switch(p?.name){case"UnknownError":if(t.PR1398_maxLoop>0)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),v();break;case"VersionError":if(a>0)return a=0,v();break}return L.reject(p)})};return L.race([i,(typeof navigator>"u"?L.resolve():Co()).then(v)]).then(function(){return s(),t.onReadyBeingFired=[],L.resolve(fr(function(){return e.on.ready.fire(e.vip)})).then(function p(){if(t.onReadyBeingFired.length>0){var S=t.onReadyBeingFired.reduce(Fn,he);return t.onReadyBeingFired=[],L.resolve(fr(function(){return S(e.vip)})).then(p)}})}).finally(function(){t.openCanceller===i&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(p){t.dbOpenError=p;try{c&&c.abort()}catch{}return i===t.openCanceller&&e._close(),xe(p)}).finally(function(){t.openComplete=!0,u()}).then(function(){if(d){var p={};e.tables.forEach(function(S){S.schema.indexes.forEach(function(M){M.name&&(p["idb://".concat(e.name,"/").concat(S.name,"/").concat(M.name)]=new ke(-1/0,[[[]]]))}),p["idb://".concat(e.name,"/").concat(S.name,"/")]=p["idb://".concat(e.name,"/").concat(S.name,"/:dels")]=new ke(-1/0,[[[]]])}),tt(Ut).fire(p),yr(p,!0)}return e})}function gr(e){var t=function(s){return e.next(s)},n=function(s){return e.throw(s)},i=o(t),a=o(n);function o(s){return function(u){var c=s(u),d=c.value;return c.done?d:!d||typeof d.then!="function"?h(d)?Promise.all(d).then(i,a):i(d):d.then(i,a)}}return o(t)()}function Eo(e,t,n){var i=arguments.length;if(i<2)throw new Q.InvalidArgument("Too few arguments");for(var a=new Array(i-1);--i;)a[i-1]=arguments[i];n=a.pop();var o=pe(a);return[e,o,n]}function vi(e,t,n,i,a){return L.resolve().then(function(){var o=Z.transless||Z,s=e._createTransaction(t,n,e._dbSchema,i);s.explicit=!0;var u={trans:s,transless:o};if(i)s.idbtrans=i.idbtrans;else try{s.create(),s.idbtrans._explicit=!0,e._state.PR1398_maxLoop=3}catch(p){return p.name===$n.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then(function(){return vi(e,t,n,null,a)})):xe(p)}var c=xt(a);c&&Pt();var d,v=L.follow(function(){if(d=a.call(s,s),d)if(c){var p=Je.bind(null,null);d.then(p,p)}else typeof d.next=="function"&&typeof d.throw=="function"&&(d=gr(d))},u);return(d&&typeof d.then=="function"?L.resolve(d).then(function(p){return s.active?p:xe(new Q.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):v.then(function(){return d})).then(function(p){return i&&s._resolve(),s._completion.then(function(){return p})}).catch(function(p){return s._reject(p),xe(p)})})}function Cn(e,t,n){for(var i=h(e)?e.slice():[e],a=0;a<n;++a)i.push(t);return i}function Po(e){return l(l({},e),{table:function(t){var n=e.table(t),i=n.schema,a={},o=[];function s(y,w,E){var R=Wt(y),D=a[R]=a[R]||[],I=y==null?0:typeof y=="string"?1:y.length,A=w>0,$=l(l({},E),{name:A?"".concat(R,"(virtual-from:").concat(E.name,")"):E.name,lowLevelIndex:E,isVirtual:A,keyTail:w,keyLength:I,extractKey:ar(y),unique:!A&&E.unique});if(D.push($),$.isPrimaryKey||o.push($),I>1){var z=I===2?y[0]:y.slice(0,I-1);s(z,w+1,E)}return D.sort(function(F,V){return F.keyTail-V.keyTail}),$}var u=s(i.primaryKey.keyPath,0,i.primaryKey);a[":id"]=[u];for(var c=0,d=i.indexes;c<d.length;c++){var v=d[c];s(v.keyPath,0,v)}function p(y){var w=a[Wt(y)];return w&&w[0]}function S(y,w){return{type:y.type===1?2:y.type,lower:Cn(y.lower,y.lowerOpen?e.MAX_KEY:e.MIN_KEY,w),lowerOpen:!0,upper:Cn(y.upper,y.upperOpen?e.MIN_KEY:e.MAX_KEY,w),upperOpen:!0}}function M(y){var w=y.query.index;return w.isVirtual?l(l({},y),{query:{index:w.lowLevelIndex,range:S(y.query.range,w.keyTail)}}):y}var m=l(l({},n),{schema:l(l({},i),{primaryKey:u,indexes:o,getIndexByKeyPath:p}),count:function(y){return n.count(M(y))},query:function(y){return n.query(M(y))},openCursor:function(y){var w=y.query.index,E=w.keyTail,R=w.isVirtual,D=w.keyLength;if(!R)return n.openCursor(y);function I(A){function $(F){F!=null?A.continue(Cn(F,y.reverse?e.MAX_KEY:e.MIN_KEY,E)):y.unique?A.continue(A.key.slice(0,D).concat(y.reverse?e.MIN_KEY:e.MAX_KEY,E)):A.continue()}var z=Object.create(A,{continue:{value:$},continuePrimaryKey:{value:function(F,V){A.continuePrimaryKey(Cn(F,e.MAX_KEY,E),V)}},primaryKey:{get:function(){return A.primaryKey}},key:{get:function(){var F=A.key;return D===1?F[0]:F.slice(0,D)}},value:{get:function(){return A.value}}});return z}return n.openCursor(M(y)).then(function(A){return A&&I(A)})}});return m}})}var Ao={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:Po};function br(e,t,n,i){return n=n||{},i=i||"",k(e).forEach(function(a){if(!x(t,a))n[i+a]=void 0;else{var o=e[a],s=t[a];if(typeof o=="object"&&typeof s=="object"&&o&&s){var u=_t(o),c=_t(s);u!==c?n[i+a]=t[a]:u==="Object"?br(o,s,n,i+a+"."):o!==s&&(n[i+a]=t[a])}else o!==s&&(n[i+a]=t[a])}}),k(t).forEach(function(a){x(e,a)||(n[i+a]=t[a])}),n}function _r(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var Ro={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return l(l({},e),{table:function(t){var n=e.table(t),i=n.schema.primaryKey,a=l(l({},n),{mutate:function(o){var s=Z.trans,u=s.table(t).hook,c=u.deleting,d=u.creating,v=u.updating;switch(o.type){case"add":if(d.fire===he)break;return s._promise("readwrite",function(){return p(o)},!0);case"put":if(d.fire===he&&v.fire===he)break;return s._promise("readwrite",function(){return p(o)},!0);case"delete":if(c.fire===he)break;return s._promise("readwrite",function(){return p(o)},!0);case"deleteRange":if(c.fire===he)break;return s._promise("readwrite",function(){return S(o)},!0)}return n.mutate(o);function p(m){var y=Z.trans,w=m.keys||_r(i,m);if(!w)throw new Error("Keys missing");return m=m.type==="add"||m.type==="put"?l(l({},m),{keys:w}):l({},m),m.type!=="delete"&&(m.values=C([],m.values,!0)),m.keys&&(m.keys=C([],m.keys,!0)),Do(n,m,w).then(function(E){var R=w.map(function(D,I){var A=E[I],$={onerror:null,onsuccess:null};if(m.type==="delete")c.fire.call($,D,A,y);else if(m.type==="add"||A===void 0){var z=d.fire.call($,D,m.values[I],y);D==null&&z!=null&&(D=z,m.keys[I]=D,i.outbound||ie(m.values[I],i.keyPath,D))}else{var F=br(A,m.values[I]),V=v.fire.call($,F,D,A,y);if(V){var re=m.values[I];Object.keys(V).forEach(function(U){x(re,U)?re[U]=V[U]:ie(re,U,V[U])})}}return $});return n.mutate(m).then(function(D){for(var I=D.failures,A=D.results,$=D.numFailures,z=D.lastResult,F=0;F<w.length;++F){var V=A?A[F]:w[F],re=R[F];V==null?re.onerror&&re.onerror(I[F]):re.onsuccess&&re.onsuccess(m.type==="put"&&E[F]?m.values[F]:V)}return{failures:I,results:A,numFailures:$,lastResult:z}}).catch(function(D){return R.forEach(function(I){return I.onerror&&I.onerror(D)}),Promise.reject(D)})})}function S(m){return M(m.trans,m.range,1e4)}function M(m,y,w){return n.query({trans:m,values:!1,query:{index:i,range:y},limit:w}).then(function(E){var R=E.result;return p({type:"delete",keys:R,trans:m}).then(function(D){return D.numFailures>0?Promise.reject(D.failures[0]):R.length<w?{failures:[],numFailures:0,lastResult:void 0}:M(m,l(l({},y),{lower:R[R.length-1],lowerOpen:!0}),w)})})}}});return a}})}};function Do(e,t,n){return t.type==="add"?Promise.resolve([]):e.getMany({trans:t.trans,keys:n,cache:"immutable"})}function yi(e,t,n){try{if(!t||t.keys.length<e.length)return null;for(var i=[],a=0,o=0;a<t.keys.length&&o<e.length;++a)oe(t.keys[a],e[o])===0&&(i.push(n?we(t.values[a]):t.values[a]),++o);return i.length===e.length?i:null}catch{return null}}var To={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var n=e.table(t);return l(l({},n),{getMany:function(i){if(!i.cache)return n.getMany(i);var a=yi(i.keys,i.trans._cache,i.cache==="clone");return a?L.resolve(a):n.getMany(i).then(function(o){return i.trans._cache={keys:i.keys,values:i.cache==="clone"?we(o):o},o})},mutate:function(i){return i.type!=="add"&&(i.trans._cache=null),n.mutate(i)}})}}}};function gi(e,t){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!t.schema.primaryKey.outbound}function bi(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":return!1;case"getMany":return!1;case"count":return!1;case"openCursor":return!1}}var Io={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,n=new ke(e.MIN_KEY,e.MAX_KEY);return l(l({},e),{transaction:function(i,a,o){if(Z.subscr&&a!=="readonly")throw new Q.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Z.querier));return e.transaction(i,a,o)},table:function(i){var a=e.table(i),o=a.schema,s=o.primaryKey,u=o.indexes,c=s.extractKey,d=s.outbound,v=s.autoIncrement&&u.filter(function(m){return m.compound&&m.keyPath.includes(s.keyPath)}),p=l(l({},a),{mutate:function(m){var y,w,E=m.trans,R=m.mutatedParts||(m.mutatedParts={}),D=function(J){var se="idb://".concat(t,"/").concat(i,"/").concat(J);return R[se]||(R[se]=new ke)},I=D(""),A=D(":dels"),$=m.type,z=m.type==="deleteRange"?[m.range]:m.type==="delete"?[m.keys]:m.values.length<50?[_r(s,m).filter(function(J){return J}),m.values]:[],F=z[0],V=z[1],re=m.trans._cache;if(h(F)){I.addKeys(F);var U=$==="delete"||F.length===V.length?yi(F,re):null;U||A.addKeys(F),(U||V)&&Oo(D,o,U,V)}else if(F){var te={from:(y=F.lower)!==null&&y!==void 0?y:e.MIN_KEY,to:(w=F.upper)!==null&&w!==void 0?w:e.MAX_KEY};A.add(te),I.add(te)}else I.add(n),A.add(n),o.indexes.forEach(function(J){return D(J.name).add(n)});return a.mutate(m).then(function(J){return F&&(m.type==="add"||m.type==="put")&&(I.addKeys(J.results),v&&v.forEach(function(se){for(var G=m.values.map(function(Re){return se.extractKey(Re)}),_e=se.keyPath.findIndex(function(Re){return Re===s.keyPath}),Ee=0,We=J.results.length;Ee<We;++Ee)G[Ee][_e]=J.results[Ee];D(se.name).addKeys(G)})),E.mutatedParts=xn(E.mutatedParts||{},R),J})}}),S=function(m){var y,w,E=m.query,R=E.index,D=E.range;return[R,new ke((y=D.lower)!==null&&y!==void 0?y:e.MIN_KEY,(w=D.upper)!==null&&w!==void 0?w:e.MAX_KEY)]},M={get:function(m){return[s,new ke(m.key)]},getMany:function(m){return[s,new ke().addKeys(m.keys)]},count:S,query:S,openCursor:S};return k(M).forEach(function(m){p[m]=function(y){var w=Z.subscr,E=!!w,R=gi(Z,a)&&bi(m,y),D=R?y.obsSet={}:w;if(E){var I=function(U){var te="idb://".concat(t,"/").concat(i,"/").concat(U);return D[te]||(D[te]=new ke)},A=I(""),$=I(":dels"),z=M[m](y),F=z[0],V=z[1];if(m==="query"&&F.isPrimaryKey&&!y.values?$.add(V):I(F.name||"").add(V),!F.isPrimaryKey)if(m==="count")$.add(n);else{var re=m==="query"&&d&&y.values&&a.query(l(l({},y),{values:!1}));return a[m].apply(this,arguments).then(function(U){if(m==="query"){if(d&&y.values)return re.then(function(G){var _e=G.result;return A.addKeys(_e),U});var te=y.values?U.result.map(c):U.result;y.values?A.addKeys(te):$.addKeys(te)}else if(m==="openCursor"){var J=U,se=y.values;return J&&Object.create(J,{key:{get:function(){return $.addKey(J.primaryKey),J.key}},primaryKey:{get:function(){var G=J.primaryKey;return $.addKey(G),G}},value:{get:function(){return se&&A.addKey(J.primaryKey),J.value}}})}return U})}}return a[m].apply(this,arguments)}}),p}})}};function Oo(e,t,n,i){function a(o){var s=e(o.name||"");function u(d){return d!=null?o.extractKey(d):null}var c=function(d){return o.multiEntry&&h(d)?d.forEach(function(v){return s.addKey(v)}):s.addKey(d)};(n||i).forEach(function(d,v){var p=n&&u(n[v]),S=i&&u(i[v]);oe(p,S)!==0&&(p!=null&&c(p),S!=null&&c(S))})}t.indexes.forEach(a)}function _i(e,t,n){if(n.numFailures===0)return t;if(t.type==="deleteRange")return null;var i=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;if(n.numFailures===i)return null;var a=l({},t);return h(a.keys)&&(a.keys=a.keys.filter(function(o,s){return!(s in n.failures)})),"values"in a&&h(a.values)&&(a.values=a.values.filter(function(o,s){return!(s in n.failures)})),a}function Mo(e,t){return t.lower===void 0?!0:t.lowerOpen?oe(e,t.lower)>0:oe(e,t.lower)>=0}function Ko(e,t){return t.upper===void 0?!0:t.upperOpen?oe(e,t.upper)<0:oe(e,t.upper)<=0}function wr(e,t){return Mo(e,t)&&Ko(e,t)}function wi(e,t,n,i,a,o){if(!n||n.length===0)return e;var s=t.query.index,u=s.multiEntry,c=t.query.range,d=i.schema.primaryKey,v=d.extractKey,p=s.extractKey,S=(s.lowLevelIndex||s).extractKey,M=n.reduce(function(m,y){var w=m,E=[];if(y.type==="add"||y.type==="put")for(var R=new ke,D=y.values.length-1;D>=0;--D){var I=y.values[D],A=v(I);if(!R.hasKey(A)){var $=p(I);(u&&h($)?$.some(function(U){return wr(U,c)}):wr($,c))&&(R.addKey(A),E.push(I))}}switch(y.type){case"add":{var z=new ke().addKeys(t.values?m.map(function(U){return v(U)}):m);w=m.concat(t.values?E.filter(function(U){var te=v(U);return z.hasKey(te)?!1:(z.addKey(te),!0)}):E.map(function(U){return v(U)}).filter(function(U){return z.hasKey(U)?!1:(z.addKey(U),!0)}));break}case"put":{var F=new ke().addKeys(y.values.map(function(U){return v(U)}));w=m.filter(function(U){return!F.hasKey(t.values?v(U):U)}).concat(t.values?E:E.map(function(U){return v(U)}));break}case"delete":var V=new ke().addKeys(y.keys);w=m.filter(function(U){return!V.hasKey(t.values?v(U):U)});break;case"deleteRange":var re=y.range;w=m.filter(function(U){return!wr(v(U),re)});break}return w},e);return M===e?e:(M.sort(function(m,y){return oe(S(m),S(y))||oe(v(m),v(y))}),t.limit&&t.limit<1/0&&(M.length>t.limit?M.length=t.limit:e.length===t.limit&&M.length<t.limit&&(a.dirty=!0)),o?Object.freeze(M):M)}function xi(e,t){return oe(e.lower,t.lower)===0&&oe(e.upper,t.upper)===0&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function No(e,t,n,i){if(e===void 0)return t!==void 0?-1:0;if(t===void 0)return 1;var a=oe(e,t);if(a===0){if(n&&i)return 0;if(n)return 1;if(i)return-1}return a}function Bo(e,t,n,i){if(e===void 0)return t!==void 0?1:0;if(t===void 0)return-1;var a=oe(e,t);if(a===0){if(n&&i)return 0;if(n)return-1;if(i)return 1}return a}function jo(e,t){return No(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&Bo(e.upper,t.upper,e.upperOpen,t.upperOpen)>=0}function $o(e,t,n,i){var a=vt["idb://".concat(e,"/").concat(t)];if(!a)return[];var o=a.queries[n];if(!o)return[null,!1,a,null];var s=i.query?i.query.index.name:null,u=o[s||""];if(!u)return[null,!1,a,null];switch(n){case"query":var c=u.find(function(p){return p.req.limit===i.limit&&p.req.values===i.values&&xi(p.req.query.range,i.query.range)});if(c)return[c,!0,a,u];var d=u.find(function(p){var S="limit"in p.req?p.req.limit:1/0;return S>=i.limit&&(i.values?p.req.values:!0)&&jo(p.req.query.range,i.query.range)});return[d,!1,a,u];case"count":var v=u.find(function(p){return xi(p.req.query.range,i.query.range)});return[v,!!v,a,u]}}function Fo(e,t,n,i){e.subscribers.add(n),i.addEventListener("abort",function(){e.subscribers.delete(n),e.subscribers.size===0&&Lo(e,t)})}function Lo(e,t){setTimeout(function(){e.subscribers.size===0&&ze(t,e)},3e3)}var zo={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name,n=l(l({},e),{transaction:function(i,a,o){var s=e.transaction(i,a,o);if(a==="readwrite"){var u=new AbortController,c=u.signal,d=function(v){return function(){if(u.abort(),a==="readwrite"){for(var p=new Set,S=0,M=i;S<M.length;S++){var m=M[S],y=vt["idb://".concat(t,"/").concat(m)];if(y){var w=e.table(m),E=y.optimisticOps.filter(function(se){return se.trans===s});if(s._explicit&&v&&s.mutatedParts)for(var R=0,D=Object.values(y.queries.query);R<D.length;R++)for(var I=D[R],A=0,$=I.slice();A<$.length;A++){var z=$[A];hr(z.obsSet,s.mutatedParts)&&(ze(I,z),z.subscribers.forEach(function(se){return p.add(se)}))}else if(E.length>0){y.optimisticOps=y.optimisticOps.filter(function(se){return se.trans!==s});for(var F=0,V=Object.values(y.queries.query);F<V.length;F++)for(var I=V[F],re=0,U=I.slice();re<U.length;re++){var z=U[re];if(z.res!=null&&s.mutatedParts)if(v&&!z.dirty){var te=Object.isFrozen(z.res),J=wi(z.res,z.req,E,w,z,te);z.dirty?(ze(I,z),z.subscribers.forEach(function(_e){return p.add(_e)})):J!==z.res&&(z.res=J,z.promise=L.resolve({result:J}))}else z.dirty&&ze(I,z),z.subscribers.forEach(function(_e){return p.add(_e)})}}}}p.forEach(function(se){return se()})}}};s.addEventListener("abort",d(!1),{signal:c}),s.addEventListener("error",d(!1),{signal:c}),s.addEventListener("complete",d(!0),{signal:c})}return s},table:function(i){var a=e.table(i),o=a.schema.primaryKey,s=l(l({},a),{mutate:function(u){var c=Z.trans;if(o.outbound||c.db._options.cache==="disabled"||c.explicit||c.idbtrans.mode!=="readwrite")return a.mutate(u);var d=vt["idb://".concat(t,"/").concat(i)];if(!d)return a.mutate(u);var v=a.mutate(u);return(u.type==="add"||u.type==="put")&&(u.values.length>=50||_r(o,u).some(function(p){return p==null}))?v.then(function(p){var S=l(l({},u),{values:u.values.map(function(m,y){var w;if(p.failures[y])return m;var E=!((w=o.keyPath)===null||w===void 0)&&w.includes(".")?we(m):l({},m);return ie(E,o.keyPath,p.results[y]),E})}),M=_i(d,S,p);d.optimisticOps.push(M),queueMicrotask(function(){return u.mutatedParts&&Sn(u.mutatedParts)})}):(d.optimisticOps.push(u),u.mutatedParts&&Sn(u.mutatedParts),v.then(function(p){if(p.numFailures>0){ze(d.optimisticOps,u);var S=_i(d,u,p);S&&d.optimisticOps.push(S),u.mutatedParts&&Sn(u.mutatedParts)}}),v.catch(function(){ze(d.optimisticOps,u),u.mutatedParts&&Sn(u.mutatedParts)})),v},query:function(u){var c;if(!gi(Z,a)||!bi("query",u))return a.query(u);var d=((c=Z.trans)===null||c===void 0?void 0:c.db._options.cache)==="immutable",v=Z,p=v.requery,S=v.signal,M=$o(t,i,"query",u),m=M[0],y=M[1],w=M[2],E=M[3];if(m&&y)m.obsSet=u.obsSet;else{var R=a.query(u).then(function(D){var I=D.result;if(m&&(m.res=I),d){for(var A=0,$=I.length;A<$;++A)Object.freeze(I[A]);Object.freeze(I)}else D.result=we(I);return D}).catch(function(D){return E&&m&&ze(E,m),Promise.reject(D)});m={obsSet:u.obsSet,promise:R,subscribers:new Set,type:"query",req:u,dirty:!1},E?E.push(m):(E=[m],w||(w=vt["idb://".concat(t,"/").concat(i)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}}),w.queries.query[u.query.index.name||""]=E)}return Fo(m,E,p,S),m.promise.then(function(D){return{result:wi(D.result,u,w?.optimisticOps,a,m,d)}})}});return s}});return n}};function kn(e,t){return new Proxy(e,{get:function(n,i,a){return i==="db"?t:Reflect.get(n,i,a)}})}var Ge=(function(){function e(t,n){var i=this;this._middlewares={},this.verno=0;var a=e.dependencies;this._options=n=l({addons:e.addons,autoOpen:!0,indexedDB:a.indexedDB,IDBKeyRange:a.IDBKeyRange,cache:"cloned"},n),this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};var o=n.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var s={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:he,dbReadyPromise:null,cancelOpen:he,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:n.autoOpen};s.dbReadyPromise=new L(function(c){s.dbReadyResolve=c}),s.openCanceller=new L(function(c,d){s.cancelOpen=d}),this._state=s,this.name=t,this.on=Ft(this,"populate","blocked","versionchange","close",{ready:[Fn,he]}),this.once=function(c,d){var v=function(){for(var p=[],S=0;S<arguments.length;S++)p[S]=arguments[S];i.on(c).unsubscribe(v),d.apply(i,p)};return i.on(c,v)},this.on.ready.subscribe=W(this.on.ready.subscribe,function(c){return function(d,v){e.vip(function(){var p=i._state;if(p.openComplete)p.dbOpenError||L.resolve().then(d),v&&c(d);else if(p.onReadyBeingFired)p.onReadyBeingFired.push(d),v&&c(d);else{c(d);var S=i;v||c(function M(){S.on.ready.unsubscribe(d),S.on.ready.unsubscribe(M)})}})}}),this.Collection=Qa(this),this.Table=Za(this),this.Transaction=ro(this),this.Version=_o(this),this.WhereClause=to(this),this.on("versionchange",function(c){c.newVersion>0?console.warn("Another connection wants to upgrade database '".concat(i.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(i.name,"'. Closing db now to resume the delete request.")),i.close({disableAutoOpen:!1})}),this.on("blocked",function(c){!c.newVersion||c.newVersion<c.oldVersion?console.warn("Dexie.delete('".concat(i.name,"') was blocked")):console.warn("Upgrade '".concat(i.name,"' blocked by other connection holding version ").concat(c.oldVersion/10))}),this._maxKey=Ht(n.IDBKeyRange),this._createTransaction=function(c,d,v,p){return new i.Transaction(c,d,v,i._options.chromeTransactionDurability,p)},this._fireOnBlocked=function(c){i.on("blocked").fire(c),At.filter(function(d){return d.name===i.name&&d!==i&&!d._state.vcFired}).map(function(d){return d.on("versionchange").fire(c)})},this.use(To),this.use(zo),this.use(Io),this.use(Ao),this.use(Ro);var u=new Proxy(this,{get:function(c,d,v){if(d==="_vip")return!0;if(d==="table")return function(S){return kn(i.table(S),u)};var p=Reflect.get(c,d,v);return p instanceof ni?kn(p,u):d==="tables"?p.map(function(S){return kn(S,u)}):d==="_createTransaction"?function(){var S=p.apply(this,arguments);return kn(S,u)}:p}});this.vip=u,o.forEach(function(c){return c(i)})}return e.prototype.version=function(t){if(isNaN(t)||t<.1)throw new Q.Type("Given version is not a positive number");if(t=Math.round(t*10)/10,this.idbdb||this._state.isBeingOpened)throw new Q.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);var n=this._versions,i=n.filter(function(a){return a._cfg.version===t})[0];return i||(i=new this.Version(t),n.push(i),n.sort(lo),i.stores({}),this._state.autoSchema=!1,i)},e.prototype._whenReady=function(t){var n=this;return this.idbdb&&(this._state.openComplete||Z.letThrough||this._vip)?t():new L(function(i,a){if(n._state.openComplete)return a(new Q.DatabaseClosed(n._state.dbOpenError));if(!n._state.isBeingOpened){if(!n._state.autoOpen){a(new Q.DatabaseClosed);return}n.open().catch(he)}n._state.dbReadyPromise.then(i,a)}).then(t)},e.prototype.use=function(t){var n=t.stack,i=t.create,a=t.level,o=t.name;o&&this.unuse({stack:n,name:o});var s=this._middlewares[n]||(this._middlewares[n]=[]);return s.push({stack:n,create:i,level:a??10,name:o}),s.sort(function(u,c){return u.level-c.level}),this},e.prototype.unuse=function(t){var n=t.stack,i=t.name,a=t.create;return n&&this._middlewares[n]&&(this._middlewares[n]=this._middlewares[n].filter(function(o){return a?o.create!==a:i?o.name!==i:!1})),this},e.prototype.open=function(){var t=this;return pt(Xe,function(){return ko(t)})},e.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var t=this._state,n=At.indexOf(this);if(n>=0&&At.splice(n,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}t.isBeingOpened||(t.dbReadyPromise=new L(function(i){t.dbReadyResolve=i}),t.openCanceller=new L(function(i,a){t.cancelOpen=a}))},e.prototype.close=function(t){var n=t===void 0?{disableAutoOpen:!0}:t,i=n.disableAutoOpen,a=this._state;i?(a.isBeingOpened&&a.cancelOpen(new Q.DatabaseClosed),this._close(),a.autoOpen=!1,a.dbOpenError=new Q.DatabaseClosed):(this._close(),a.autoOpen=this._options.autoOpen||a.isBeingOpened,a.openComplete=!1,a.dbOpenError=null)},e.prototype.delete=function(t){var n=this;t===void 0&&(t={disableAutoOpen:!0});var i=arguments.length>0&&typeof arguments[0]!="object",a=this._state;return new L(function(o,s){var u=function(){n.close(t);var c=n._deps.indexedDB.deleteDatabase(n.name);c.onsuccess=ge(function(){So(n._deps,n.name),o()}),c.onerror=He(s),c.onblocked=n._fireOnBlocked};if(i)throw new Q.InvalidArgument("Invalid closeOptions argument to db.delete()");a.isBeingOpened?a.dbReadyPromise.then(u):u()})},e.prototype.backendDB=function(){return this.idbdb},e.prototype.isOpen=function(){return this.idbdb!==null},e.prototype.hasBeenClosed=function(){var t=this._state.dbOpenError;return t&&t.name==="DatabaseClosed"},e.prototype.hasFailed=function(){return this._state.dbOpenError!==null},e.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(e.prototype,"tables",{get:function(){var t=this;return k(this._allTables).map(function(n){return t._allTables[n]})},enumerable:!1,configurable:!0}),e.prototype.transaction=function(){var t=Eo.apply(this,arguments);return this._transaction.apply(this,t)},e.prototype._transaction=function(t,n,i){var a=this,o=Z.trans;(!o||o.db!==this||t.indexOf("!")!==-1)&&(o=null);var s=t.indexOf("?")!==-1;t=t.replace("!","").replace("?","");var u,c;try{if(c=n.map(function(v){var p=v instanceof a.Table?v.name:v;if(typeof p!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return p}),t=="r"||t===Jn)u=Jn;else if(t=="rw"||t==qn)u=qn;else throw new Q.InvalidArgument("Invalid transaction mode: "+t);if(o){if(o.mode===Jn&&u===qn)if(s)o=null;else throw new Q.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");o&&c.forEach(function(v){if(o&&o.storeNames.indexOf(v)===-1)if(s)o=null;else throw new Q.SubTransaction("Table "+v+" not included in parent transaction.")}),s&&o&&!o.active&&(o=null)}}catch(v){return o?o._promise(null,function(p,S){S(v)}):xe(v)}var d=vi.bind(null,this,u,c,o,i);return o?o._promise(u,d,"lock"):Z.trans?pt(Z.transless,function(){return a._whenReady(d)}):this._whenReady(d)},e.prototype.table=function(t){if(!x(this._allTables,t))throw new Q.InvalidTable("Table ".concat(t," does not exist"));return this._allTables[t]},e})(),Uo=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Ho=(function(){function e(t){this._subscribe=t}return e.prototype.subscribe=function(t,n,i){return this._subscribe(!t||typeof t=="function"?{next:t,error:n,complete:i}:t)},e.prototype[Uo]=function(){return this},e})(),En;try{En={indexedDB:g.indexedDB||g.mozIndexedDB||g.webkitIndexedDB||g.msIndexedDB,IDBKeyRange:g.IDBKeyRange||g.webkitIDBKeyRange}}catch{En={indexedDB:null,IDBKeyRange:null}}function Si(e){var t=!1,n,i=new Ho(function(a){var o=xt(e);function s(E){var R=kt();try{o&&Pt();var D=Ve(e,E);return o&&(D=D.finally(Je)),D}finally{R&&Et()}}var u=!1,c,d={},v={},p={get closed(){return u},unsubscribe:function(){u||(u=!0,c&&c.abort(),S&&tt.storagemutated.unsubscribe(y))}};a.start&&a.start(p);var S=!1,M=function(){return Qn(w)};function m(){return hr(v,d)}var y=function(E){xn(d,E),m()&&M()},w=function(){if(!(u||!En.indexedDB)){d={};var E={};c&&c.abort(),c=new AbortController;var R={subscr:E,signal:c.signal,requery:M,querier:e,trans:null},D=s(R);Promise.resolve(D).then(function(I){t=!0,n=I,!(u||R.signal.aborted)&&(d={},v=E,!q(v)&&!S&&(tt(Ut,y),S=!0),Qn(function(){return!u&&a.next&&a.next(I)}))},function(I){t=!1,["DatabaseClosedError","AbortError"].includes(I?.name)||u||Qn(function(){u||a.error&&a.error(I)})})}};return setTimeout(M,0),p});return i.hasValue=function(){return t},i.getValue=function(){return n},i}var yt=Ge;O(yt,l(l({},en),{delete:function(e){var t=new yt(e,{addons:[]});return t.delete()},exists:function(e){return new yt(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return wo(yt.dependencies).then(e)}catch{return xe(new Q.MissingAPI)}},defineClass:function(){function e(t){b(this,t)}return e},ignoreTransaction:function(e){return Z.trans?pt(Z.transless,e):e()},vip:fr,async:function(e){return function(){try{var t=gr(e.apply(this,arguments));return!t||typeof t.then!="function"?L.resolve(t):t}catch(n){return xe(n)}}},spawn:function(e,t,n){try{var i=gr(e.apply(n,t||[]));return!i||typeof i.then!="function"?L.resolve(i):i}catch(a){return xe(a)}},currentTransaction:{get:function(){return Z.trans||null}},waitFor:function(e,t){var n=L.resolve(typeof e=="function"?yt.ignoreTransaction(e):e).timeout(t||6e4);return Z.trans?Z.trans.waitFor(n):n},Promise:L,debug:{get:function(){return Ue},set:function(e){Fr(e)}},derive:j,extend:b,props:O,override:W,Events:Ft,on:tt,liveQuery:Si,extendObservabilitySet:xn,getByKeyPath:ae,setByKeyPath:ie,delByKeyPath:me,shallowClone:ve,deepClone:we,getObjectDiff:br,cmp:oe,asap:de,minKey:Vn,addons:[],connections:At,errnames:$n,dependencies:En,cache:vt,semVer:Qr,version:Qr.split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,n){return e+t/Math.pow(10,n*2)})})),yt.maxKey=Ht(yt.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(tt(Ut,function(e){if(!nt){var t;t=new CustomEvent(nr,{detail:e}),nt=!0,dispatchEvent(t),nt=!1}}),addEventListener(nr,function(e){var t=e.detail;nt||xr(t)}));function xr(e){var t=nt;try{nt=!0,tt.storagemutated.fire(e),yr(e,!0)}finally{nt=t}}var nt=!1,rt,Sr=function(){};typeof BroadcastChannel<"u"&&(Sr=function(){rt=new BroadcastChannel(nr),rt.onmessage=function(e){return e.data&&xr(e.data)}},Sr(),typeof rt.unref=="function"&&rt.unref(),tt(Ut,function(e){nt||rt.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!Ge.disableBfCache&&e.persisted){Ue&&console.debug("Dexie: handling persisted pagehide"),rt?.close();for(var t=0,n=At;t<n.length;t++){var i=n[t];i.close({disableAutoOpen:!1})}}}),addEventListener("pageshow",function(e){!Ge.disableBfCache&&e.persisted&&(Ue&&console.debug("Dexie: handling persisted pageshow"),Sr(),xr({all:new ke(-1/0,[[]])}))}));function Wo(e){return new $t({add:e})}function Zo(e){return new $t({remove:e})}function Yo(e,t){return new $t({replacePrefix:[e,t]})}L.rejectionMapper=Ea,Fr(Ue);var Go=Object.freeze({__proto__:null,Dexie:Ge,liveQuery:Si,Entity:Jr,cmp:oe,PropModification:$t,replacePrefix:Yo,add:Wo,remove:Zo,default:Ge,RangeSet:ke,mergeRanges:Yt,rangesOverlap:di});return l(Ge,Go,{default:Ge}),Ge})});function Cr(f){if(!f)return{};let r={},l=(C,g)=>{if(!(!C||typeof C!="object"))for(let k in C)Object.hasOwn(C,k)&&g[k]===void 0&&(g[k]=C[k])};return l(f,r),l(f.item,r),l(f.reference,r),r}var Oi=Ne($e());var{Fragment:Dr,jsx:K,jsxs:ue}=Spicetify.ReactJSX;var On={editButton:{path:"M17.318 1.975a3.329 3.329 0 114.707 4.707L8.451 20.256c-.49.49-1.082.867-1.735 1.103L2.34 22.94a1 1 0 01-1.28-1.28l1.581-4.376a4.726 4.726 0 011.103-1.735L17.318 1.975zm3.293 1.414a1.329 1.329 0 00-1.88 0L5.159 16.963c-.283.283-.5.624-.636 1l-.857 2.372 2.371-.857a2.726 2.726 0 001.001-.636L20.611 5.268a1.329 1.329 0 000-1.879z",size:24},settings:{path:"M7.96 5.33a2.67 2.67 90 100 5.34 2.67 2.67 90 000-5.34ZM6.67 8A1.33 1.33 90 119.33 8 1.33 1.33 90 016.67 8Zm4.82-4.81a.95.94 90 01-1.1-.75L10.05.55A.47.47 90 009.68.17 8.1 8.1 90 006.32.17.47.47 90 005.96.55L5.61 2.44a.95.95 90 01-1.25.71L2.55 2.51a.47.47 90 00-.51.13C1.28 3.47.71 4.46.36 5.53a.47.47 90 00.14.51L1.97 7.28a.94.94 90 010 1.43L.5 9.95a.47.47 90 00-.14.51 7.98 7.98 90 001.68 2.9.47.47 90 00.51.13l1.81-.65a.94.94 90 011.25.72l.34 1.89c.04.18.18.33.37.37a8.1 8.1 90 003.36 0 .47.47 90 00.37-.37l.34-1.89a.95.95 90 011.25-.72l1.81.65c.18.06.38.01.51-.13.76-.84 1.34-1.82 1.68-2.9a.47.47 90 00-.14-.5L14.03 8.72a.94.94 90 010-1.44L15.5 6.04a.47.47 90 00.14-.5 7.98 7.98 90 00-1.68-2.9.47.47 90 00-.51-.13l-1.81.65a.95.95 90 01-.15.04Zm-8.82.78 1.25.44a2.28 2.28 90 003-1.73l.24-1.3a6.81 6.81 90 011.68 0l.24 1.3a2.28 2.28 90 003.01 1.73l1.24-.44c.34.44.63.93.84 1.44l-1 .85a2.27 2.27 90 000 3.48l1 .85a6.65 6.65 90 01-.84 1.44l-1.24-.44A2.28 2.28 90 009.08 13.32l-.24 1.29a6.8 6.8 90 01-1.69 0l-.23-1.29A2.28 2.28 90 003.91 11.59l-1.24.44a6.65 6.65 90 01-.84-1.44l1-.86a2.27 2.27 90 000-3.47l-1-.85c.21-.51.5-1 .84-1.44Z",size:16},github:{path:"M12.2135 0C18.947 0 24.4267 5.5 24.4066 12.3041c0 5.4391-3.4983 10.0428-8.3513 11.6728-.6065.1223-.829-.265-.829-.591 0-.4072.02-1.7315.02-3.3815 0-1.1613-.384-1.8945-.829-2.2815 2.73-.3058 5.581-1.3445 5.581-6.0708 0-1.3445-.465-2.4445-1.2537-3.3.1213-.3055.5463-1.5688-.1212-3.2595 0 0-1.0312-.326-3.3567 1.263-.9707-.2648-2.0219-.4075-3.0532-.4075A11.7425 11.7425 90 009.16 6.3556c-2.3252-1.589-3.3565-1.263-3.3565-1.263-.6675 1.6907-.2427 2.954-.1215 3.2595-.7685.8555-1.2535 1.9555-1.2535 3.3 0 4.7263 2.8509 5.7855 5.5607 6.0708-.3437.3055-.6675.8555-.7685 1.65-.7077.326-2.467.8555-3.5587-1.0185 0 0-.6472-1.1815-1.8807-1.263 0 0-1.193 0-.081.7538 0 0 .809.3665 1.355 1.7925 0 0 .7075 2.2002 4.105 1.4667 0 1.0188.02 1.9965.02 2.2818 0 .3258-.2222.713-.829.5905C3.4983 22.3472 0 17.7432 0 12.3042 0 5.5 5.4597 0 12.2135 0Z",size:24},close:{path:"M31.098 29.794 16.955 15.65 31.097 1.51 29.683.093 15.54 14.237 1.4.094-.016 1.508 14.126 15.65-.016 29.795l1.414 1.414L15.54 17.065l14.144 14.143",size:32},warning:{path:"M13 14V9H11v5Zm0 2H11v2h2Zm8.884 3.5A1 1 0 0121 21H3a1 1 0 01-.884-1.468l9-17c.346-.654 1.422-.654 1.768 0Z",size:24},more:{path:"M3 8A1.5 1.5 0 110 8a1.5 1.5 0 013 0zm6.5 0a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM16 8a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z",size:16},questionMark:{path:"M12 2c5.523 0 10 4.478 10 10s-4.477 10-10 10S2 17.522 2 12 6.477 2 12 2Zm0 1.667c-4.595 0-8.333 3.738-8.333 8.333S7.405 20.333 12 20.333 20.333 16.595 20.333 12c0-4.595-3.738-8.333-8.333-8.333ZM12 15.5a1 1 0 110 2 1 1 0 010-2Zm0-8.75a2.75 2.75 0 012.75 2.75c0 1.01-.297 1.574-1.051 2.359l-.169.171c-.622.622-.78.886-.78 1.47a.75.75 0 01-1.5 0c0-1.01.297-1.574 1.051-2.359l-.169-.171c.622-.622.78-.886.78-1.47a1.25 1.25 0 00-2.493-.128l-.007.128a.75.75 0 01-1.5 0A2.75 2.75 0 0112 6.75Z",size:24},dropdown:{path:"M20.4614 6.3469a1.506 1.506 90 00-2.1125.1919L12 14.1564 5.651 6.5389a1.4997 1.4997 90 10-2.3028 1.922l7.5004 9.0004a1.4992 1.4992 90 002.3028 0l7.5004-9.0005a1.5019 1.5019 90 00-.1904-2.1139Z",size:24},palette:{path:"M12 2c5.461 0 9.965 4.012 9.992 8.84 0 3.051-2.504 5.554-5.555 5.554H14.441a1.64 1.64 0 00-1.668 1.668c0 .473.148.836.438 1.125.257.29.437.688.437 1.125C13.648 21.254 12.926 22 12 22 6.5 22 2 17.5 2 12S6.5 2 12 2Z",size:24},duplicate:{path:"M15 3.5c0-.5-.5-1-1-1H11V1c0-.5-.5-1-1-1H2C1.5 0 1 .5 1 1V11.5c0 .5.5 1 1 1H4.5V15c0 .5.5 1 1 1H14c.5 0 1-.5 1-1ZM2.5 2c0-.25.25-.5.5-.5H9c.25 0 .5.25.5.5v8.5c0 .25-.25.5-.5.5H3c-.25 0-.5-.25-.5-.5Zm4 12.5c-.25 0-.5-.25-.5-.5V12.5h4c.5 0 1-.5 1-1V4h2c.25 0 .5.25.5.5V14c0 .25-.25.5-.5.5Z",size:16},terminal:{path:"M3.924 5.02a.75.75 0 011.056-.096l3 2.5a.75.75 0 010 1.152l-3 2.5a.75.75 0 11-.96-1.152L6.328 8 4.02 6.076A.75.75 0 013.924 5.02zM8.25 10.5a.75.75 0 000 1.5h3a.75.75 0 000-1.5h-3zM0 3.25A2.25 2.25 0 012.25 1h11.5A2.25 2.25 0 0116 3.25v9.5A2.25 2.25 0 0113.75 15H2.25A2.25 2.25 0 010 12.75v-9.5zm2.25-.75a.75.75 0 00-.75.75v9.5c0 .414.336.75.75.75h11.5a.75.75 0 00.75-.75v-9.5a.75.75 0 00-.75-.75H2.25z",size:16},customArtwork:{path:"M0 2v12a2 2 90 002 2h12a2 2 90 002-2V7.33l-1.33 1.33v5.33a.66.66 90 01-.66.66H2a.66.66 90 01-.66-.66V2A.66.66 90 012 1.34h9.66L13 0H2A2 2 90 000 2zm2.66 3.33C4.32 5 4.99 3.67 5.32 2.67h.33c.33 1 1 2.33 2.66 2.6v.33c-1.66.33-2.33 1.66-2.66 2.66h-.33c-.33-1-1-2.33-2.66-2.66zm13-2.66a1.33 1.33 90 00-1.66 0L7 9.33a0 0 90 000 0l-1.66 3a.33.33 90 00.33.33l3-1.66a0 0 90 000 0l7-7a1.33 1.33 90 000-1.33z",size:16},play:{path:"M3.3333 3.516c0-1.138 1.2173-1.8613 2.2167-1.318l8.2413 4.484c1.044.5687 1.044 2.0673 0 2.6353L5.55 13.8013C4.5507 14.3453 3.3333 13.6213 3.3333 12.484V3.516Z",size:16},pause:{path:"M3.8307 2A1.1667 1.1667 90 002.664 3.1667V12.8333C2.664 13.4773 3.1867 14 3.8307 14H6.164A1.1667 1.1667 90 007.3307 12.8333V3.1667A1.1667 1.1667 90 006.164 2H3.8307ZM9.8307 2A1.1667 1.1667 90 008.664 3.1667V12.8333C8.664 13.4773 9.1867 14 9.8307 14H12.164A1.1667 1.1667 90 0013.3307 12.8333V3.1667A1.1667 1.1667 90 0012.164 2H9.8307Z",size:16},power:{path:"M11.6081 2.2045c1.394.8028 2.484 2.0434 3.101 3.529.6169 1.4856.7264 3.1334.3112 4.6877-.4152 1.5542-1.3317 2.928-2.6072 3.9081-1.2755.9801-2.8389 1.5119-4.4478 1.5126-1.6086.0009-3.1726-.5292-4.4492-1.508S1.3216 11.9823.9049 10.4286c-.4168-1.5538-.3091-3.2017.3064-4.6879.6153-1.4863 1.704-2.728 3.0972-3.5323.3495-.2018.7963-.0821.998.2674.2018.3495.0821.7963-.2674.998-1.1146.6434-1.9855 1.6368-2.4779 2.8258-.4923 1.1891-.5785 2.5074-.2451 3.7504.3334 1.2429 1.0677 2.3412 2.0891 3.1243 1.0213.783 2.2725 1.2071 3.5593 1.2064 1.287-.0007 2.5377-.426 3.5582-1.2102 1.0204-.7842 1.7537-1.8832 2.0858-3.1264.3321-1.2433.2445-2.5616-.249-3.75-.4937-1.1885-1.3657-2.1809-2.4808-2.8232-.3497-.2014-.4699-.6481-.2685-.9978.2014-.3496.6481-.4699.9978-.2685ZM8.6922.7424v5.845c0 .4035-.3271.7306-.7306.7306s-.7306-.3271-.7306-.7306V.7424c0-.4035.3271-.7306.7306-.7306s.7306.3271.7306.7306Z",size:16},restart:{path:"M12.5002 8C12.5002 5.51472 10.4855 3.5 8.0002 3.5C6.66806 3.5 5.47057 4.07854 4.64593 5H6.2502C6.66441 5 7.0002 5.33579 7.0002 5.75C7.0002 6.16421 6.66441 6.5 6.2502 6.5H3.2502C2.83598 6.5 2.5002 6.16421 2.5002 5.75V2.75C2.5002 2.33579 2.83598 2 3.2502 2C3.66441 2 4.0002 2.33579 4.0002 2.75V3.52793C5.06126 2.57829 6.46302 2 8.0002 2C11.3139 2 14.0002 4.68629 14.0002 8C14.0002 11.3137 11.3139 14 8.0002 14C4.97538 14 2.47448 11.7624 2.06031 8.85192C2.00195 8.44184 2.28708 8.0621 2.69717 8.00374C3.10725 7.94538 3.48699 8.23052 3.54535 8.6406C3.8558 10.8222 5.73271 12.5 8.0002 12.5C10.4855 12.5 12.5002 10.4853 12.5002 8Z",size:16},reload:{path:"M3.5 8C3.5 5.51472 5.51472 3.5 8 3.5C9.33213 3.5 10.5296 4.07854 11.3543 5H9.75C9.33579 5 9 5.33579 9 5.75C9 6.16421 9.33579 6.5 9.75 6.5H12.75C13.1642 6.5 13.5 6.16421 13.5 5.75V2.75C13.5 2.33579 13.1642 2 12.75 2C12.3358 2 12 2.33579 12 2.75V3.52793C10.9389 2.57829 9.53718 2 8 2C4.68629 2 2 4.68629 2 8C2 11.3137 4.68629 14 8 14C11.0248 14 13.5257 11.7624 13.9399 8.85192C13.9982 8.44184 13.7131 8.0621 13.303 8.00374C12.8929 7.94538 12.5132 8.23052 12.4548 8.6406C12.1444 10.8222 10.2675 12.5 8 12.5C5.51472 12.5 3.5 10.4853 3.5 8Z",size:16},book:{path:"M2.75 2C1.7835 2 1 2.7835 1 3.75V12.25C1 13.2165 1.7835 14 2.75 14H6C6.78802 14 7.49862 13.6686 8 13.1375C8.50139 13.6686 9.21198 14 10 14H13.25C14.2165 14 15 13.2165 15 12.25V3.75C15 2.7835 14.2165 2 13.25 2H10C9.21199 2 8.50138 2.33144 8 2.86253C7.49862 2.33144 6.78801 2 6 2H2.75ZM7.25 4.75V11.25C7.25 11.9404 6.69036 12.5 6 12.5H2.75C2.61193 12.5 2.5 12.3881 2.5 12.25V3.75C2.5 3.61193 2.61193 3.5 2.75 3.5H6C6.69036 3.5 7.25 4.05964 7.25 4.75ZM8.75 11.25V4.75C8.75 4.05964 9.30964 3.5 10 3.5H13.25C13.3881 3.5 13.5 3.61193 13.5 3.75V12.25C13.5 12.3881 13.3881 12.5 13.25 12.5H10C9.30964 12.5 8.75 11.9404 8.75 11.25Z",size:16},code:{path:"M10.2912 2.2089c.4315.1918.6259.6971.4341 1.1286l-4.56 10.26c-.1918.4315-.6971.6259-1.1286.434-.4315-.1917-.6258-.697-.4341-1.1285l4.56-10.26c.1918-.4315.6971-.6258 1.1286-.4341ZM4.128 4.9162c.3529.3137.3847.8541.071 1.2071L2.424 8.1202l1.7751 1.997c.3137.3529.2819.8934-.071 1.207-.3529.3137-.8933.2819-1.2071-.0709L.641 8.6882c-.288-.3239-.288-.8121 0-1.1361l2.28-2.565c.3137-.3529.8541-.3847 1.2071-.071Zm7.9839 0c.3529-.3137.8934-.2819 1.2071.071l2.28 2.565c.2878.324.2878.8121 0 1.1361l-2.28 2.565c-.3137.3528-.8542.3846-1.2071.0709-.3529-.3136-.3846-.8541-.071-1.207l1.7751-1.997-1.7751-1.997c-.3136-.3529-.2819-.8933.071-1.2071Z",size:16},person:{path:"M8.11 1.325c1.2275-0 2.2225.995 2.2225 2.2225S9.3375 5.77 8.11 5.77c-1.2275 0-2.2225-.995-2.2225-2.2225 0-1.2275.995-2.2225 2.2225-2.2225Zm0-1.27c-1.9289 0-3.4925 1.5636-3.4925 3.4925S6.1811 7.04 8.11 7.04c1.9289 0 3.4925-1.5636 3.4925-3.4925C11.6025 1.6186 10.0389.055 8.11.055ZM12.555 9.58c.3506 0 .635.2843.635.635v.635c0 1.8258-1.8189 3.81-5.08 3.81-3.2612 0-5.08-1.9842-5.08-3.81v-.635c0-.3507.2843-.635.635-.635h8.89Zm0-1.27H3.665c-1.0521 0-1.905.8529-1.905 1.905v.635c0 2.5037 2.3616 5.08 6.35 5.08s6.35-2.5763 6.35-5.08v-.635c0-1.0521-.8529-1.905-1.905-1.905Z",size:16}},Js=f=>{let{path:r,size:l}=On[f],C=g=>{let k=(0,Oi.c)(4),{size:h,fill:b}=g,_=h===void 0?l:h,P=b===void 0?"currentColor":b,x;k[0]===Symbol.for("react.memo_cache_sentinel")?(x=K("path",{d:r}),k[0]=x):x=k[0];let O;return k[1]!==P||k[2]!==_?(O=K("svg",{fill:P,height:_,role:"img",viewBox:`0 0 ${l} ${l}`,width:_,children:x}),k[1]=P,k[2]=_,k[3]=O):O=k[3],O};return C.defaultProps={size:l,fill:"currentColor"},C},{raw:qs,react:eu,html:tu}=Object.keys(On).reduce((f,r)=>(f.raw[r]=On[r].path,f.react[r]=Js(r),f.html[r]=`<path d="${On[r].path}"/>`,f),{raw:{},react:{},html:{}}),Pe={React:eu,HTML:tu,RAW:qs};var Bi=Ne($e());je();var{__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:Wu,createPortal:Zu,createRoot:Mi,findDOMNode:Yu,flushSync:Gu,hydrate:Qu,hydrateRoot:Xu,render:Vu,unmountComponentAtNode:Ju,unstable_batchedUpdates:qu,unstable_renderSubtreeIntoContainer:ec,version:tc}=Spicetify.ReactDOM,nc=Spicetify.ReactDOM;var Ki=new CSSStyleSheet;Ki.replaceSync(".modal{position:absolute;top:0;left:0;display:flex;align-items:center;justify-content:center;width:100%;height:100%;background-color:rgba(var(--spice-rgb-shadow),.5)}.modal__container{display:flex;flex-direction:column;width:500px;max-height:500px;background-color:rgba(var(--spice-rgb-main),.9);border-radius:6px;box-shadow:0 0 20px rgba(var(--spice-rgb-shadow),.5);backdrop-filter:blur(20px) saturate(1.4) brightness(1.2)}.modal__container--large{width:clamp(550px,60vw,650px);max-height:80vh}.modal__header{display:flex;justify-content:space-between;padding:32px 32px 8px;border-bottom:1px solid rgba(var(--spice-rgb-selected-row),.1)}.modal__titleContainer{display:flex;gap:8px}.modal__icon{display:flex;align-items:center}.modal__title{display:flex}.modal__buttonContainer{display:flex;gap:8px;align-items:center}.modal__buttonContainer .modal__button{height:32px;padding:8px;cursor:pointer;background-color:var(--spice-highlight);border:0;border-radius:8px}.modal__buttonContainer .modal__button:hover{transform:scale(1.1)}.modal__buttonContainer .modal__button:active{transform:scale(.9)}.modal__content{display:flex;padding:16px 24px;overflow:auto;scrollbar-gutter:stable both-edges}.modal__content>*{width:100%}");var Ni=Ki;document.adoptedStyleSheets.push(Ni);var Vt=null,Tr="popup-modal-container",Ir=()=>{let f=document.getElementById(Tr);Vt&&(Vt.unmount(),Vt=null),f&&f.remove(),document.body.style.overflow="auto"},nu=Se(f=>{let r=(0,Bi.c)(44),{title:l,content:C,isLarge:g,buttons:k,icon:h,template:b,onClose:_}=f,P=Be(null),x,O;r[0]!==_?(x=()=>{document.body.style.overflow="hidden";let ce=ae=>{ae.key==="Escape"&&(ae.preventDefault(),_())};return document.addEventListener("keydown",ce),()=>{document.removeEventListener("keydown",ce)}},O=[_],r[0]=_,r[1]=x,r[2]=O):(x=r[1],O=r[2]),at(x,O);let T;r[3]!==_?(T=()=>{_()},r[3]=_,r[4]=T):T=r[4];let B=T,j;r[5]!==B?(j=ce=>{ce.target===P.current&&B()},r[5]=B,r[6]=j):j=r[6];let N=j,H;r[7]!==C?(H=()=>kr(C)?C:typeof C=="function"?K(C,{}):C,r[7]=C,r[8]=H):H=r[8];let X=H;if(b===!0){let ce=`modal__container${g?" modal__container--large":""}`,ae;r[9]!==h?(ae=h&&K("div",{className:"modal__icon",children:h}),r[9]=h,r[10]=ae):ae=r[10];let ie;r[11]!==l?(ie=l&&K("h1",{className:"modal__title",children:l}),r[11]=l,r[12]=ie):ie=r[12];let me;r[13]!==ae||r[14]!==ie?(me=ue("div",{className:"modal__titleContainer",children:[ae,ie]}),r[13]=ae,r[14]=ie,r[15]=me):me=r[15];let ve;r[16]===Symbol.for("react.memo_cache_sentinel")?(ve=K(Pe.React.close,{size:18}),r[16]=ve):ve=r[16];let be;r[17]!==B?(be=K(Spicetify.ReactComponent.TooltipWrapper,{label:"Close",placement:"top",children:K("button",{className:"modal__button modal__button--close",onClick:B,children:ve})}),r[17]=B,r[18]=be):be=r[18];let pe;r[19]!==k||r[20]!==be?(pe=ue("div",{className:"modal__buttonContainer",children:[k,be]}),r[19]=k,r[20]=be,r[21]=pe):pe=r[21];let fe;r[22]!==pe||r[23]!==me?(fe=ue("div",{className:"modal__header",children:[me,pe]}),r[22]=pe,r[23]=me,r[24]=fe):fe=r[24];let ye;r[25]!==X?(ye=X(),r[25]=X,r[26]=ye):ye=r[26];let ee;r[27]!==ye?(ee=K("div",{className:"modal__content",children:ye}),r[27]=ye,r[28]=ee):ee=r[28];let q;r[29]!==fe||r[30]!==ee||r[31]!==ce?(q=ue("div",{className:ce,children:[fe,ee]}),r[29]=fe,r[30]=ee,r[31]=ce,r[32]=q):q=r[32];let le;return r[33]!==N||r[34]!==q?(le=K("div",{className:"modal",onClick:N,ref:P,children:q}),r[33]=N,r[34]=q,r[35]=le):le=r[35],le}let Y=`modal__container${g?" modal__container--large":""}`,W;r[36]!==X?(W=X(),r[36]=X,r[37]=W):W=r[37];let ne;r[38]!==Y||r[39]!==W?(ne=K("div",{className:Y,children:W}),r[38]=Y,r[39]=W,r[40]=ne):ne=r[40];let de;return r[41]!==N||r[42]!==ne?(de=K("div",{className:"modal",onClick:N,ref:P,children:ne}),r[41]=N,r[42]=ne,r[43]=de):de=r[43],de}),gt=f=>{document.getElementById(Tr)&&Ir();let r=document.createElement("div");r.id=Tr,document.body.appendChild(r),Vt=Mi(r),Vt.render(K(nu,{...f,onClose:Ir}))};gt.hide=Ir;var ut=Ne($e());var Mn=Ne(ji(),1),$i=Symbol.for("Dexie"),Jt=globalThis[$i]||(globalThis[$i]=Mn.default);if(Mn.default.semVer!==Jt.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Mn.default.semVer} and ${Jt.semVer}`);var{liveQuery:fc,mergeRanges:dc,rangesOverlap:pc,RangeSet:hc,cmp:mc,Entity:vc,PropModification:yc,replacePrefix:gc,add:bc,remove:_c,DexieYProvider:wc}=Jt;je();var ru=Spicetify.Platform.LibraryAPI||Spicetify.Platform.Registry.resolve(Symbol.for("LibraryAPI"));async function Fi(){return(await ru.getContents({offset:0,limit:1e7,flattenTree:!0})).items}var iu=Spicetify.Platform.PlaylistAPI||Spicetify.Platform.Registry.resolve(Symbol.for("PlaylistAPI"));async function Li(f){return{items:(await iu.getContents(f,{offset:0,limit:-1})).items}}async function zi(f){let r=new Map,l=50,C=[...new Set(f)];for(let g=0;g<C.length;g+=l){let h=C.slice(g,g+l).map(async b=>{let P=(await Spicetify.Platform.GraphQLLoader(Spicetify.GraphQL.Definitions.queryAlbumTracks,{uri:b,locale:Spicetify.Locale.getLocale(),offset:0,limit:5e3}))?.data?.albumUnion?.tracksV2?.items;if(P)for(let x of P){let O=x?.track?.uri;O&&r.set(O,x.track)}});await Promise.allSettled(h)}return r}async function Ui(f){let r=new Map,l=[...new Set(f.map(h=>Spicetify.URI.fromString(h).id).filter(h=>!!h))],C=async h=>{for(let _=0;_<h.length;_+=50){let x=`https://api.spotify.com/v1/tracks?ids=${h.slice(_,_+50).join(",")}`;try{(await Spicetify.CosmosAsync.get(x))?.tracks?.forEach(T=>{T?.uri&&r.set(T.uri,T)})}catch{}}},g=async h=>{for(let _=0;_<h.length;_+=50){let P=h.slice(_,_+50);await Promise.allSettled(P.map(async x=>{let O=`spotify:track:${x}`;if(!r.has(O))try{let T=Spicetify.URI.idToHex(x),j=await(await Spicetify.Platform.RequestBuilder.build().withHost("https://spclient.wg.spotify.com/metadata/4").withPath(`/track/${T}`).send()).body;j&&r.set(O,j)}catch{}}))}};await C(l);let k=l.filter(h=>!r.has(`spotify:track:${h}`));return k.length>0&&await g(k),r}var Zi=Ne($e());je();var Hi=new CSSStyleSheet;Hi.replaceSync(".dropdown{position:relative;width:fit-content;min-width:101px;font-size:14px;cursor:pointer;&:disabled{cursor:not-allowed;opacity:.5}.dropdown__button{display:flex;align-items:center;justify-content:space-between;width:100%;height:32px;padding:0 8px;color:rgba(var(--spice-rgb-text),.8);background:rgba(var(--spice-rgb-selected-row),.1);border:none;border-radius:4px}.dropdown__arrow{display:flex}.dropdown__menu{max-height:250px;overflow-y:scroll;color:rgba(var(--spice-rgb-text),.8);scrollbar-width:none;background:var(--spice-card);border:solid rgba(255,255,255,.1) 1px;border-radius:4px;box-shadow:0 4px 12px #0003}.dropdown__option{display:flex;align-items:center;height:28px;padding:0 8px;margin:4px;cursor:pointer;border-radius:4px;&:hover,.dropdown__option--selected{background:var(--spice-button)}}}");var Wi=Hi;document.adoptedStyleSheets.push(Wi);var Kn=Se(f=>{let r=(0,Zi.c)(43),{value:l,options:C,onChange:g,disabled:k}=f,h=Er(),b=Be(null),_=`--dropdown-anchor-${h.replace(/:/g,"id")}`,P,x,O,T,B,j,N,H,X;if(r[0]!==_||r[1]!==k||r[2]!==g||r[3]!==C||r[4]!==h||r[5]!==l){let ne=fe=>{g?.(fe.value),b.current?.hidePopover()},de;r[15]!==C||r[16]!==l?(de=C.find(fe=>fe.value===l)?.label||"Select...",r[15]=C,r[16]=l,r[17]=de):de=r[17];let ce=de;N="dropdown",H=k;let ae;r[18]!==_?(ae={anchorName:_},r[18]=_,r[19]=ae):ae=r[19];let ie;r[20]!==ce?(ie=K("div",{className:"dropdown__text",children:ce}),r[20]=ce,r[21]=ie):ie=r[21];let me;r[22]===Symbol.for("react.memo_cache_sentinel")?(me=K("div",{className:"dropdown__arrow",children:K(Pe.React.dropdown,{size:12})}),r[22]=me):me=r[22],r[23]!==h||r[24]!==ae||r[25]!==ie?(X=ue("button",{className:"dropdown__button",popoverTarget:h,popoverTargetAction:"toggle",style:ae,children:[ie,me]}),r[23]=h,r[24]=ae,r[25]=ie,r[26]=X):X=r[26],P="dropdown__menu",x=h,O="auto",T=b;let ve=`calc(anchor(${_} bottom) + 4px)`,be=`anchor(${_} left)`,pe=`anchor-size(${_} width)`;r[27]!==ve||r[28]!==be||r[29]!==pe?(B={top:ve,left:be,width:pe},r[27]=ve,r[28]=be,r[29]=pe,r[30]=B):B=r[30],j=C.map(fe=>K("div",{className:`dropdown__option${l===fe.value?" dropdown__option--selected":""}`,onClick:()=>ne(fe),onKeyDown:ye=>ye.key==="Enter"&&ne(fe),role:"option",tabIndex:0,children:fe.label},fe.value)),r[0]=_,r[1]=k,r[2]=g,r[3]=C,r[4]=h,r[5]=l,r[6]=P,r[7]=x,r[8]=O,r[9]=T,r[10]=B,r[11]=j,r[12]=N,r[13]=H,r[14]=X}else P=r[6],x=r[7],O=r[8],T=r[9],B=r[10],j=r[11],N=r[12],H=r[13],X=r[14];let Y;r[31]!==P||r[32]!==x||r[33]!==O||r[34]!==T||r[35]!==B||r[36]!==j?(Y=K("div",{className:P,id:x,popover:O,ref:T,style:B,children:j}),r[31]=P,r[32]=x,r[33]=O,r[34]=T,r[35]=B,r[36]=j,r[37]=Y):Y=r[37];let W;return r[38]!==Y||r[39]!==N||r[40]!==H||r[41]!==X?(W=ue("div",{className:N,disabled:H,children:[X,Y]}),r[38]=Y,r[39]=N,r[40]=H,r[41]=X,r[42]=W):W=r[42],W});var da=Ne($e());je();var Yi=new CSSStyleSheet;Yi.replaceSync(".option__row{display:flex;justify-content:space-between;.option__content{display:flex;gap:8px;align-items:center;.option__desc{display:flex;align-items:center;height:100%;font-size:15px;color:var(--spice-subtext)}}.option__control{display:flex;gap:8px;align-items:center}}");var Gi=Yi;var oa=Ne($e());je();var Vi=Ne($e());je();var Qi=new CSSStyleSheet;Qi.replaceSync(".input{width:128px;height:32px;padding-left:10px;text-overflow:ellipsis;color:rgba(var(--spice-rgb-text),.8);background:rgba(var(--spice-rgb-selected-row),.1);border:0;border-radius:4px;&:disabled{cursor:not-allowed;opacity:.5}}");var Xi=Qi;document.adoptedStyleSheets.push(Xi);var Ji=Se(f=>{let r=(0,Vi.c)(7),{value:l,onChange:C,placeholder:g,disabled:k}=f,h=k===void 0?!1:k,b;r[0]!==C?(b=x=>{C(x.target.value)},r[0]=C,r[1]=b):b=r[1];let _=b,P;return r[2]!==h||r[3]!==_||r[4]!==g||r[5]!==l?(P=K("input",{className:"input",disabled:h,onChange:_,placeholder:g,type:"text",value:l}),r[2]=h,r[3]=_,r[4]=g,r[5]=l,r[6]=P):P=r[6],P});var ta=Ne($e());je();var qi=new CSSStyleSheet;qi.replaceSync(".slider{--fill-color: var(--spice-button-active, #1ed760);--track-color: var(--spice-button-disabled, #535353);--thumb-color: var(--spice-text, #ffffff);--text-color: var(--spice-subtext, #b3b3b3);display:flex;gap:8px;align-items:center;width:100%;&:disabled{cursor:not-allowed;opacity:.5}&:hover{.slider__thumb{opacity:1}.slider__fill{background-color:var(--fill-color)}}.slider-time{min-width:40px;font-size:12px;color:var(--text-color);text-align:center;user-select:none}.slider-container{display:flex;flex-grow:1;align-items:center;height:12px;cursor:pointer;.slider__track{position:relative;width:100%;height:4px;background-color:var(--track-color);border-radius:2px;.slider__fill{position:absolute;height:100%;background-color:var(--fill-color);border-radius:2px}.slider__thumb{position:absolute;top:50%;width:12px;height:12px;background-color:var(--thumb-color);border-radius:50%;opacity:0;transform:translate(-50%,-50%);transition:opacity .2s ease}}}}");var ea=qi;document.adoptedStyleSheets.push(ea);var Nn=Se(f=>{let r=(0,ta.c)(28),{value:l,min:C,max:g,step:k,defaultValue:h,onChange:b,onRelease:_,disabled:P}=f,x=C===void 0?0:C,O=g===void 0?100:g,T=k===void 0?1:k,B=Be(null),j=Be(!1),N=l!==void 0?l:h,H=O>x&&N!==void 0?(N-x)/(O-x)*100:0,X;r[0]!==P||r[1]!==O||r[2]!==x||r[3]!==b||r[4]!==T?(X=q=>{if(!B.current||P)return;let le=B.current.getBoundingClientRect(),we=q.clientX,Oe=Math.max(0,Math.min(we-le.left,le.width))/le.width*(O-x)+x;Oe=Math.round(Oe/T)*T,Oe=Math.max(x,Math.min(Oe,O)),b(Oe)},r[0]=P,r[1]=O,r[2]=x,r[3]=b,r[4]=T,r[5]=X):X=r[5];let Y=X,W;r[6]!==P||r[7]!==Y?(W=q=>{P||!B.current||(j.current=!0,B.current.setPointerCapture(q.pointerId),Y(q.nativeEvent))},r[6]=P,r[7]=Y,r[8]=W):W=r[8];let ne=W,de;r[9]!==Y?(de=q=>{j.current&&Y(q.nativeEvent)},r[9]=Y,r[10]=de):de=r[10];let ce=de,ae;r[11]!==_?(ae=q=>{!j.current||!B.current||(j.current=!1,B.current.releasePointerCapture(q.pointerId),_?.())},r[11]=_,r[12]=ae):ae=r[12];let ie=ae,me=`${H}%`,ve;r[13]!==me?(ve=K("div",{className:"slider__fill",style:{width:me}}),r[13]=me,r[14]=ve):ve=r[14];let be=`${H}%`,pe;r[15]!==be?(pe=K("div",{className:"slider__thumb",style:{left:be}}),r[15]=be,r[16]=pe):pe=r[16];let fe;r[17]!==pe||r[18]!==ve?(fe=ue("div",{className:"slider__track",children:[ve,pe]}),r[17]=pe,r[18]=ve,r[19]=fe):fe=r[19];let ye;r[20]!==ne||r[21]!==ce||r[22]!==ie||r[23]!==fe?(ye=K("div",{className:"slider-container",onPointerCancel:ie,onPointerDown:ne,onPointerMove:ce,onPointerUp:ie,ref:B,children:fe}),r[20]=ne,r[21]=ce,r[22]=ie,r[23]=fe,r[24]=ye):ye=r[24];let ee;return r[25]!==P||r[26]!==ye?(ee=K("div",{className:"slider",disabled:P,children:ye}),r[25]=P,r[26]=ye,r[27]=ee):ee=r[27],ee});var ia=Ne($e());je();var na=new CSSStyleSheet;na.replaceSync(".toggle{display:flex;align-items:center;cursor:pointer;background:none;border:none;&:disabled{cursor:not-allowed;opacity:.5}.toggle__background{display:flex;align-items:center;width:42px;height:24px;background:rgba(var(--spice-rgb-selected-row),.1);border-radius:12px;&:has(.toggle__slider--enabled){background:var(--spice-button)}.toggle__slider--enabled{margin-left:20px}}.toggle__slider{width:20px;height:20px;margin-left:2px;background:var(--spice-text);border-radius:50%;box-shadow:0 0 5px rgba(var(--spice-rgb-shadow),.3);transition:.1s cubic-bezier(.45,.05,.55,.95)}}");var ra=na;document.adoptedStyleSheets.push(ra);var aa=Se(f=>{let r=(0,ia.c)(10),{value:l,onChange:C,disabled:g}=f,k;r[0]!==g||r[1]!==C||r[2]!==l?(k=()=>{g||C(!l)},r[0]=g,r[1]=C,r[2]=l,r[3]=k):k=r[3];let h=k,b=`toggle__slider${l?" toggle__slider--enabled":""}${g?" toggle__slider--disabled":""}`,_;r[4]!==b?(_=K("span",{className:"toggle__background",children:K("span",{className:b})}),r[4]=b,r[5]=_):_=r[5];let P;return r[6]!==g||r[7]!==h||r[8]!==_?(P=K("button",{className:"toggle",disabled:g,onClick:h,role:"switch",children:_}),r[6]=g,r[7]=h,r[8]=_,r[9]=P):P=r[9],P});var sa=Se(f=>{let r=(0,oa.c)(23),{option:l,value:C,onChange:g,disabled:k}=f;switch(l.type){case"toggle":{let h=C,b;return r[0]!==k||r[1]!==g||r[2]!==h?(b=K(aa,{disabled:k,onChange:g,value:h}),r[0]=k,r[1]=g,r[2]=h,r[3]=b):b=r[3],b}case"input":{let h=C,b;return r[4]!==k||r[5]!==g||r[6]!==l.placeholder||r[7]!==h?(b=K(Ji,{disabled:k,onChange:g,placeholder:l.placeholder,value:h}),r[4]=k,r[5]=g,r[6]=l.placeholder,r[7]=h,r[8]=b):b=r[8],b}case"dropdown":{let h;r[9]!==l.options?(h=l.options||[],r[9]=l.options,r[10]=h):h=r[10];let b=C,_;return r[11]!==k||r[12]!==g||r[13]!==h||r[14]!==b?(_=K(Kn,{disabled:k,onChange:g,options:h,value:b}),r[11]=k,r[12]=g,r[13]=h,r[14]=b,r[15]=_):_=r[15],_}case"slider":{let h=C,b;return r[16]!==k||r[17]!==g||r[18]!==l.max||r[19]!==l.min||r[20]!==l.step||r[21]!==h?(b=K(Nn,{disabled:k,max:l.max,min:l.min,onChange:g,step:l.step,value:h}),r[16]=k,r[17]=g,r[18]=l.max,r[19]=l.min,r[20]=l.step,r[21]=h,r[22]=b):b=r[22],b}default:return console.warn(`Unknown option type for option "${l.name||"N/A"}"`),null}});var ua=Ne($e());je();var ca=Se(f=>{let r=(0,ua.c)(6),{name:l,popupModal:C}=f,g;r[0]!==C||r[1]!==l?(g=()=>gt({title:l,content:K(C,{}),isLarge:!1}),r[0]=C,r[1]=l,r[2]=g):g=r[2];let k;r[3]===Symbol.for("react.memo_cache_sentinel")?(k=K(Pe.React.editButton,{size:16}),r[3]=k):k=r[3];let h;return r[4]!==g?(h=K("button",{className:"popup-button",onClick:g,children:k}),r[4]=g,r[5]=h):h=r[5],h});var la=Ne($e());je();var fa=Se(f=>{let r=(0,la.c)(3),{tippy:l}=f,C;r[0]===Symbol.for("react.memo_cache_sentinel")?(C=K("div",{className:"info-tippy",children:K(Pe.React.questionMark,{fill:"var(--spice-subtext)",size:20})}),r[0]=C):C=r[0];let g;return r[1]!==l?(g=K(Spicetify.ReactComponent.TooltipWrapper,{label:l,placement:"top",showDelay:0,children:C}),r[1]=l,r[2]=g):g=r[2],g});document.adoptedStyleSheets.push(Gi);var pa=Se(f=>{let r=(0,da.c)(21),{name:l,desc:C,tippy:g,popupModal:k,option:h,value:b,onChange:_,disabled:P}=f,x;r[0]!==C?(x=K("div",{className:"option__desc",children:C}),r[0]=C,r[1]=x):x=r[1];let O;r[2]!==g?(O=g&&K(fa,{tippy:g}),r[2]=g,r[3]=O):O=r[3];let T;r[4]!==x||r[5]!==O?(T=ue("div",{className:"option__content",children:[x,O]}),r[4]=x,r[5]=O,r[6]=T):T=r[6];let B;r[7]!==l||r[8]!==k?(B=k&&K(ca,{name:l,popupModal:k}),r[7]=l,r[8]=k,r[9]=B):B=r[9];let j;r[10]!==P||r[11]!==_||r[12]!==h||r[13]!==b?(j=h&&K(sa,{disabled:P,onChange:_||au,option:h,value:b}),r[10]=P,r[11]=_,r[12]=h,r[13]=b,r[14]=j):j=r[14];let N;r[15]!==B||r[16]!==j?(N=ue("div",{className:"option__control",children:[B,j]}),r[15]=B,r[16]=j,r[17]=N):N=r[17];let H;return r[18]!==T||r[19]!==N?(H=ue("div",{className:"option__row",children:[T,N]}),r[18]=T,r[19]=N,r[20]=H):H=r[20],H});function au(){}var ha=async()=>{for(;!globalThis.webpackChunkclient_web;)await new Promise(b=>setTimeout(b,50));let f=webpackChunkclient_web.push([[Symbol()],{},b=>b]);for(;!f.m;)await new Promise(b=>setTimeout(b,50));let r=Object.keys(f.m).map(b=>f(b)),l=new Set(Object.values(f.m)),C=b=>{try{return b.toString()}catch{try{return Function.prototype.toString.call(b)}catch{return""}}},g=new Set(r.flatMap(b=>typeof b=="function"?[b]:typeof b=="object"&&b?Object.values(b).flatMap(_=>typeof _=="function"&&!l.has(_)?[_]:_?.$$typeof===Symbol.for("react.forward_ref")&&typeof _.render=="function"?[_.render]:_?.$$typeof===Symbol.for("react.memo")&&_.type?.$$typeof===Symbol.for("react.forward_ref")&&typeof _.type.render=="function"?[_.type.render]:[]):[])),k=/"data-encore-id":(?:[a-zA-Z_$][\w$]*\.)*([A-Z][\w]*)\b/,h={};for(let b of g){let _=C(b).match(k);_?.[1]&&!h[_[1]]&&(h[_[1]]=b)}console.log(`ComponentMenu: Discovery finished. Found ${Object.keys(h).length} components.`),globalThis.UI=h};ha();var Kr=class{starts=new Map;start(r){this.starts.set(r,performance.now())}end(r){let l=this.starts.get(r);if(l){let C=performance.now()-l;console.debug(`[Debug] ${r}: ${C.toFixed(2)}ms`),this.starts.delete(r)}}},st=new Kr,Nr=["exact","isrc","probable","likely","possible","maybe"],ba={exact:{label:"Identical Tracks",tooltip:"The exact same Spotify track added multiple times to the playlist"},isrc:{label:"Same Recording",tooltip:"Different Spotify entries for the same recording (e.g., from different albums but identical audio)"},probable:{label:"Same Title & Artist",tooltip:"Tracks with the same title and at least one shared artist"},likely:{label:"Title & Length Match",tooltip:"Tracks with the same title and similar duration (within 5 seconds)"},possible:{label:"Similar Songs",tooltip:"Tracks with similar titles and durations - may include remixes or covers"},maybe:{label:"Possible Matches",tooltip:"Tracks that may be duplicates based on name similarity - review VERY CAREFULLY!!"}},Br=class extends Jt{constructor(){super("findDupeTracks"),this.version(.3).stores({tracks:"&trackUri, trackName, trackCoverArt, trackDuration, trackPlayCount, trackIsrc, albumUri, albumReleaseDate, lastUpdated, ignoreDuplicates"}).upgrade(r=>r.table("tracks").clear())}},ma=new Br,Bn={groupSettings:{exact:!0,isrc:!0,probable:!0,likely:!0,possible:!0,maybe:!1},confirmSettings:{exact:!1,isrc:!1,probable:!0,likely:!0,possible:!0,maybe:!0},defaultNormaliseWords:["live","remix","mix","acoustic","inst","instrumental","radio","version","ver","edit","mono","stereo","deluxe","demo","rehearsal","intro","outro","remaster","remastered","bonus","feat","ft","explicit","clean","piano","guitar","cover","original","extended","album","single"],customNormaliseWords:[]},va="findDupeTracks:settings",ot={listeners:new Set,snapshot:(()=>{try{let f=localStorage.getItem(va);return f?{...Bn,...JSON.parse(f)}:Bn}catch{return Bn}})(),subscribe(f){return ot.listeners.add(f),()=>ot.listeners.delete(f)},getSnapshot(){return ot.snapshot},update(f){ot.snapshot=f,localStorage.setItem(va,JSON.stringify(f)),ot.listeners.forEach(r=>{r()})}},_a=()=>Rn(ot.subscribe,ot.getSnapshot),ou=f=>f.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),su=f=>{if(!f)return"Unknown";let r=new Date(f);return Number.isNaN(r.getTime())?f:Spicetify.Locale.formatDate(r,{year:"numeric",month:"short",day:"numeric"})},uu=(f,r)=>f.toLowerCase().replace(/\(.*?\)|\[.*?\]/g,"").replace(r,"").replace(/-/g," ").replace(/[^\p{L}\p{N}\s]/gu,"").replace(/\s+/g," ").trim(),cu=(f,r)=>{let l=f.replace(/\s+/g,""),C=r.replace(/\s+/g,"");if(l===C)return 1;if(l.length<2||C.length<2)return 0;let g=new Map;for(let h=0;h<l.length-1;h++){let b=l.substring(h,h+2);g.set(b,(g.get(b)||0)+1)}let k=0;for(let h=0;h<C.length-1;h++){let b=C.substring(h,h+2),_=g.get(b)||0;_>0&&(g.set(b,_-1),k++)}return 2*k/(l.length+C.length-2)};function lu(){let f=(0,ut.c)(6),r;f[0]===Symbol.for("react.memo_cache_sentinel")?(r=[],f[0]=r):r=f[0];let[l,C]=Le(r),[g,k]=Le(!0),h,b;f[1]===Symbol.for("react.memo_cache_sentinel")?(h=()=>{let P=!0;return(async()=>{st.start("Fetch: All Playlists");let O=await Fi();if(!P)return;let T=O.filter(fu);C(T),P&&(k(!1),st.end("Fetch: All Playlists"))})(),()=>{P=!1}},b=[],f[1]=h,f[2]=b):(h=f[1],b=f[2]),at(h,b);let _;return f[3]!==g||f[4]!==l?(_={playlists:l,loading:g},f[3]=g,f[4]=l,f[5]=_):_=f[5],_}function fu(f){return f.type==="playlist"&&f.canAddTo}function du(f,r){let l=(0,ut.c)(8),C;l[0]===Symbol.for("react.memo_cache_sentinel")?(C=[],l[0]=C):C=l[0];let[g,k]=Le(C),[h,b]=Le(!1),_,P;l[1]!==f||l[2]!==r?(_=()=>{if(!f){k([]);return}let O=new AbortController;return b(!0),(async()=>{st.start("LOAD ALL DATA");let{items:B}=await Li(f);if(O.signal.aborted)return;let j=B,N=j.map(_u),H=await ma.tracks.bulkGet(N),X=new Map(H.filter(bu).map(gu)),Y=Temporal.Now.instant(),W=[],ne=[],de=new RegExp(`\\b(${[...r.defaultNormaliseWords,...r.customNormaliseWords].map(ou).join("|")})\\b`,"gi");for(let ee of j){let q=X.get(ee.uri),le=!1;if(!q)le=!0;else if(q.trackPlayCount===null||q.trackDuration===null||q.trackIsrc===null||q.albumReleaseDate===null)le=!0;else if(q.lastUpdated)try{let Ie=Temporal.Instant.from(q.lastUpdated);Y.since(Ie).total("days")>=30&&(le=!0)}catch{le=!0}else le=!0;le&&W.push(ee),ne.push({...ee,playCount:q?.trackPlayCount??null,duration:q?.trackDuration??null,isrc:q?.trackIsrc??null,releaseDate:q?.albumReleaseDate??null,coverArt:q?.trackCoverArt??null,normalisedName:ee.name.toLowerCase().trim(),normalisedFuzzy:uu(ee.name,de)})}if(O.signal.aborted)return;if(k(ne),W.length===0){b(!1),st.end("LOAD ALL DATA");return}let ce=W.filter(ee=>{let q=X.get(ee.uri);return!q||q.trackDuration===null||q.trackPlayCount===null}),ae=W.filter(ee=>{let q=X.get(ee.uri);return!q||q.trackIsrc===null||q.albumReleaseDate===null}),[ie,me]=await Promise.allSettled([ce.length>0?zi(ce.map(yu)):Promise.resolve(new Map),ae.length>0?Ui(ae.map(vu)):Promise.resolve(new Map)]);if(O.signal.aborted)return;let ve=ie.status==="fulfilled"?ie.value:null,be=me.status==="fulfilled"?me.value:null,pe=[],fe=Y.toString(),ye=[...ne];W.forEach(ee=>{let q=X.get(ee.uri),le=ve?.get(ee.uri),we=be?.get(ee.uri),Oe=le?.duration?.totalMilliseconds??null??q?.trackDuration??null,Qe=(le?.playcount?Number(le.playcount):null)??q?.trackPlayCount??null,wt=null;we&&(wt=we?.external_ids?.isrc??we?.external_id?.find(mu)?.id??null);let ze=wt??q?.trackIsrc??null,Ae=null;if(we){let De=we?.album?.date;typeof De=="string"?Ae=De:De?.year&&(Ae=`${De.year}`,De.month&&(Ae=Ae+`-${String(De.month).padStart(2,"0")}`),De.day&&(Ae=Ae+`-${String(De.day).padStart(2,"0")}`))}let Me=Ae??q?.albumReleaseDate??null,xt=ee.album.images.find(hu)?.url??ee.album.images.find(pu)?.url??ee.album.images[0]?.url??"";pe.push({trackUri:ee.uri,trackName:ee.name,trackCoverArt:xt,trackDuration:Oe,trackPlayCount:Qe,trackIsrc:ze,albumUri:ee.album.uri,albumReleaseDate:Me,lastUpdated:fe});let Mt=ye.findIndex(De=>De.uid===ee.uid);Mt!==-1&&(ye[Mt]={...ye[Mt],playCount:Qe,duration:Oe,isrc:ze,releaseDate:Me,coverArt:xt})}),await ma.tracks.bulkPut(pe),O.signal.aborted||(k(ye),st.end("LOAD ALL DATA")),O.signal.aborted||b(!1)})(),()=>O.abort()},P=[f,r],l[1]=f,l[2]=r,l[3]=_,l[4]=P):(_=l[3],P=l[4]),at(_,P);let x;return l[5]!==h||l[6]!==g?(x={tracks:g,loading:h,setTracks:k},l[5]=h,l[6]=g,l[7]=x):x=l[7],x}function pu(f){return f.label==="large"}function hu(f){return f.label==="xlarge"}function mu(f){return f?.type==="isrc"}function vu(f){return f.uri}function yu(f){return f.album.uri}function gu(f){return[f.trackUri,f]}function bu(f){return!!f}function _u(f){return f.uri}function wu(f,r){let l=(0,ut.c)(4),C;e:{st.start("Dupe Algorithm: Compute");let g;if(l[0]!==r||l[1]!==f){if(g={exact:[],isrc:[],probable:[],likely:[],possible:[],maybe:[]},f.length<2){st.end("Dupe Algorithm: Compute"),C=g;break e}let{groupSettings:k}=r,h=[...f],b=new Set,_=(T,B)=>{if(T.length<2)return;let j=T.sort(Tu);g[B].push({mainTrack:j[0],duplicates:j.slice(1)}),T.forEach(N=>{b.add(N.uid)})},P=()=>{h=h.filter(T=>!b.has(T.uid)),b.clear()};if(k.exact){let T=Object.groupBy(h,Du);for(let B in T){let j=T[B];j&&_(j,"exact")}P()}if(k.isrc){let T=Object.groupBy(h,Ru);for(let B in T){let j=T[B];B&&j&&_(j,"isrc")}P()}let x=Pu,O=Eu;if(k.probable){let T=Object.groupBy(h,ku);for(let B in T){let j=T[B];if(!j||j.length<2)continue;let N=new Set;for(let H of j){if(N.has(H.uid))continue;let X=j.filter(Y=>H.uid===Y.uid||!N.has(Y.uid)&&x(H,Y));X.length>1&&(_(X,"probable"),X.forEach(Y=>{N.add(Y.uid)}))}}P()}if(k.likely){let T=Object.groupBy(h,Cu);for(let B in T){let j=T[B];if(!j||j.length<2)continue;let N=new Set;for(let H of j){if(N.has(H.uid))continue;let X=j.filter(Y=>H.uid===Y.uid||!N.has(Y.uid)&&O(H,Y));X.length>1&&(_(X,"likely"),X.forEach(Y=>{N.add(Y.uid)}))}}P()}if(k.possible){let T=Object.groupBy(h,Su);for(let B in T){let j=T[B];if(!j||j.length<2)continue;let N=new Set;for(let H of j){if(N.has(H.uid))continue;let X=j.filter(Y=>H.uid===Y.uid||!N.has(Y.uid)&&O(H,Y));X.length>1&&(_(X,"possible"),X.forEach(Y=>{N.add(Y.uid)}))}}P()}if(k.maybe){h.sort(xu);for(let T=0;T<h.length;T++){let B=h[T];if(b.has(B.uid))continue;let j=[B];for(let N=T+1;N<Math.min(T+30,h.length);N++){let H=h[N];if(!b.has(H.uid)){if(B.normalisedFuzzy[0]!==H.normalisedFuzzy[0])break;cu(B.normalisedFuzzy,H.normalisedFuzzy)>=.8&&j.push(H)}}j.length>1&&_(j,"maybe")}}l[0]=r,l[1]=f,l[2]=g,l[3]=C}else g=l[2],C=l[3];st.end("Dupe Algorithm: Compute"),C=g}return C}function xu(f,r){return f.normalisedFuzzy.localeCompare(r.normalisedFuzzy)}function Su(f){return f.normalisedFuzzy}function Cu(f){return f.normalisedName}function ku(f){return f.normalisedName}function Eu(f,r){return f.duration==null||r.duration==null?!1:Math.abs(f.duration-r.duration)<=5e3}function Pu(f,r){let l=new Set(f.artists.map(Au));return r.artists.some(C=>l.has(C.name.toLowerCase()))}function Au(f){return f.name.toLowerCase()}function Ru(f){return f.isrc||""}function Du(f){return f.uri}function Tu(f,r){let l=(r.playCount??0)-(f.playCount??0);if(l!==0)return l;let C=f.releaseDate??"9999",g=r.releaseDate??"9999";return C.localeCompare(g)}var Iu=()=>{let f=(0,ut.c)(5),r=_a(),l;f[0]!==r?(l=(k,h,b)=>{let _={...r,[k]:{...r[k],[h]:b}};ot.update(_)},f[0]=r,f[1]=l):l=f[1];let C=l,g;if(f[2]!==r||f[3]!==C){let k=(b,_,P)=>ue("section",{className:"duplicate-settings__section",children:[K("h3",{className:"duplicate-settings__section-title",children:b}),K("div",{className:"duplicate-settings__options",children:Nr.map(x=>K(pa,{desc:P[x],name:`${_}-${x}`,onChange:O=>C(_,x,!!O),option:{type:"toggle",name:x,desc:P[x],defaultVal:Bn[_][x]},value:r[_][x]},x))})]}),h=Object.fromEntries(Nr.map(Ku));g=ue("div",{className:"duplicate-settings",children:[k("Display Groups","groupSettings",h),k("Confirm Delete","confirmSettings",h)]}),f[2]=r,f[3]=C,f[4]=g}else g=f[4];return g},bt=Spicetify.Platform.PlayerAPI,ya={subscribe:f=>{let r=()=>f();return Spicetify.Platform.PlayerAPI._events.addListener("update",r,{}),()=>{Spicetify.Platform.PlayerAPI._events.removeListener("update",r,{})}},getSnapshot:()=>Spicetify.Platform.PlayerAPI._state},Ou=f=>{let r=(0,ut.c)(33),{uri:l,duration:C}=f,g=l,k=C??0,h=Rn(ya.subscribe,ya.getSnapshot),b=h.item?.uri===g,_=h.isPaused,P=b&&!_,[x,O]=Le(0),[T,B]=Le(k),j=Be(!1),N=Be(0),H,X;r[0]!==b||r[1]!==_||r[2]!==h.duration||r[3]!==h.positionAsOfTimestamp||r[4]!==k?(H=()=>{if(!b){O(0),B(k);return}if(B(h.duration),j.current)return;if(_){O(h.positionAsOfTimestamp);return}let Ie=setInterval(()=>{let Oe=Date.now(),_t=bt._state.positionAsOfTimestamp,Qe=bt._state.timestamp,wt=Oe-Qe+_t;O(Math.min(wt,h.duration))},100);return()=>clearInterval(Ie)},X=[b,_,h.duration,h.positionAsOfTimestamp,k],r[0]=b,r[1]=_,r[2]=h.duration,r[3]=h.positionAsOfTimestamp,r[4]=k,r[5]=H,r[6]=X):(H=r[5],X=r[6]),at(H,X);let Y;r[7]!==b||r[8]!==_||r[9]!==g?(Y=()=>{b?_?bt.resume({}):bt.pause({}):bt.play({uri:g},{})},r[7]=b,r[8]=_,r[9]=g,r[10]=Y):Y=r[10];let W=Y,ne;r[11]===Symbol.for("react.memo_cache_sentinel")?(ne=Ie=>{j.current=!0,O(Ie),N.current=Ie},r[11]=ne):ne=r[11];let de=ne,ce;r[12]!==b||r[13]!==g?(ce=()=>{j.current=!1,b?bt.seekTo(N.current):bt.play({uri:g},{})},r[12]=b,r[13]=g,r[14]=ce):ce=r[14];let ae=ce,ie=Nu,me;r[15]!==P?(me=P?K(Pe.React.pause,{size:20}):K(Pe.React.play,{size:20}),r[15]=P,r[16]=me):me=r[16];let ve;r[17]!==me||r[18]!==W?(ve=K("button",{className:"duplicate-group__playback-button",onClick:W,children:me}),r[17]=me,r[18]=W,r[19]=ve):ve=r[19];let be=ie(x),pe;r[20]!==be?(pe=K("span",{className:"slider-time",children:be}),r[20]=be,r[21]=pe):pe=r[21];let fe=T||0,ye=x||0,ee;r[22]!==ae||r[23]!==fe||r[24]!==ye?(ee=K(Nn,{max:fe,min:0,onChange:de,onRelease:ae,step:1,value:ye}),r[22]=ae,r[23]=fe,r[24]=ye,r[25]=ee):ee=r[25];let q=ie(T),le;r[26]!==q?(le=K("span",{className:"slider-time",children:q}),r[26]=q,r[27]=le):le=r[27];let we;return r[28]!==ee||r[29]!==le||r[30]!==ve||r[31]!==pe?(we=ue("div",{className:"duplicate-group__playback-controls",children:[ve,pe,ee,le]}),r[28]=ee,r[29]=le,r[30]=ve,r[31]=pe,r[32]=we):we=r[32],we},ga=f=>{let r=(0,ut.c)(42),{track:l,category:C,onDelete:g}=f,k=`duplicate-group__duplicate-item duplicate-group__item--${C}`,h=l.coverArt??"",b;r[0]!==h?(b=K("img",{className:"details-grid__image",src:h}),r[0]=h,r[1]=b):b=r[1];let _;r[2]!==l.name?(_=K("span",{className:"details-grid__name",children:l.name}),r[2]=l.name,r[3]=_):_=r[3];let P;r[4]!==l.playCount?(P=l.playCount?.toLocaleString(),r[4]=l.playCount,r[5]=P):P=r[5];let x;r[6]!==P?(x=ue("span",{className:"details-grid__playcount",children:["Play Count: ",P]}),r[6]=P,r[7]=x):x=r[7];let O;r[8]!==_||r[9]!==x?(O=ue("div",{className:"details-grid__main-info",children:[_,x]}),r[8]=_,r[9]=x,r[10]=O):O=r[10];let T;r[11]!==l.artists?(T=l.artists.map(Bu).join(", "),r[11]=l.artists,r[12]=T):T=r[12];let B;r[13]!==T?(B=K("span",{className:"details-grid__artists",children:T}),r[13]=T,r[14]=B):B=r[14];let j;r[15]!==l.album.name?(j=K("span",{className:"details-grid__album",children:l.album.name}),r[15]=l.album.name,r[16]=j):j=r[16];let N;r[17]!==j||r[18]!==B?(N=ue("div",{className:"details-grid__second-info",children:[B,j]}),r[17]=j,r[18]=B,r[19]=N):N=r[19];let H;r[20]!==l.releaseDate?(H=su(l.releaseDate),r[20]=l.releaseDate,r[21]=H):H=r[21];let X;r[22]!==H?(X=K("span",{className:"details-grid__date",children:H}),r[22]=H,r[23]=X):X=r[23];let Y;r[24]!==N||r[25]!==X||r[26]!==b||r[27]!==O?(Y=K("div",{className:"duplicate-group__duplicate-info",children:ue("div",{className:"details-grid",children:[b,O,N,X]})}),r[24]=N,r[25]=X,r[26]=b,r[27]=O,r[28]=Y):Y=r[28];let W;r[29]!==l.duration||r[30]!==l.uri?(W=K(Ou,{duration:l.duration,uri:l.uri}),r[29]=l.duration,r[30]=l.uri,r[31]=W):W=r[31];let ne;r[32]!==g||r[33]!==l?(ne=K("button",{className:"duplicate-group__delete-button",onClick:()=>g(l),children:"Delete"}),r[32]=g,r[33]=l,r[34]=ne):ne=r[34];let de;r[35]!==W||r[36]!==ne?(de=ue("div",{className:"duplicate-group__actions",children:[W,ne]}),r[35]=W,r[36]=ne,r[37]=de):de=r[37];let ce;return r[38]!==k||r[39]!==Y||r[40]!==de?(ce=ue("div",{className:k,children:[Y,de]}),r[38]=k,r[39]=Y,r[40]=de,r[41]=ce):ce=r[41],ce},Mu=f=>{let r=(0,ut.c)(20),{title:l,category:C,groups:g,onDelete:k}=f,h;r[0]!==l.label?(h=K("div",{className:"duplicate-group__heading-title",children:l.label}),r[0]=l.label,r[1]=h):h=r[1];let b;r[2]===Symbol.for("react.memo_cache_sentinel")?(b=K("div",{className:"info-tippy",children:K(Pe.React.questionMark,{fill:"var(--spice-subtext)",size:20})}),r[2]=b):b=r[2];let _;r[3]!==l.tooltip?(_=K(Spicetify.ReactComponent.TooltipWrapper,{label:l.tooltip,placement:"top",children:b}),r[3]=l.tooltip,r[4]=_):_=r[4];let P;r[5]!==h||r[6]!==_?(P=ue("div",{className:"duplicate-group__heading-info",children:[h,_]}),r[5]=h,r[6]=_,r[7]=P):P=r[7];let x;r[8]!==g.length?(x=ue("div",{className:"duplicate-group__heading-length",children:[g.length," found"]}),r[8]=g.length,r[9]=x):x=r[9];let O;r[10]!==P||r[11]!==x?(O=ue("div",{className:"duplicate-group__heading",children:[P,x]}),r[10]=P,r[11]=x,r[12]=O):O=r[12];let T;r[13]!==C||r[14]!==g||r[15]!==k?(T=g.length>0&&K("div",{className:"duplicate-group__list",children:g.map(j=>ue("div",{className:`duplicate-group__item duplicate-group__item--${C}`,children:[K(ga,{category:C,onDelete:N=>k(C,N),track:j.mainTrack}),K("div",{className:"duplicate-group__duplicates-list",children:j.duplicates.map(N=>ue(Dr,{children:[K("div",{className:"duplicate-group__duplicate-thread"}),K(ga,{category:C,onDelete:H=>k(C,H),track:N},N.uid)]}))})]},j.mainTrack.uid))}),r[13]=C,r[14]=g,r[15]=k,r[16]=T):T=r[16];let B;return r[17]!==O||r[18]!==T?(B=ue("div",{className:"duplicate-group",children:[O,T]}),r[17]=O,r[18]=T,r[19]=B):B=r[19],B};function wa({selectedPlaylist:f}){let[r,l]=Le("finder"),[C,g]=Le(f?.uri),[k,h]=Le(null),b=_a(),{playlists:_,loading:P}=lu(),x=Pr(()=>_.find(W=>W.uri===C)??(C?{uri:C,name:"Selected Playlist",type:"playlist"}:void 0),[_,C]),{tracks:O,loading:T,setTracks:B}=du(C,b),j=wu(O,b),N=Be(performance.now());N.current=performance.now(),at(()=>{let W=performance.now()-N.current;W>10&&console.debug(`[DEBUG] Render:React took ${W.toFixed(2)}ms to render`)});let H=async W=>{x&&(await Spicetify.Platform.PlaylistAPI.remove(x.uri,[{uid:W.uid}]),B(ne=>ne.filter(de=>de.uid!==W.uid)))},X=(W,ne)=>{b.confirmSettings[W]?h({track:ne,category:W}):H(ne)},Y=()=>{k&&H(k.track),h(null)};return ue(Dr,{children:[K(Spicetify.ReactComponent.ConfirmDialog,{cancelText:"Cancel",confirmText:"Remove",descriptionText:k?`Are you sure you want to remove "${k.track.name}"? This cannot be undone.`:"",isOpen:k!==null,onClose:()=>h(null),onConfirm:Y,onOutside:()=>h(null),titleText:"Remove Track"}),ue("div",{className:"find-duplicates",children:[ue("div",{className:"modal__header",children:[K("h1",{className:"find-duplicates__title",children:r==="finder"?"Playlist Duplicate Finder":"Settings"}),K("div",{className:"find-duplicates__dropdown",children:K(Kn,{disabled:P||T,onChange:g,options:_.map(W=>({value:W.uri,label:W.name})),value:C??""})}),ue("div",{className:"modal__buttonContainer",children:[K("button",{className:"modal__button",onClick:()=>l(W=>W==="finder"?"settings":"finder"),children:K(Pe.React.settings,{})}),K("button",{className:"modal__button",onClick:()=>gt.hide(),children:K(Pe.React.close,{size:18})})]})]}),K("div",{className:"find-duplicates__content",children:r==="settings"?K(Iu,{}):T?K("div",{className:"find-duplicates__loading",children:K(UI.ProgressDots,{size:"medium"})}):Nr.map(W=>b.groupSettings[W]?K(Mu,{category:W,groups:j[W],onDelete:X,title:ba[W]},W):null)})]})]})}function Ku(f){return[f,ba[f].label]}function Nu(f){if(f==null||f<0)return"--:--";let r=Math.floor(f/1e3);return`${Math.floor(r/60)}:${(r%60).toString().padStart(2,"0")}`}function Bu(f){return f.name}var xa=new CSSStyleSheet;xa.replaceSync(".find-duplicates{--fdp-radius-lg: 14px;--fdp-radius: 10px;--fdp-radius-sm: 8px;--fdp-gap: 14px;--fdp-border: rgba(var(--spice-rgb-selected-row), .14);--fdp-border-strong: rgba(var(--spice-rgb-selected-row), .22);--fdp-surface: var(--spice-main-elevated);--fdp-text: var(--spice-text);--fdp-subtext: var(--spice-subtext);--fdp-accent: var(--spice-button);display:flex;flex-direction:column;overflow:hidden}.find-duplicates__title{font-size:30px;color:var(--spice-text)}.find-duplicates__dropdown{align-content:center}.find-duplicates__header-label{font-weight:600;color:var(--fdp-text)}.find-duplicates__loading{display:flex;align-items:center;justify-content:center;height:16700000px}.find-duplicates__content{display:flex;flex-direction:column;gap:8px;padding:8px 28px;overflow:scroll}.duplicate-group{display:flex;flex-direction:column;gap:12px;padding:16px;background:var(--fdp-surface);border:1px solid var(--fdp-border);border-radius:var(--fdp-radius-lg)}.duplicate-group__heading{display:flex;align-items:center;justify-content:space-between;font-weight:600;color:var(--fdp-text)}.duplicate-group__heading-info{display:flex;gap:8px}.duplicate-group__heading-length{padding:2px 8px;font-size:12px;color:var(--fdp-subtext);border:1px solid var(--fdp-border);border-radius:999px}.duplicate-group__list{display:flex;flex-direction:column;gap:10px}.duplicate-group__duplicate-item{display:flex;flex-direction:column;gap:8px}.duplicate-group__item{display:flex;flex-direction:column;gap:10px;padding:12px 10px;border:1px solid var(--fdp-border);border-left:3px solid;border-radius:var(--fdp-radius);transition:background-color .12s ease,border-color .12s ease}.duplicate-group__item:hover{background:rgba(var(--spice-rgb-selected-row),.05);border-color:var(--fdp-border-strong)}.duplicate-group__item--exact{border-left-color:#e53935}.duplicate-group__item--isrc{border-left-color:#fb8c00}.duplicate-group__item--probable{border-left-color:#fdd835}.duplicate-group__item--likely{border-left-color:#43a047}.duplicate-group__item--possible{border-left-color:#1e88e5}.duplicate-group__item--maybe{border-left-color:#306}.duplicate-group__duplicate-info{display:flex;gap:12px;align-items:center;justify-content:space-between}.details-grid{display:grid;grid-template-columns:40px auto auto 85px;gap:8px;width:100%;font-size:.9rem;color:var(--fdp-subtext)}.details-grid__image{width:40px;height:40px;border-radius:4px}.details-grid__name{overflow:hidden;text-overflow:ellipsis;font-weight:600;color:var(--fdp-text);white-space:nowrap}.details-grid__date{text-align:right}.details-grid__main-info,.details-grid__second-info{display:flex;flex-direction:column}.duplicate-group__actions{display:flex;flex-direction:row;gap:8px}.duplicate-group__playback-controls{display:flex;gap:4px;align-items:center;width:100%}.duplicate-group__playback-button{width:32px;height:32px;color:var(--fdp-text);cursor:pointer;background:transparent;border:1px solid transparent;border-radius:50%}.duplicate-group__playback-button:hover{background:rgba(var(--spice-rgb-selected-row),.08);border-color:var(--fdp-border)}.slider-time{min-width:38px;font-size:12px;color:var(--fdp-subtext);text-align:center}.duplicate-group__delete-button{padding:6px 12px;font-size:.85rem;font-weight:600;color:#fff;cursor:pointer;background:#e91429;border:1px solid rgba(233,20,41,.4);border-radius:999px}.duplicate-group__delete-button:hover{filter:brightness(1.05)}.duplicate-settings__section{margin-bottom:24px}.duplicate-settings__section-title{padding-bottom:6px;margin-bottom:12px;font-weight:600;border-bottom:1px solid var(--fdp-border)}.duplicate-settings__options{display:flex;flex-direction:column;gap:10px}.find-duplicates :is(button,[role=button],input,select):focus-visible{outline:none;border-color:var(--fdp-accent);box-shadow:0 0 0 2px color-mix(in srgb,var(--fdp-accent),transparent 60%)}");var Sa=xa;document.adoptedStyleSheets.push(Sa);var ju=new Spicetify.ContextMenuV2.Item({children:"Find Duplicates",leadingIcon:Pe.HTML.duplicate,onClick:async(f,r,l)=>{let C=Cr(f.props),g=C.uri,k=C.name,h=Spicetify.URI.from(g)?.type,b={uri:g,name:k||(await Spicetify.Platform.PlaylistAPI.getMetadata(g,{}))?.name||"",type:h||""};gt({title:"Find Duplicates",content:K(wa,{selectedPlaylist:b}),isLarge:!0,template:!1})},divider:"after",shouldAdd:(f,r,l)=>{let C=Cr(f),g=Spicetify.URI.from(C.uri)?.type;return g===Spicetify.URI.Type.PLAYLIST||g===Spicetify.URI.Type.PLAYLIST_V2}});ju.register();
