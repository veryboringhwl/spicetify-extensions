
        (async function() {
          while (!Spicetify.React || !Spicetify.ReactDOM) {
          await new Promise(resolve => setTimeout(resolve, 10));
        }
var ho=Object.create;var pi=Object.defineProperty;var vo=Object.getOwnPropertyDescriptor;var mo=Object.getOwnPropertyNames;var yo=Object.getPrototypeOf,go=Object.prototype.hasOwnProperty;var bn=(_,k)=>()=>(k||_((k={exports:{}}).exports,k),k.exports);var bo=(_,k,w,F)=>{if(k&&typeof k=="object"||typeof k=="function")for(let T of mo(k))!go.call(_,T)&&T!==w&&pi(_,T,{get:()=>k[T],enumerable:!(F=vo(k,T))||F.enumerable});return _};var H=(_,k,w)=>(w=_!=null?ho(yo(_)):{},bo(k||!_||!_.__esModule?pi(w,"default",{value:_,enumerable:!0}):w,_));var te=bn((Fo,hi)=>{hi.exports=Spicetify.ReactJSX});var Te=bn((zo,vi)=>{vi.exports=Spicetify.React});var wr=bn((jo,mi)=>{mi.exports=Spicetify.ReactDOM});var _i=bn((_r,xr)=>{(function(_,k){typeof _r=="object"&&typeof xr<"u"?xr.exports=k():typeof define=="function"&&define.amd?define(k):(_=typeof globalThis<"u"?globalThis:_||self,_.Dexie=k())})(_r,function(){"use strict";var _=function(e,t){return _=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},_(e,t)};function k(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");_(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var w=function(){return w=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},w.apply(this,arguments)};function F(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,a;r<i;r++)(a||!(r in t))&&(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return e.concat(a||Array.prototype.slice.call(t))}var T=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,z=Object.keys,N=Array.isArray;typeof Promise<"u"&&!T.Promise&&(T.Promise=Promise);function j(e,t){return typeof t!="object"||z(t).forEach(function(n){e[n]=t[n]}),e}var Y=Object.getPrototypeOf,R={}.hasOwnProperty;function L(e,t){return R.call(e,t)}function J(e,t){typeof t=="function"&&(t=t(Y(e))),(typeof Reflect>"u"?z:Reflect.ownKeys)(t).forEach(function(n){ee(e,n,t[n])})}var X=Object.defineProperty;function ee(e,t,n,r){X(e,t,j(n&&L(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function de(e){return{from:function(t){return e.prototype=Object.create(t.prototype),ee(e.prototype,"constructor",e),{extend:J.bind(null,e.prototype)}}}}var dt=Object.getOwnPropertyDescriptor;function We(e,t){var n=dt(e,t),r;return n||(r=Y(e))&&We(r,t)}var Vt=[].slice;function pt(e,t,n){return Vt.call(e,t,n)}function St(e,t){return t(e)}function Ae(e){if(!e)throw new Error("Assertion Failed")}function $t(e){T.setImmediate?setImmediate(e):setTimeout(e,0)}function Tn(e,t){return e.reduce(function(n,r,i){var a=t(r,i);return a&&(n[a[0]]=a[1]),n},{})}function W(e,t){if(typeof t=="string"&&L(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var n=[],r=0,i=t.length;r<i;++r){var a=W(e,t[r]);n.push(a)}return n}var o=t.indexOf(".");if(o!==-1){var s=e[t.substr(0,o)];return s==null?void 0:W(s,t.substr(o+1))}}function U(e,t,n){if(!(!e||t===void 0)&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){Ae(typeof n!="string"&&"length"in n);for(var r=0,i=t.length;r<i;++r)U(e,t[r],n[r])}else{var a=t.indexOf(".");if(a!==-1){var o=t.substr(0,a),s=t.substr(a+1);if(s==="")n===void 0?N(e)&&!isNaN(parseInt(o))?e.splice(o,1):delete e[o]:e[o]=n;else{var u=e[o];(!u||!L(e,o))&&(u=e[o]={}),U(u,s,n)}}else n===void 0?N(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function ne(e,t){typeof t=="string"?U(e,t,void 0):"length"in t&&[].map.call(t,function(n){U(e,n,void 0)})}function oe(e){var t={};for(var n in e)L(e,n)&&(t[n]=e[n]);return t}var ie=[].concat;function he(e){return ie.apply([],e)}var le="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(he([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return T[e]}),Se=new Set(le.map(function(e){return T[e]}));function Ve(e){var t={};for(var n in e)if(L(e,n)){var r=e[n];t[n]=!r||typeof r!="object"||Se.has(r.constructor)?r:Ve(r)}return t}function fe(e){for(var t in e)if(L(e,t))return!1;return!0}var tt=null;function Ne(e){tt=new WeakMap;var t=$e(e);return tt=null,t}function $e(e){if(!e||typeof e!="object")return e;var t=tt.get(e);if(t)return t;if(N(e)){t=[],tt.set(e,t);for(var n=0,r=e.length;n<r;++n)t.push($e(e[n]))}else if(Se.has(e.constructor))t=e;else{var i=Y(e);t=i===Object.prototype?{}:Object.create(i),tt.set(e,t);for(var a in e)L(e,a)&&(t[a]=$e(e[a]))}return t}var An={}.toString;function ht(e){return An.call(e).slice(8,-1)}var Ct=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Ee=typeof Ct=="symbol"?function(e){var t;return e!=null&&(t=e[Ct])&&t.apply(e)}:function(){return null};function be(e,t){var n=e.indexOf(t);return n>=0&&e.splice(n,1),n>=0}var Re={};function De(e){var t,n,r,i;if(arguments.length===1){if(N(e))return e.slice();if(this===Re&&typeof e=="string")return[e];if(i=Ee(e)){for(n=[];r=i.next(),!r.done;)n.push(r.value);return n}if(e==null)return[e];if(t=e.length,typeof t=="number"){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var Rn=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},ji=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"],Pr=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Mn=ji.concat(Pr),Wi={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function vt(e,t){this.name=e,this.message=t}de(vt).from(Error).extend({toString:function(){return this.name+": "+this.message}});function Tr(e,t){return e+". Errors: "+Object.keys(t).map(function(n){return t[n].toString()}).filter(function(n,r,i){return i.indexOf(n)===r}).join(`
`)}function Ut(e,t,n,r){this.failures=t,this.failedKeys=r,this.successCount=n,this.message=Tr(e,t)}de(Ut).from(vt);function mt(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(n){return t[n]}),this.failuresByPos=t,this.message=Tr(e,this.failures)}de(mt).from(vt);var On=Mn.reduce(function(e,t){return e[t]=t+"Error",e},{}),Vi=vt,I=Mn.reduce(function(e,t){var n=t+"Error";function r(i,a){this.name=n,i?typeof i=="string"?(this.message="".concat(i).concat(a?`
 `+a:""),this.inner=a||null):typeof i=="object"&&(this.message="".concat(i.name," ").concat(i.message),this.inner=i):(this.message=Wi[t]||n,this.inner=null)}return de(r).from(Vi),e[t]=r,e},{});I.Syntax=SyntaxError,I.Type=TypeError,I.Range=RangeError;var Ar=Pr.reduce(function(e,t){return e[t+"Error"]=I[t],e},{});function $i(e,t){if(!e||e instanceof vt||e instanceof TypeError||e instanceof SyntaxError||!e.name||!Ar[e.name])return e;var n=new Ar[e.name](t||e.message,e);return"stack"in e&&ee(n,"stack",{get:function(){return this.inner.stack}}),n}var Ht=Mn.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=I[t]),e},{});Ht.ModifyError=Ut,Ht.DexieError=vt,Ht.BulkError=mt;function q(){}function Et(e){return e}function Ui(e,t){return e==null||e===Et?t:function(n){return t(e(n))}}function nt(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function Hi(e,t){return e===q?t:function(){var n=e.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?nt(r,this.onsuccess):r),i&&(this.onerror=this.onerror?nt(i,this.onerror):i),a!==void 0?a:n}}function Gi(e,t){return e===q?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?nt(n,this.onsuccess):n),r&&(this.onerror=this.onerror?nt(r,this.onerror):r)}}function Yi(e,t){return e===q?t:function(n){var r=e.apply(this,arguments);j(n,r);var i=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?nt(i,this.onsuccess):i),a&&(this.onerror=this.onerror?nt(a,this.onerror):a),r===void 0?o===void 0?void 0:o:j(r,o)}}function Qi(e,t){return e===q?t:function(){return t.apply(this,arguments)===!1?!1:e.apply(this,arguments)}}function In(e,t){return e===q?t:function(){var n=e.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,i=arguments.length,a=new Array(i);i--;)a[i]=arguments[i];return n.then(function(){return t.apply(r,a)})}return t.apply(this,arguments)}}var Me=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Rr(e,t){Me=e}var Dt={},Mr=100,Kn=typeof Promise>"u"?[]:function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,Y(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,Y(t),e]}(),Or=Kn[0],Ir=Kn[1],Zi=Kn[2],Xi=Ir&&Ir.then,rt=Or&&Or.constructor,Bn=!!Zi;function Ji(){queueMicrotask(ea)}var Pt=function(e,t){Tt.push([e,t]),Gt&&(Ji(),Gt=!1)},Nn=!0,Gt=!0,it=[],Yt=[],Fn=Et,Ue={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:q,pgp:!1,env:{},finalize:q},M=Ue,Tt=[],at=0,Qt=[];function D(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=M;if(typeof e!="function"){if(e!==Dt)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&zn(this,this._value);return}this._state=null,this._value=null,++t.ref,Br(this,e)}var Ln={get:function(){var e=M,t=qt;function n(r,i){var a=this,o=!e.global&&(e!==M||t!==qt),s=o&&!Ge(),u=new D(function(c,d){jn(a,new Kr(Lr(r,e,o,s),Lr(i,e,o,s),c,d,e))});return this._consoleTask&&(u._consoleTask=this._consoleTask),u}return n.prototype=Dt,n},set:function(e){ee(this,"then",e&&e.prototype===Dt?Ln:{get:function(){return e},set:Ln.set})}};J(D.prototype,{then:Ln,_then:function(e,t){jn(this,new Kr(null,null,e,t,M))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=arguments[0],n=arguments[1];return typeof t=="function"?this.then(null,function(r){return r instanceof t?n(r):Zt(r)}):this.then(null,function(r){return r&&r.name===t?n(r):Zt(r)})},finally:function(e){return this.then(function(t){return D.resolve(e()).then(function(){return t})},function(t){return D.resolve(e()).then(function(){return Zt(t)})})},timeout:function(e,t){var n=this;return e<1/0?new D(function(r,i){var a=setTimeout(function(){return i(new I.Timeout(t))},e);n.then(r,i).finally(clearTimeout.bind(null,a))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&ee(D.prototype,Symbol.toStringTag,"Dexie.Promise"),Ue.env=Fr();function Kr(e,t,n,r,i){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=n,this.reject=r,this.psd=i}J(D,{all:function(){var e=De.apply(null,arguments).map(en);return new D(function(t,n){e.length===0&&t([]);var r=e.length;e.forEach(function(i,a){return D.resolve(i).then(function(o){e[a]=o,--r||t(e)},n)})})},resolve:function(e){if(e instanceof D)return e;if(e&&typeof e.then=="function")return new D(function(n,r){e.then(n,r)});var t=new D(Dt,!0,e);return t},reject:Zt,race:function(){var e=De.apply(null,arguments).map(en);return new D(function(t,n){e.map(function(r){return D.resolve(r).then(t,n)})})},PSD:{get:function(){return M},set:function(e){return M=e}},totalEchoes:{get:function(){return qt}},newPSD:He,usePSD:ot,scheduler:{get:function(){return Pt},set:function(e){Pt=e}},rejectionMapper:{get:function(){return Fn},set:function(e){Fn=e}},follow:function(e,t){return new D(function(n,r){return He(function(i,a){var o=M;o.unhandleds=[],o.onunhandled=a,o.finalize=nt(function(){var s=this;ta(function(){s.unhandleds.length===0?i():a(s.unhandleds[0])})},o.finalize),e()},t,n,r)})}}),rt&&(rt.allSettled&&ee(D,"allSettled",function(){var e=De.apply(null,arguments).map(en);return new D(function(t){e.length===0&&t([]);var n=e.length,r=new Array(n);e.forEach(function(i,a){return D.resolve(i).then(function(o){return r[a]={status:"fulfilled",value:o}},function(o){return r[a]={status:"rejected",reason:o}}).then(function(){return--n||t(r)})})})}),rt.any&&typeof AggregateError<"u"&&ee(D,"any",function(){var e=De.apply(null,arguments).map(en);return new D(function(t,n){e.length===0&&n(new AggregateError([]));var r=e.length,i=new Array(r);e.forEach(function(a,o){return D.resolve(a).then(function(s){return t(s)},function(s){i[o]=s,--r||n(new AggregateError(i))})})})}),rt.withResolvers&&(D.withResolvers=rt.withResolvers));function Br(e,t){try{t(function(n){if(e._state===null){if(n===e)throw new TypeError("A promise cannot be resolved with itself.");var r=e._lib&&yt();n&&typeof n.then=="function"?Br(e,function(i,a){n instanceof D?n._then(i,a):n.then(i,a)}):(e._state=!0,e._value=n,Nr(e)),r&&gt()}},zn.bind(null,e))}catch(n){zn(e,n)}}function zn(e,t){if(Yt.push(t),e._state===null){var n=e._lib&&yt();t=Fn(t),e._state=!1,e._value=t,na(e),Nr(e),n&&gt()}}function Nr(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)jn(e,t[n]);var i=e._PSD;--i.ref||i.finalize(),at===0&&(++at,Pt(function(){--at===0&&Wn()},[]))}function jn(e,t){if(e._state===null){e._listeners.push(t);return}var n=e._state?t.onFulfilled:t.onRejected;if(n===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++at,Pt(qi,[n,e,t])}function qi(e,t,n){try{var r,i=t._value;!t._state&&Yt.length&&(Yt=[]),r=Me&&t._consoleTask?t._consoleTask.run(function(){return e(i)}):e(i),!t._state&&Yt.indexOf(i)===-1&&ra(t),n.resolve(r)}catch(a){n.reject(a)}finally{--at===0&&Wn(),--n.psd.ref||n.psd.finalize()}}function ea(){ot(Ue,function(){yt()&&gt()})}function yt(){var e=Nn;return Nn=!1,Gt=!1,e}function gt(){var e,t,n;do for(;Tt.length>0;)for(e=Tt,Tt=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}while(Tt.length>0);Nn=!0,Gt=!0}function Wn(){var e=it;it=[],e.forEach(function(r){r._PSD.onunhandled.call(null,r._value,r)});for(var t=Qt.slice(0),n=t.length;n;)t[--n]()}function ta(e){function t(){e(),Qt.splice(Qt.indexOf(t),1)}Qt.push(t),++at,Pt(function(){--at===0&&Wn()},[])}function na(e){it.some(function(t){return t._value===e._value})||it.push(e)}function ra(e){for(var t=it.length;t;)if(it[--t]._value===e._value){it.splice(t,1);return}}function Zt(e){return new D(Dt,!1,e)}function re(e,t){var n=M;return function(){var r=yt(),i=M;try{return Ye(n,!0),e.apply(this,arguments)}catch(a){t&&t(a)}finally{Ye(i,!1),r&&gt()}}}var pe={awaits:0,echoes:0,id:0},ia=0,Xt=[],Jt=0,qt=0,aa=0;function He(e,t,n,r){var i=M,a=Object.create(i);a.parent=i,a.ref=0,a.global=!1,a.id=++aa,Ue.env,a.env=Bn?{Promise:D,PromiseProp:{value:D,configurable:!0,writable:!0},all:D.all,race:D.race,allSettled:D.allSettled,any:D.any,resolve:D.resolve,reject:D.reject}:{},t&&j(a,t),++i.ref,a.finalize=function(){--this.parent.ref||this.parent.finalize()};var o=ot(a,e,n,r);return a.ref===0&&a.finalize(),o}function bt(){return pe.id||(pe.id=++ia),++pe.awaits,pe.echoes+=Mr,pe.id}function Ge(){return pe.awaits?(--pe.awaits===0&&(pe.id=0),pe.echoes=pe.awaits*Mr,!0):!1}(""+Xi).indexOf("[native code]")===-1&&(bt=Ge=q);function en(e){return pe.echoes&&e&&e.constructor===rt?(bt(),e.then(function(t){return Ge(),t},function(t){return Ge(),ue(t)})):e}function oa(e){++qt,(!pe.echoes||--pe.echoes===0)&&(pe.echoes=pe.awaits=pe.id=0),Xt.push(M),Ye(e,!0)}function sa(){var e=Xt[Xt.length-1];Xt.pop(),Ye(e,!1)}function Ye(e,t){var n=M;if((t?pe.echoes&&(!Jt++||e!==M):Jt&&(!--Jt||e!==M))&&queueMicrotask(t?oa.bind(null,e):sa),e!==M&&(M=e,n===Ue&&(Ue.env=Fr()),Bn)){var r=Ue.env.Promise,i=e.env;(n.global||e.global)&&(Object.defineProperty(T,"Promise",i.PromiseProp),r.all=i.all,r.race=i.race,r.resolve=i.resolve,r.reject=i.reject,i.allSettled&&(r.allSettled=i.allSettled),i.any&&(r.any=i.any))}}function Fr(){var e=T.Promise;return Bn?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(T,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function ot(e,t,n,r,i){var a=M;try{return Ye(e,!0),t(n,r,i)}finally{Ye(a,!1)}}function Lr(e,t,n,r){return typeof e!="function"?e:function(){var i=M;n&&bt(),Ye(t,!0);try{return e.apply(this,arguments)}finally{Ye(i,!1),r&&queueMicrotask(Ge)}}}function Vn(e){Promise===rt&&pe.echoes===0?Jt===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}var ue=D.reject;function $n(e,t,n,r){if(!e.idbdb||!e._state.openComplete&&!M.letThrough&&!e._vip){if(e._state.openComplete)return ue(new I.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._state.autoOpen)return ue(new I.DatabaseClosed);e.open().catch(q)}return e._state.dbReadyPromise.then(function(){return $n(e,t,n,r)})}else{var i=e._createTransaction(t,n,e._dbSchema);try{i.create(),e._state.PR1398_maxLoop=3}catch(a){return a.name===On.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then(function(){return $n(e,t,n,r)})):ue(a)}return i._promise(t,function(a,o){return He(function(){return M.trans=i,r(a,o,i)})}).then(function(a){if(t==="readwrite")try{i.idbtrans.commit()}catch{}return t==="readonly"?a:i._completion.then(function(){return a})})}}var zr="4.0.11",st="\uFFFF",Un=-1/0,Fe="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",jr="String expected.",wt=[],tn="__dbnames",Hn="readonly",Gn="readwrite";function ut(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var Wr={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function nn(e){return typeof e=="string"&&!/\./.test(e)?function(t){return t[e]===void 0&&e in t&&(t=Ne(t),delete t[e]),t}:function(t){return t}}function Vr(){throw I.Type()}function G(e,t){try{var n=$r(e),r=$r(t);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return ca(Ur(e),Ur(t));case"Array":return ua(e,t)}}catch{}return NaN}function ua(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,a=0;a<i;++a){var o=G(e[a],t[a]);if(o!==0)return o}return n===r?0:n<r?-1:1}function ca(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,a=0;a<i;++a)if(e[a]!==t[a])return e[a]<t[a]?-1:1;return n===r?0:n<r?-1:1}function $r(e){var t=typeof e;if(t!=="object")return t;if(ArrayBuffer.isView(e))return"binary";var n=ht(e);return n==="ArrayBuffer"?"binary":n}function Ur(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var Hr=function(){function e(){}return e.prototype._trans=function(t,n,r){var i=this._tx||M.trans,a=this.name,o=Me&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(t==="readonly"?"read":"write"," ").concat(this.name));function s(d,l,v){if(!v.schema[a])throw new I.NotFound("Table "+a+" not part of transaction");return n(v.idbtrans,v)}var u=yt();try{var c=i&&i.db._novip===this.db._novip?i===M.trans?i._promise(t,s,r):He(function(){return i._promise(t,s,r)},{trans:i,transless:M.transless||M}):$n(this.db,t,[this.name],s);return o&&(c._consoleTask=o,c=c.catch(function(d){return console.trace(d),ue(d)})),c}finally{u&&gt()}},e.prototype.get=function(t,n){var r=this;return t&&t.constructor===Object?this.where(t).first(n):t==null?ue(new I.Type("Invalid argument to Table.get()")):this._trans("readonly",function(i){return r.core.get({trans:i,key:t}).then(function(a){return r.hook.reading.fire(a)})}).then(n)},e.prototype.where=function(t){if(typeof t=="string")return new this.db.WhereClause(this,t);if(N(t))return new this.db.WhereClause(this,"[".concat(t.join("+"),"]"));var n=z(t);if(n.length===1)return this.where(n[0]).equals(t[n[0]]);var r=this.schema.indexes.concat(this.schema.primKey).filter(function(d){if(d.compound&&n.every(function(v){return d.keyPath.indexOf(v)>=0})){for(var l=0;l<n.length;++l)if(n.indexOf(d.keyPath[l])===-1)return!1;return!0}return!1}).sort(function(d,l){return d.keyPath.length-l.keyPath.length})[0];if(r&&this.db._maxKey!==st){var i=r.keyPath.slice(0,n.length);return this.where(i).equals(i.map(function(d){return t[d]}))}!r&&Me&&console.warn("The query ".concat(JSON.stringify(t)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(n.join("+"),"]"));var a=this.schema.idxByName;function o(d,l){return G(d,l)===0}var s=n.reduce(function(d,l){var v=d[0],S=d[1],f=a[l],p=t[l];return[v||f,v||!f?ut(S,f&&f.multi?function(h){var b=W(h,l);return N(b)&&b.some(function(y){return o(p,y)})}:function(h){return o(p,W(h,l))}):S]},[null,null]),u=s[0],c=s[1];return u?this.where(u.name).equals(t[u.keyPath]).filter(c):r?this.filter(c):this.where(n).equals("")},e.prototype.filter=function(t){return this.toCollection().and(t)},e.prototype.count=function(t){return this.toCollection().count(t)},e.prototype.offset=function(t){return this.toCollection().offset(t)},e.prototype.limit=function(t){return this.toCollection().limit(t)},e.prototype.each=function(t){return this.toCollection().each(t)},e.prototype.toArray=function(t){return this.toCollection().toArray(t)},e.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},e.prototype.orderBy=function(t){return new this.db.Collection(new this.db.WhereClause(this,N(t)?"[".concat(t.join("+"),"]"):t))},e.prototype.reverse=function(){return this.toCollection().reverse()},e.prototype.mapToClass=function(t){var n=this,r=n.db,i=n.name;this.schema.mappedClass=t,t.prototype instanceof Vr&&(t=function(u){k(c,u);function c(){return u!==null&&u.apply(this,arguments)||this}return Object.defineProperty(c.prototype,"db",{get:function(){return r},enumerable:!1,configurable:!0}),c.prototype.table=function(){return i},c}(t));for(var a=new Set,o=t.prototype;o;o=Y(o))Object.getOwnPropertyNames(o).forEach(function(u){return a.add(u)});var s=function(u){if(!u)return u;var c=Object.create(t.prototype);for(var d in u)if(!a.has(d))try{c[d]=u[d]}catch{}return c};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=s,this.hook("reading",s),t},e.prototype.defineClass=function(){function t(n){j(this,n)}return this.mapToClass(t)},e.prototype.add=function(t,n){var r=this,i=this.schema.primKey,a=i.auto,o=i.keyPath,s=t;return o&&a&&(s=nn(o)(t)),this._trans("readwrite",function(u){return r.core.mutate({trans:u,type:"add",keys:n!=null?[n]:null,values:[s]})}).then(function(u){return u.numFailures?D.reject(u.failures[0]):u.lastResult}).then(function(u){if(o)try{U(t,o,u)}catch{}return u})},e.prototype.update=function(t,n){if(typeof t=="object"&&!N(t)){var r=W(t,this.schema.primKey.keyPath);return r===void 0?ue(new I.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(r).modify(n)}else return this.where(":id").equals(t).modify(n)},e.prototype.put=function(t,n){var r=this,i=this.schema.primKey,a=i.auto,o=i.keyPath,s=t;return o&&a&&(s=nn(o)(t)),this._trans("readwrite",function(u){return r.core.mutate({trans:u,type:"put",values:[s],keys:n!=null?[n]:null})}).then(function(u){return u.numFailures?D.reject(u.failures[0]):u.lastResult}).then(function(u){if(o)try{U(t,o,u)}catch{}return u})},e.prototype.delete=function(t){var n=this;return this._trans("readwrite",function(r){return n.core.mutate({trans:r,type:"delete",keys:[t]})}).then(function(r){return r.numFailures?D.reject(r.failures[0]):void 0})},e.prototype.clear=function(){var t=this;return this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"deleteRange",range:Wr})}).then(function(n){return n.numFailures?D.reject(n.failures[0]):void 0})},e.prototype.bulkGet=function(t){var n=this;return this._trans("readonly",function(r){return n.core.getMany({keys:t,trans:r}).then(function(i){return i.map(function(a){return n.hook.reading.fire(a)})})})},e.prototype.bulkAdd=function(t,n,r){var i=this,a=Array.isArray(n)?n:void 0;r=r||(a?void 0:n);var o=r?r.allKeys:void 0;return this._trans("readwrite",function(s){var u=i.schema.primKey,c=u.auto,d=u.keyPath;if(d&&a)throw new I.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(a&&a.length!==t.length)throw new I.InvalidArgument("Arguments objects and keys must have the same length");var l=t.length,v=d&&c?t.map(nn(d)):t;return i.core.mutate({trans:s,type:"add",keys:a,values:v,wantResults:o}).then(function(S){var f=S.numFailures,p=S.results,h=S.lastResult,b=S.failures,y=o?p:h;if(f===0)return y;throw new mt("".concat(i.name,".bulkAdd(): ").concat(f," of ").concat(l," operations failed"),b)})})},e.prototype.bulkPut=function(t,n,r){var i=this,a=Array.isArray(n)?n:void 0;r=r||(a?void 0:n);var o=r?r.allKeys:void 0;return this._trans("readwrite",function(s){var u=i.schema.primKey,c=u.auto,d=u.keyPath;if(d&&a)throw new I.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(a&&a.length!==t.length)throw new I.InvalidArgument("Arguments objects and keys must have the same length");var l=t.length,v=d&&c?t.map(nn(d)):t;return i.core.mutate({trans:s,type:"put",keys:a,values:v,wantResults:o}).then(function(S){var f=S.numFailures,p=S.results,h=S.lastResult,b=S.failures,y=o?p:h;if(f===0)return y;throw new mt("".concat(i.name,".bulkPut(): ").concat(f," of ").concat(l," operations failed"),b)})})},e.prototype.bulkUpdate=function(t){var n=this,r=this.core,i=t.map(function(s){return s.key}),a=t.map(function(s){return s.changes}),o=[];return this._trans("readwrite",function(s){return r.getMany({trans:s,keys:i,cache:"clone"}).then(function(u){var c=[],d=[];t.forEach(function(v,S){var f=v.key,p=v.changes,h=u[S];if(h){for(var b=0,y=Object.keys(p);b<y.length;b++){var g=y[b],x=p[g];if(g===n.schema.primKey.keyPath){if(G(x,f)!==0)throw new I.Constraint("Cannot update primary key in bulkUpdate()")}else U(h,g,x)}o.push(S),c.push(f),d.push(h)}});var l=c.length;return r.mutate({trans:s,type:"put",keys:c,values:d,updates:{keys:i,changeSpecs:a}}).then(function(v){var S=v.numFailures,f=v.failures;if(S===0)return l;for(var p=0,h=Object.keys(f);p<h.length;p++){var b=h[p],y=o[Number(b)];if(y!=null){var g=f[b];delete f[b],f[y]=g}}throw new mt("".concat(n.name,".bulkUpdate(): ").concat(S," of ").concat(l," operations failed"),f)})})})},e.prototype.bulkDelete=function(t){var n=this,r=t.length;return this._trans("readwrite",function(i){return n.core.mutate({trans:i,type:"delete",keys:t})}).then(function(i){var a=i.numFailures,o=i.lastResult,s=i.failures;if(a===0)return o;throw new mt("".concat(n.name,".bulkDelete(): ").concat(a," of ").concat(r," operations failed"),s)})},e}();function At(e){var t={},n=function(s,u){if(u){for(var c=arguments.length,d=new Array(c-1);--c;)d[c-1]=arguments[c];return t[s].subscribe.apply(null,d),e}else if(typeof s=="string")return t[s]};n.addEventType=a;for(var r=1,i=arguments.length;r<i;++r)a(arguments[r]);return n;function a(s,u,c){if(typeof s=="object")return o(s);u||(u=Qi),c||(c=q);var d={subscribers:[],fire:c,subscribe:function(l){d.subscribers.indexOf(l)===-1&&(d.subscribers.push(l),d.fire=u(d.fire,l))},unsubscribe:function(l){d.subscribers=d.subscribers.filter(function(v){return v!==l}),d.fire=d.subscribers.reduce(u,c)}};return t[s]=n[s]=d,d}function o(s){z(s).forEach(function(u){var c=s[u];if(N(c))a(u,s[u][0],s[u][1]);else if(c==="asap")var d=a(u,Et,function(){for(var v=arguments.length,S=new Array(v);v--;)S[v]=arguments[v];d.subscribers.forEach(function(f){$t(function(){f.apply(null,S)})})});else throw new I.InvalidArgument("Invalid event config")})}}function Rt(e,t){return de(t).from({prototype:e}),t}function la(e){return Rt(Hr.prototype,function(n,r,i){this.db=e,this._tx=i,this.name=n,this.schema=r,this.hook=e._allTables[n]?e._allTables[n].hook:At(null,{creating:[Hi,q],reading:[Ui,Et],updating:[Yi,q],deleting:[Gi,q]})})}function _t(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Yn(e,t){e.filter=ut(e.filter,t)}function Qn(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return ut(r(),t())}:t,e.justLimit=n&&!r}function fa(e,t){e.isMatch=ut(e.isMatch,t)}function rn(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new I.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function Gr(e,t,n){var r=rn(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:r,range:e.range}})}function an(e,t,n,r){var i=e.replayFilter?ut(e.filter,e.replayFilter()):e.filter;if(e.or){var a={},o=function(s,u,c){if(!i||i(u,c,function(v){return u.stop(v)},function(v){return u.fail(v)})){var d=u.primaryKey,l=""+d;l==="[object ArrayBuffer]"&&(l=""+new Uint8Array(d)),L(a,l)||(a[l]=!0,t(s,u,c))}};return Promise.all([e.or._iterate(o,n),Yr(Gr(e,r,n),e.algorithm,o,!e.keysOnly&&e.valueMapper)])}else return Yr(Gr(e,r,n),ut(e.algorithm,i),t,!e.keysOnly&&e.valueMapper)}function Yr(e,t,n,r){var i=r?function(o,s,u){return n(r(o),s,u)}:n,a=re(i);return e.then(function(o){if(o)return o.start(function(){var s=function(){return o.continue()};(!t||t(o,function(u){return s=u},function(u){o.stop(u),s=q},function(u){o.fail(u),s=q}))&&a(o.value,o,function(u){return s=u}),s()})})}var Mt=function(){function e(t){this["@@propmod"]=t}return e.prototype.execute=function(t){var n,r=this["@@propmod"];if(r.add!==void 0){var i=r.add;if(N(i))return F(F([],N(t)?t:[],!0),i,!0).sort();if(typeof i=="number")return(Number(t)||0)+i;if(typeof i=="bigint")try{return BigInt(t)+i}catch{return BigInt(0)+i}throw new TypeError("Invalid term ".concat(i))}if(r.remove!==void 0){var a=r.remove;if(N(a))return N(t)?t.filter(function(s){return!a.includes(s)}).sort():[];if(typeof a=="number")return Number(t)-a;if(typeof a=="bigint")try{return BigInt(t)-a}catch{return BigInt(0)-a}throw new TypeError("Invalid subtrahend ".concat(a))}var o=(n=r.replacePrefix)===null||n===void 0?void 0:n[0];return o&&typeof t=="string"&&t.startsWith(o)?r.replacePrefix[1]+t.substring(o.length):t},e}(),da=function(){function e(){}return e.prototype._read=function(t,n){var r=this._ctx;return r.error?r.table._trans(null,ue.bind(null,r.error)):r.table._trans("readonly",t).then(n)},e.prototype._write=function(t){var n=this._ctx;return n.error?n.table._trans(null,ue.bind(null,n.error)):n.table._trans("readwrite",t,"locked")},e.prototype._addAlgorithm=function(t){var n=this._ctx;n.algorithm=ut(n.algorithm,t)},e.prototype._iterate=function(t,n){return an(this._ctx,t,n,this._ctx.table.core)},e.prototype.clone=function(t){var n=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return t&&j(r,t),n._ctx=r,n},e.prototype.raw=function(){return this._ctx.valueMapper=null,this},e.prototype.each=function(t){var n=this._ctx;return this._read(function(r){return an(n,t,r,n.table.core)})},e.prototype.count=function(t){var n=this;return this._read(function(r){var i=n._ctx,a=i.table.core;if(_t(i,!0))return a.count({trans:r,query:{index:rn(i,a.schema),range:i.range}}).then(function(s){return Math.min(s,i.limit)});var o=0;return an(i,function(){return++o,!1},r,a).then(function(){return o})}).then(t)},e.prototype.sortBy=function(t,n){var r=t.split(".").reverse(),i=r[0],a=r.length-1;function o(c,d){return d?o(c[r[d]],d-1):c[i]}var s=this._ctx.dir==="next"?1:-1;function u(c,d){var l=o(c,a),v=o(d,a);return G(l,v)*s}return this.toArray(function(c){return c.sort(u)}).then(n)},e.prototype.toArray=function(t){var n=this;return this._read(function(r){var i=n._ctx;if(i.dir==="next"&&_t(i,!0)&&i.limit>0){var a=i.valueMapper,o=rn(i,i.table.core.schema);return i.table.core.query({trans:r,limit:i.limit,values:!0,query:{index:o,range:i.range}}).then(function(u){var c=u.result;return a?c.map(a):c})}else{var s=[];return an(i,function(u){return s.push(u)},r,i.table.core).then(function(){return s})}},t)},e.prototype.offset=function(t){var n=this._ctx;return t<=0?this:(n.offset+=t,_t(n)?Qn(n,function(){var r=t;return function(i,a){return r===0?!0:r===1?(--r,!1):(a(function(){i.advance(r),r=0}),!1)}}):Qn(n,function(){var r=t;return function(){return--r<0}}),this)},e.prototype.limit=function(t){return this._ctx.limit=Math.min(this._ctx.limit,t),Qn(this._ctx,function(){var n=t;return function(r,i,a){return--n<=0&&i(a),n>=0}},!0),this},e.prototype.until=function(t,n){return Yn(this._ctx,function(r,i,a){return t(r.value)?(i(a),n):!0}),this},e.prototype.first=function(t){return this.limit(1).toArray(function(n){return n[0]}).then(t)},e.prototype.last=function(t){return this.reverse().first(t)},e.prototype.filter=function(t){return Yn(this._ctx,function(n){return t(n.value)}),fa(this._ctx,t),this},e.prototype.and=function(t){return this.filter(t)},e.prototype.or=function(t){return new this.db.WhereClause(this._ctx.table,t,this)},e.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},e.prototype.desc=function(){return this.reverse()},e.prototype.eachKey=function(t){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,i){t(i.key,i)})},e.prototype.eachUniqueKey=function(t){return this._ctx.unique="unique",this.eachKey(t)},e.prototype.eachPrimaryKey=function(t){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,i){t(i.primaryKey,i)})},e.prototype.keys=function(t){var n=this._ctx;n.keysOnly=!n.isMatch;var r=[];return this.each(function(i,a){r.push(a.key)}).then(function(){return r}).then(t)},e.prototype.primaryKeys=function(t){var n=this._ctx;if(n.dir==="next"&&_t(n,!0)&&n.limit>0)return this._read(function(i){var a=rn(n,n.table.core.schema);return n.table.core.query({trans:i,values:!1,limit:n.limit,query:{index:a,range:n.range}})}).then(function(i){var a=i.result;return a}).then(t);n.keysOnly=!n.isMatch;var r=[];return this.each(function(i,a){r.push(a.primaryKey)}).then(function(){return r}).then(t)},e.prototype.uniqueKeys=function(t){return this._ctx.unique="unique",this.keys(t)},e.prototype.firstKey=function(t){return this.limit(1).keys(function(n){return n[0]}).then(t)},e.prototype.lastKey=function(t){return this.reverse().firstKey(t)},e.prototype.distinct=function(){var t=this._ctx,n=t.index&&t.table.schema.idxByName[t.index];if(!n||!n.multi)return this;var r={};return Yn(this._ctx,function(i){var a=i.primaryKey.toString(),o=L(r,a);return r[a]=!0,!o}),this},e.prototype.modify=function(t){var n=this,r=this._ctx;return this._write(function(i){var a;if(typeof t=="function")a=t;else{var o=z(t),s=o.length;a=function(y){for(var g=!1,x=0;x<s;++x){var m=o[x],C=t[m],P=W(y,m);C instanceof Mt?(U(y,m,C.execute(P)),g=!0):P!==C&&(U(y,m,C),g=!0)}return g}}var u=r.table.core,c=u.schema.primaryKey,d=c.outbound,l=c.extractKey,v=200,S=n.db._options.modifyChunkSize;S&&(typeof S=="object"?v=S[u.name]||S["*"]||200:v=S);var f=[],p=0,h=[],b=function(y,g){var x=g.failures,m=g.numFailures;p+=y-m;for(var C=0,P=z(x);C<P.length;C++){var E=P[C];f.push(x[E])}};return n.clone().primaryKeys().then(function(y){var g=_t(r)&&r.limit===1/0&&(typeof t!="function"||t===Zn)&&{index:r.index,range:r.range},x=function(m){var C=Math.min(v,y.length-m);return u.getMany({trans:i,keys:y.slice(m,m+C),cache:"immutable"}).then(function(P){for(var E=[],K=[],$=d?[]:null,A=[],V=0;V<C;++V){var B=P[V],Q={value:Ne(B),primKey:y[m+V]};a.call(Q,Q.value,Q)!==!1&&(Q.value==null?A.push(y[m+V]):!d&&G(l(B),l(Q.value))!==0?(A.push(y[m+V]),E.push(Q.value)):(K.push(Q.value),d&&$.push(y[m+V])))}return Promise.resolve(E.length>0&&u.mutate({trans:i,type:"add",values:E}).then(function(O){for(var se in O.failures)A.splice(parseInt(se),1);b(E.length,O)})).then(function(){return(K.length>0||g&&typeof t=="object")&&u.mutate({trans:i,type:"put",keys:$,values:K,criteria:g,changeSpec:typeof t!="function"&&t,isAdditionalChunk:m>0}).then(function(O){return b(K.length,O)})}).then(function(){return(A.length>0||g&&t===Zn)&&u.mutate({trans:i,type:"delete",keys:A,criteria:g,isAdditionalChunk:m>0}).then(function(O){return b(A.length,O)})}).then(function(){return y.length>m+C&&x(m+v)})})};return x(0).then(function(){if(f.length>0)throw new Ut("Error modifying one or more objects",f,p,h);return y.length})})})},e.prototype.delete=function(){var t=this._ctx,n=t.range;return _t(t)&&(t.isPrimKey||n.type===3)?this._write(function(r){var i=t.table.core.schema.primaryKey,a=n;return t.table.core.count({trans:r,query:{index:i,range:a}}).then(function(o){return t.table.core.mutate({trans:r,type:"deleteRange",range:a}).then(function(s){var u=s.failures;s.lastResult,s.results;var c=s.numFailures;if(c)throw new Ut("Could not delete some values",Object.keys(u).map(function(d){return u[d]}),o-c);return o-c})})}):this.modify(Zn)},e}(),Zn=function(e,t){return t.value=null};function pa(e){return Rt(da.prototype,function(n,r){this.db=e;var i=Wr,a=null;if(r)try{i=r()}catch(c){a=c}var o=n._ctx,s=o.table,u=s.hook.reading.fire;this._ctx={table:s,index:o.index,isPrimKey:!o.index||s.schema.primKey.keyPath&&o.index===s.schema.primKey.name,range:i,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:a,or:o.or,valueMapper:u!==Et?u:null}})}function ha(e,t){return e<t?-1:e===t?0:1}function va(e,t){return e>t?-1:e===t?0:1}function xe(e,t,n){var r=e instanceof Zr?new e.Collection(e):e;return r._ctx.error=n?new n(t):new TypeError(t),r}function xt(e){return new e.Collection(e,function(){return Qr("")}).limit(0)}function ma(e){return e==="next"?function(t){return t.toUpperCase()}:function(t){return t.toLowerCase()}}function ya(e){return e==="next"?function(t){return t.toLowerCase()}:function(t){return t.toUpperCase()}}function ga(e,t,n,r,i,a){for(var o=Math.min(e.length,r.length),s=-1,u=0;u<o;++u){var c=t[u];if(c!==r[u])return i(e[u],n[u])<0?e.substr(0,u)+n[u]+n.substr(u+1):i(e[u],r[u])<0?e.substr(0,u)+r[u]+n.substr(u+1):s>=0?e.substr(0,s)+t[s]+n.substr(s+1):null;i(e[u],c)<0&&(s=u)}return o<r.length&&a==="next"?e+n.substr(e.length):o<e.length&&a==="prev"?e.substr(0,n.length):s<0?null:e.substr(0,s)+r[s]+n.substr(s+1)}function on(e,t,n,r){var i,a,o,s,u,c,d,l=n.length;if(!n.every(function(p){return typeof p=="string"}))return xe(e,jr);function v(p){i=ma(p),a=ya(p),o=p==="next"?ha:va;var h=n.map(function(b){return{lower:a(b),upper:i(b)}}).sort(function(b,y){return o(b.lower,y.lower)});s=h.map(function(b){return b.upper}),u=h.map(function(b){return b.lower}),c=p,d=p==="next"?"":r}v("next");var S=new e.Collection(e,function(){return Qe(s[0],u[l-1]+r)});S._ondirectionchange=function(p){v(p)};var f=0;return S._addAlgorithm(function(p,h,b){var y=p.key;if(typeof y!="string")return!1;var g=a(y);if(t(g,u,f))return!0;for(var x=null,m=f;m<l;++m){var C=ga(y,g,s[m],u[m],o,c);C===null&&x===null?f=m+1:(x===null||o(x,C)>0)&&(x=C)}return h(x!==null?function(){p.continue(x+d)}:b),!1}),S}function Qe(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function Qr(e){return{type:1,lower:e,upper:e}}var Zr=function(){function e(){}return Object.defineProperty(e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),e.prototype.between=function(t,n,r,i){r=r!==!1,i=i===!0;try{return this._cmp(t,n)>0||this._cmp(t,n)===0&&(r||i)&&!(r&&i)?xt(this):new this.Collection(this,function(){return Qe(t,n,!r,!i)})}catch{return xe(this,Fe)}},e.prototype.equals=function(t){return t==null?xe(this,Fe):new this.Collection(this,function(){return Qr(t)})},e.prototype.above=function(t){return t==null?xe(this,Fe):new this.Collection(this,function(){return Qe(t,void 0,!0)})},e.prototype.aboveOrEqual=function(t){return t==null?xe(this,Fe):new this.Collection(this,function(){return Qe(t,void 0,!1)})},e.prototype.below=function(t){return t==null?xe(this,Fe):new this.Collection(this,function(){return Qe(void 0,t,!1,!0)})},e.prototype.belowOrEqual=function(t){return t==null?xe(this,Fe):new this.Collection(this,function(){return Qe(void 0,t)})},e.prototype.startsWith=function(t){return typeof t!="string"?xe(this,jr):this.between(t,t+st,!0,!0)},e.prototype.startsWithIgnoreCase=function(t){return t===""?this.startsWith(t):on(this,function(n,r){return n.indexOf(r[0])===0},[t],st)},e.prototype.equalsIgnoreCase=function(t){return on(this,function(n,r){return n===r[0]},[t],"")},e.prototype.anyOfIgnoreCase=function(){var t=De.apply(Re,arguments);return t.length===0?xt(this):on(this,function(n,r){return r.indexOf(n)!==-1},t,"")},e.prototype.startsWithAnyOfIgnoreCase=function(){var t=De.apply(Re,arguments);return t.length===0?xt(this):on(this,function(n,r){return r.some(function(i){return n.indexOf(i)===0})},t,st)},e.prototype.anyOf=function(){var t=this,n=De.apply(Re,arguments),r=this._cmp;try{n.sort(r)}catch{return xe(this,Fe)}if(n.length===0)return xt(this);var i=new this.Collection(this,function(){return Qe(n[0],n[n.length-1])});i._ondirectionchange=function(o){r=o==="next"?t._ascending:t._descending,n.sort(r)};var a=0;return i._addAlgorithm(function(o,s,u){for(var c=o.key;r(c,n[a])>0;)if(++a,a===n.length)return s(u),!1;return r(c,n[a])===0?!0:(s(function(){o.continue(n[a])}),!1)}),i},e.prototype.notEqual=function(t){return this.inAnyRange([[Un,t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},e.prototype.noneOf=function(){var t=De.apply(Re,arguments);if(t.length===0)return new this.Collection(this);try{t.sort(this._ascending)}catch{return xe(this,Fe)}var n=t.reduce(function(r,i){return r?r.concat([[r[r.length-1][1],i]]):[[Un,i]]},null);return n.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})},e.prototype.inAnyRange=function(t,n){var r=this,i=this._cmp,a=this._ascending,o=this._descending,s=this._min,u=this._max;if(t.length===0)return xt(this);if(!t.every(function(m){return m[0]!==void 0&&m[1]!==void 0&&a(m[0],m[1])<=0}))return xe(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",I.InvalidArgument);var c=!n||n.includeLowers!==!1,d=n&&n.includeUppers===!0;function l(m,C){for(var P=0,E=m.length;P<E;++P){var K=m[P];if(i(C[0],K[1])<0&&i(C[1],K[0])>0){K[0]=s(K[0],C[0]),K[1]=u(K[1],C[1]);break}}return P===E&&m.push(C),m}var v=a;function S(m,C){return v(m[0],C[0])}var f;try{f=t.reduce(l,[]),f.sort(S)}catch{return xe(this,Fe)}var p=0,h=d?function(m){return a(m,f[p][1])>0}:function(m){return a(m,f[p][1])>=0},b=c?function(m){return o(m,f[p][0])>0}:function(m){return o(m,f[p][0])>=0};function y(m){return!h(m)&&!b(m)}var g=h,x=new this.Collection(this,function(){return Qe(f[0][0],f[f.length-1][1],!c,!d)});return x._ondirectionchange=function(m){m==="next"?(g=h,v=a):(g=b,v=o),f.sort(S)},x._addAlgorithm(function(m,C,P){for(var E=m.key;g(E);)if(++p,p===f.length)return C(P),!1;return y(E)?!0:(r._cmp(E,f[p][1])===0||r._cmp(E,f[p][0])===0||C(function(){v===a?m.continue(f[p][0]):m.continue(f[p][1])}),!1)}),x},e.prototype.startsWithAnyOf=function(){var t=De.apply(Re,arguments);return t.every(function(n){return typeof n=="string"})?t.length===0?xt(this):this.inAnyRange(t.map(function(n){return[n,n+st]})):xe(this,"startsWithAnyOf() only works with strings")},e}();function ba(e){return Rt(Zr.prototype,function(n,r,i){if(this.db=e,this._ctx={table:n,index:r===":id"?null:r,or:i},this._cmp=this._ascending=G,this._descending=function(a,o){return G(o,a)},this._max=function(a,o){return G(a,o)>0?a:o},this._min=function(a,o){return G(a,o)<0?a:o},this._IDBKeyRange=e._deps.IDBKeyRange,!this._IDBKeyRange)throw new I.MissingAPI})}function Oe(e){return re(function(t){return Ot(t),e(t.target.error),!1})}function Ot(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var It="storagemutated",Xn="x-storagemutated-1",Ze=At(null,It),wa=function(){function e(){}return e.prototype._lock=function(){return Ae(!M.global),++this._reculock,this._reculock===1&&!M.global&&(M.lockOwnerFor=this),this},e.prototype._unlock=function(){if(Ae(!M.global),--this._reculock===0)for(M.global||(M.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{ot(t[1],t[0])}catch{}}return this},e.prototype._locked=function(){return this._reculock&&M.lockOwnerFor!==this},e.prototype.create=function(t){var n=this;if(!this.mode)return this;var r=this.db.idbdb,i=this.db._state.dbOpenError;if(Ae(!this.idbtrans),!t&&!r)switch(i&&i.name){case"DatabaseClosedError":throw new I.DatabaseClosed(i);case"MissingAPIError":throw new I.MissingAPI(i.message,i);default:throw new I.OpenFailed(i)}if(!this.active)throw new I.TransactionInactive;return Ae(this._completion._state===null),t=this.idbtrans=t||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):r.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})),t.onerror=re(function(a){Ot(a),n._reject(t.error)}),t.onabort=re(function(a){Ot(a),n.active&&n._reject(new I.Abort(t.error)),n.active=!1,n.on("abort").fire(a)}),t.oncomplete=re(function(){n.active=!1,n._resolve(),"mutatedParts"in t&&Ze.storagemutated.fire(t.mutatedParts)}),this},e.prototype._promise=function(t,n,r){var i=this;if(t==="readwrite"&&this.mode!=="readwrite")return ue(new I.ReadOnly("Transaction is readonly"));if(!this.active)return ue(new I.TransactionInactive);if(this._locked())return new D(function(o,s){i._blockedFuncs.push([function(){i._promise(t,n,r).then(o,s)},M])});if(r)return He(function(){var o=new D(function(s,u){i._lock();var c=n(s,u,i);c&&c.then&&c.then(s,u)});return o.finally(function(){return i._unlock()}),o._lib=!0,o});var a=new D(function(o,s){var u=n(o,s,i);u&&u.then&&u.then(o,s)});return a._lib=!0,a},e.prototype._root=function(){return this.parent?this.parent._root():this},e.prototype.waitFor=function(t){var n=this._root(),r=D.resolve(t);if(n._waitingFor)n._waitingFor=n._waitingFor.then(function(){return r});else{n._waitingFor=r,n._waitingQueue=[];var i=n.idbtrans.objectStore(n.storeNames[0]);(function o(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(i.get(-1/0).onsuccess=o)})()}var a=n._waitingFor;return new D(function(o,s){r.then(function(u){return n._waitingQueue.push(re(o.bind(null,u)))},function(u){return n._waitingQueue.push(re(s.bind(null,u)))}).finally(function(){n._waitingFor===a&&(n._waitingFor=null)})})},e.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new I.Abort))},e.prototype.table=function(t){var n=this._memoizedTables||(this._memoizedTables={});if(L(n,t))return n[t];var r=this.schema[t];if(!r)throw new I.NotFound("Table "+t+" not part of transaction");var i=new this.db.Table(t,r,this);return i.core=this.db.core.table(t),n[t]=i,i},e}();function _a(e){return Rt(wa.prototype,function(n,r,i,a,o){var s=this;this.db=e,this.mode=n,this.storeNames=r,this.schema=i,this.chromeTransactionDurability=a,this.idbtrans=null,this.on=At(this,"complete","error","abort"),this.parent=o||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new D(function(u,c){s._resolve=u,s._reject=c}),this._completion.then(function(){s.active=!1,s.on.complete.fire()},function(u){var c=s.active;return s.active=!1,s.on.error.fire(u),s.parent?s.parent._reject(u):c&&s.idbtrans&&s.idbtrans.abort(),ue(u)})})}function Jn(e,t,n,r,i,a,o){return{name:e,keyPath:t,unique:n,multi:r,auto:i,compound:a,src:(n&&!o?"&":"")+(r?"*":"")+(i?"++":"")+Xr(t)}}function Xr(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function qn(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:Tn(n,function(r){return[r.name,r]})}}function xa(e){return e.length===1?e[0]:e}var Kt=function(e){try{return e.only([[]]),Kt=function(){return[[]]},[[]]}catch{return Kt=function(){return st},st}};function er(e){return e==null?function(){}:typeof e=="string"?ka(e):function(t){return W(t,e)}}function ka(e){var t=e.split(".");return t.length===1?function(n){return n[e]}:function(n){return W(n,e)}}function Jr(e){return[].slice.call(e)}var Sa=0;function Bt(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function Ca(e,t,n){function r(l,v){var S=Jr(l.objectStoreNames);return{schema:{name:l.name,tables:S.map(function(f){return v.objectStore(f)}).map(function(f){var p=f.keyPath,h=f.autoIncrement,b=N(p),y=p==null,g={},x={name:f.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:y,compound:b,keyPath:p,autoIncrement:h,unique:!0,extractKey:er(p)},indexes:Jr(f.indexNames).map(function(m){return f.index(m)}).map(function(m){var C=m.name,P=m.unique,E=m.multiEntry,K=m.keyPath,$=N(K),A={name:C,compound:$,keyPath:K,unique:P,multiEntry:E,extractKey:er(K)};return g[Bt(K)]=A,A}),getIndexByKeyPath:function(m){return g[Bt(m)]}};return g[":id"]=x.primaryKey,p!=null&&(g[Bt(p)]=x.primaryKey),x})},hasGetAll:S.length>0&&"getAll"in v.objectStore(S[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function i(l){if(l.type===3)return null;if(l.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var v=l.lower,S=l.upper,f=l.lowerOpen,p=l.upperOpen,h=v===void 0?S===void 0?null:t.upperBound(S,!!p):S===void 0?t.lowerBound(v,!!f):t.bound(v,S,!!f,!!p);return h}function a(l){var v=l.name;function S(h){var b=h.trans,y=h.type,g=h.keys,x=h.values,m=h.range;return new Promise(function(C,P){C=re(C);var E=b.objectStore(v),K=E.keyPath==null,$=y==="put"||y==="add";if(!$&&y!=="delete"&&y!=="deleteRange")throw new Error("Invalid operation type: "+y);var A=(g||x||{length:1}).length;if(g&&x&&g.length!==x.length)throw new Error("Given keys array must have same length as given values array.");if(A===0)return C({numFailures:0,failures:{},results:[],lastResult:void 0});var V,B=[],Q=[],O=0,se=function(Ke){++O,Ot(Ke)};if(y==="deleteRange"){if(m.type===4)return C({numFailures:O,failures:Q,results:[],lastResult:void 0});m.type===3?B.push(V=E.clear()):B.push(V=E.delete(i(m)))}else{var me=$?K?[x,g]:[x,null]:[g,null],Ie=me[0],we=me[1];if($)for(var Ce=0;Ce<A;++Ce)B.push(V=we&&we[Ce]!==void 0?E[y](Ie[Ce],we[Ce]):E[y](Ie[Ce])),V.onerror=se;else for(var Ce=0;Ce<A;++Ce)B.push(V=E[y](Ie[Ce])),V.onerror=se}var qe=function(Ke){var Lt=Ke.target.result;B.forEach(function(Pe,gn){return Pe.error!=null&&(Q[gn]=Pe.error)}),C({numFailures:O,failures:Q,results:y==="delete"?g:B.map(function(Pe){return Pe.result}),lastResult:Lt})};V.onerror=function(Ke){se(Ke),qe(Ke)},V.onsuccess=qe})}function f(h){var b=h.trans,y=h.values,g=h.query,x=h.reverse,m=h.unique;return new Promise(function(C,P){C=re(C);var E=g.index,K=g.range,$=b.objectStore(v),A=E.isPrimaryKey?$:$.index(E.name),V=x?m?"prevunique":"prev":m?"nextunique":"next",B=y||!("openKeyCursor"in A)?A.openCursor(i(K),V):A.openKeyCursor(i(K),V);B.onerror=Oe(P),B.onsuccess=re(function(Q){var O=B.result;if(!O){C(null);return}O.___id=++Sa,O.done=!1;var se=O.continue.bind(O),me=O.continuePrimaryKey;me&&(me=me.bind(O));var Ie=O.advance.bind(O),we=function(){throw new Error("Cursor not started")},Ce=function(){throw new Error("Cursor not stopped")};O.trans=b,O.stop=O.continue=O.continuePrimaryKey=O.advance=we,O.fail=re(P),O.next=function(){var qe=this,Ke=1;return this.start(function(){return Ke--?qe.continue():qe.stop()}).then(function(){return qe})},O.start=function(qe){var Ke=new Promise(function(Pe,gn){Pe=re(Pe),B.onerror=Oe(gn),O.fail=gn,O.stop=function(po){O.stop=O.continue=O.continuePrimaryKey=O.advance=Ce,Pe(po)}}),Lt=function(){if(B.result)try{qe()}catch(Pe){O.fail(Pe)}else O.done=!0,O.start=function(){throw new Error("Cursor behind last entry")},O.stop()};return B.onsuccess=re(function(Pe){B.onsuccess=Lt,Lt()}),O.continue=se,O.continuePrimaryKey=me,O.advance=Ie,Lt(),Ke},C(O)},P)})}function p(h){return function(b){return new Promise(function(y,g){y=re(y);var x=b.trans,m=b.values,C=b.limit,P=b.query,E=C===1/0?void 0:C,K=P.index,$=P.range,A=x.objectStore(v),V=K.isPrimaryKey?A:A.index(K.name),B=i($);if(C===0)return y({result:[]});if(h){var Q=m?V.getAll(B,E):V.getAllKeys(B,E);Q.onsuccess=function(Ie){return y({result:Ie.target.result})},Q.onerror=Oe(g)}else{var O=0,se=m||!("openKeyCursor"in V)?V.openCursor(B):V.openKeyCursor(B),me=[];se.onsuccess=function(Ie){var we=se.result;if(!we)return y({result:me});if(me.push(m?we.value:we.primaryKey),++O===C)return y({result:me});we.continue()},se.onerror=Oe(g)}})}}return{name:v,schema:l,mutate:S,getMany:function(h){var b=h.trans,y=h.keys;return new Promise(function(g,x){g=re(g);for(var m=b.objectStore(v),C=y.length,P=new Array(C),E=0,K=0,$,A=function(O){var se=O.target;(P[se._pos]=se.result)!=null,++K===E&&g(P)},V=Oe(x),B=0;B<C;++B){var Q=y[B];Q!=null&&($=m.get(y[B]),$._pos=B,$.onsuccess=A,$.onerror=V,++E)}E===0&&g(P)})},get:function(h){var b=h.trans,y=h.key;return new Promise(function(g,x){g=re(g);var m=b.objectStore(v),C=m.get(y);C.onsuccess=function(P){return g(P.target.result)},C.onerror=Oe(x)})},query:p(u),openCursor:f,count:function(h){var b=h.query,y=h.trans,g=b.index,x=b.range;return new Promise(function(m,C){var P=y.objectStore(v),E=g.isPrimaryKey?P:P.index(g.name),K=i(x),$=K?E.count(K):E.count();$.onsuccess=re(function(A){return m(A.target.result)}),$.onerror=Oe(C)})}}}var o=r(e,n),s=o.schema,u=o.hasGetAll,c=s.tables.map(function(l){return a(l)}),d={};return c.forEach(function(l){return d[l.name]=l}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(l){var v=d[l];if(!v)throw new Error("Table '".concat(l,"' not found"));return d[l]},MIN_KEY:-1/0,MAX_KEY:Kt(t),schema:s}}function Ea(e,t){return t.reduce(function(n,r){var i=r.create;return w(w({},n),i(n))},e)}function Da(e,t,n,r){var i=n.IDBKeyRange;n.indexedDB;var a=Ea(Ca(t,i,r),e.dbcore);return{dbcore:a}}function sn(e,t){var n=t.db,r=Da(e._middlewares,n,e._deps,t);e.core=r.dbcore,e.tables.forEach(function(i){var a=i.name;e.core.schema.tables.some(function(o){return o.name===a})&&(i.core=e.core.table(a),e[a]instanceof e.Table&&(e[a].core=i.core))})}function un(e,t,n,r){n.forEach(function(i){var a=r[i];t.forEach(function(o){var s=We(o,i);(!s||"value"in s&&s.value===void 0)&&(o===e.Transaction.prototype||o instanceof e.Transaction?ee(o,i,{get:function(){return this.table(i)},set:function(u){X(this,i,{value:u,writable:!0,configurable:!0,enumerable:!0})}}):o[i]=new e.Table(i,a))})})}function tr(e,t){t.forEach(function(n){for(var r in n)n[r]instanceof e.Table&&delete n[r]})}function Pa(e,t){return e._cfg.version-t._cfg.version}function Ta(e,t,n,r){var i=e._dbSchema;n.objectStoreNames.contains("$meta")&&!i.$meta&&(i.$meta=qn("$meta",ei("")[0],[]),e._storeNames.push("$meta"));var a=e._createTransaction("readwrite",e._storeNames,i);a.create(n),a._completion.catch(r);var o=a._reject.bind(a),s=M.transless||M;He(function(){if(M.trans=a,M.transless=s,t===0)z(i).forEach(function(u){rr(n,u,i[u].primKey,i[u].indexes)}),sn(e,n),D.follow(function(){return e.on.populate.fire(a)}).catch(o);else return sn(e,n),Ra(e,a,t).then(function(u){return Ma(e,u,a,n)}).catch(o)})}function Aa(e,t){qr(e._dbSchema,t),t.db.version%10===0&&!t.objectStoreNames.contains("$meta")&&t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var n=ln(e,e.idbdb,t);fn(e,e._dbSchema,t);for(var r=nr(n,e._dbSchema),i=function(c){if(c.change.length||c.recreate)return console.warn("Unable to patch indexes of table ".concat(c.name," because it has changes on the type of index or primary key.")),{value:void 0};var d=t.objectStore(c.name);c.add.forEach(function(l){Me&&console.debug("Dexie upgrade patch: Creating missing index ".concat(c.name,".").concat(l.src)),cn(d,l)})},a=0,o=r.change;a<o.length;a++){var s=o[a],u=i(s);if(typeof u=="object")return u.value}}function Ra(e,t,n){return t.storeNames.includes("$meta")?t.table("$meta").get("version").then(function(r){return r??n}):D.resolve(n)}function Ma(e,t,n,r){var i=[],a=e._versions,o=e._dbSchema=ln(e,e.idbdb,r),s=a.filter(function(c){return c._cfg.version>=t});if(s.length===0)return D.resolve();s.forEach(function(c){i.push(function(){var d=o,l=c._cfg.dbschema;fn(e,d,r),fn(e,l,r),o=e._dbSchema=l;var v=nr(d,l);v.add.forEach(function(y){rr(r,y[0],y[1].primKey,y[1].indexes)}),v.change.forEach(function(y){if(y.recreate)throw new I.Upgrade("Not yet support for changing primary key");var g=r.objectStore(y.name);y.add.forEach(function(x){return cn(g,x)}),y.change.forEach(function(x){g.deleteIndex(x.name),cn(g,x)}),y.del.forEach(function(x){return g.deleteIndex(x)})});var S=c._cfg.contentUpgrade;if(S&&c._cfg.version>t){sn(e,r),n._memoizedTables={};var f=oe(l);v.del.forEach(function(y){f[y]=d[y]}),tr(e,[e.Transaction.prototype]),un(e,[e.Transaction.prototype],z(f),f),n.schema=f;var p=Rn(S);p&&bt();var h,b=D.follow(function(){if(h=S(n),h&&p){var y=Ge.bind(null,null);h.then(y,y)}});return h&&typeof h.then=="function"?D.resolve(h):b.then(function(){return h})}}),i.push(function(d){var l=c._cfg.dbschema;Oa(l,d),tr(e,[e.Transaction.prototype]),un(e,[e.Transaction.prototype],e._storeNames,e._dbSchema),n.schema=e._dbSchema}),i.push(function(d){e.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(e.idbdb.version/10)===c._cfg.version?(e.idbdb.deleteObjectStore("$meta"),delete e._dbSchema.$meta,e._storeNames=e._storeNames.filter(function(l){return l!=="$meta"})):d.objectStore("$meta").put(c._cfg.version,"version"))})});function u(){return i.length?D.resolve(i.shift()(n.idbtrans)).then(u):D.resolve()}return u().then(function(){qr(o,r)})}function nr(e,t){var n={del:[],add:[],change:[]},r;for(r in e)t[r]||n.del.push(r);for(r in t){var i=e[r],a=t[r];if(!i)n.add.push([r,a]);else{var o={name:r,def:a,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(a.primKey.keyPath||"")||i.primKey.auto!==a.primKey.auto)o.recreate=!0,n.change.push(o);else{var s=i.idxByName,u=a.idxByName,c=void 0;for(c in s)u[c]||o.del.push(c);for(c in u){var d=s[c],l=u[c];d?d.src!==l.src&&o.change.push(l):o.add.push(l)}(o.del.length>0||o.add.length>0||o.change.length>0)&&n.change.push(o)}}}return n}function rr(e,t,n,r){var i=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(function(a){return cn(i,a)}),i}function qr(e,t){z(e).forEach(function(n){t.db.objectStoreNames.contains(n)||(Me&&console.debug("Dexie: Creating missing table",n),rr(t,n,e[n].primKey,e[n].indexes))})}function Oa(e,t){[].slice.call(t.db.objectStoreNames).forEach(function(n){return e[n]==null&&t.db.deleteObjectStore(n)})}function cn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function ln(e,t,n){var r={},i=pt(t.objectStoreNames,0);return i.forEach(function(a){for(var o=n.objectStore(a),s=o.keyPath,u=Jn(Xr(s),s||"",!0,!1,!!o.autoIncrement,s&&typeof s!="string",!0),c=[],d=0;d<o.indexNames.length;++d){var l=o.index(o.indexNames[d]);s=l.keyPath;var v=Jn(l.name,s,!!l.unique,!!l.multiEntry,!1,s&&typeof s!="string",!1);c.push(v)}r[a]=qn(a,u,c)}),r}function Ia(e,t,n){e.verno=t.version/10;var r=e._dbSchema=ln(e,t,n);e._storeNames=pt(t.objectStoreNames,0),un(e,[e._allTables],z(r),r)}function Ka(e,t){var n=ln(e,e.idbdb,t),r=nr(n,e._dbSchema);return!(r.add.length||r.change.some(function(i){return i.add.length||i.change.length}))}function fn(e,t,n){for(var r=n.db.objectStoreNames,i=0;i<r.length;++i){var a=r[i],o=n.objectStore(a);e._hasGetAll="getAll"in o;for(var s=0;s<o.indexNames.length;++s){var u=o.indexNames[s],c=o.index(u).keyPath,d=typeof c=="string"?c:"["+pt(c).join("+")+"]";if(t[a]){var l=t[a].idxByName[d];l&&(l.name=u,delete t[a].idxByName[d],t[a].idxByName[u]=l)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&T.WorkerGlobalScope&&T instanceof T.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function ei(e){return e.split(",").map(function(t,n){t=t.trim();var r=t.replace(/([&*]|\+\+)/g,""),i=/^\[/.test(r)?r.match(/^\[(.*)\]$/)[1].split("+"):r;return Jn(r,i||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),N(i),n===0)})}var Ba=function(){function e(){}return e.prototype._parseStoresSpec=function(t,n){z(t).forEach(function(r){if(t[r]!==null){var i=ei(t[r]),a=i.shift();if(a.unique=!0,a.multi)throw new I.Schema("Primary key cannot be multi-valued");i.forEach(function(o){if(o.auto)throw new I.Schema("Only primary key can be marked as autoIncrement (++)");if(!o.keyPath)throw new I.Schema("Index must have a name and cannot be an empty string")}),n[r]=qn(r,a,i)}})},e.prototype.stores=function(t){var n=this.db;this._cfg.storesSource=this._cfg.storesSource?j(this._cfg.storesSource,t):t;var r=n._versions,i={},a={};return r.forEach(function(o){j(i,o._cfg.storesSource),a=o._cfg.dbschema={},o._parseStoresSpec(i,a)}),n._dbSchema=a,tr(n,[n._allTables,n,n.Transaction.prototype]),un(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],z(a),a),n._storeNames=z(a),this},e.prototype.upgrade=function(t){return this._cfg.contentUpgrade=In(this._cfg.contentUpgrade||q,t),this},e}();function Na(e){return Rt(Ba.prototype,function(n){this.db=e,this._cfg={version:n,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}function ir(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new Le(tn,{addons:[],indexedDB:e,IDBKeyRange:t}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function ar(e){return e&&typeof e.databases=="function"}function Fa(e){var t=e.indexedDB,n=e.IDBKeyRange;return ar(t)?Promise.resolve(t.databases()).then(function(r){return r.map(function(i){return i.name}).filter(function(i){return i!==tn})}):ir(t,n).toCollection().primaryKeys()}function La(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!ar(n)&&t!==tn&&ir(n,r).put({name:t}).catch(q)}function za(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!ar(n)&&t!==tn&&ir(n,r).delete(t).catch(q)}function or(e){return He(function(){return M.letThrough=!0,e()})}function ja(){var e=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!e||!indexedDB.databases)return Promise.resolve();var t;return new Promise(function(n){var r=function(){return indexedDB.databases().finally(n)};t=setInterval(r,100),r()}).finally(function(){return clearInterval(t)})}var sr;function ur(e){return!("from"in e)}var ve=function(e,t){if(this)j(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0});else{var n=new ve;return e&&"d"in e&&j(n,e),n}};J(ve.prototype,(sr={add:function(e){return Ft(this,e),this},addKey:function(e){return Nt(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(n){return Nt(t,n,n)}),this},hasKey:function(e){var t=dn(this).next(e).value;return t&&G(t.from,e)<=0&&G(t.to,e)>=0}},sr[Ct]=function(){return dn(this)},sr));function Nt(e,t,n){var r=G(t,n);if(!isNaN(r)){if(r>0)throw RangeError();if(ur(e))return j(e,{from:t,to:n,d:1});var i=e.l,a=e.r;if(G(n,e.from)<0)return i?Nt(i,t,n):e.l={from:t,to:n,d:1,l:null,r:null},ni(e);if(G(t,e.to)>0)return a?Nt(a,t,n):e.r={from:t,to:n,d:1,l:null,r:null},ni(e);G(t,e.from)<0&&(e.from=t,e.l=null,e.d=a?a.d+1:1),G(n,e.to)>0&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1);var o=!e.r;i&&!e.l&&Ft(e,i),a&&o&&Ft(e,a)}}function Ft(e,t){function n(r,i){var a=i.from,o=i.to,s=i.l,u=i.r;Nt(r,a,o),s&&n(r,s),u&&n(r,u)}ur(t)||n(e,t)}function ti(e,t){var n=dn(t),r=n.next();if(r.done)return!1;for(var i=r.value,a=dn(e),o=a.next(i.from),s=o.value;!r.done&&!o.done;){if(G(s.from,i.to)<=0&&G(s.to,i.from)>=0)return!0;G(i.from,s.from)<0?i=(r=n.next(s.from)).value:s=(o=a.next(i.from)).value}return!1}function dn(e){var t=ur(e)?null:{s:0,n:e};return{next:function(n){for(var r=arguments.length>0;t;)switch(t.s){case 0:if(t.s=1,r)for(;t.n.l&&G(n,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!r||G(n,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function ni(e){var t,n,r=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((n=e.l)===null||n===void 0?void 0:n.d)||0),i=r>1?"r":r<-1?"l":"";if(i){var a=i==="r"?"l":"r",o=w({},e),s=e[i];e.from=s.from,e.to=s.to,e[i]=s[i],o[i]=s[a],e[a]=o,o.d=ri(o)}e.d=ri(e)}function ri(e){var t=e.r,n=e.l;return(t?n?Math.max(t.d,n.d):t.d:n?n.d:0)+1}function pn(e,t){return z(t).forEach(function(n){e[n]?Ft(e[n],t[n]):e[n]=Ve(t[n])}),e}function cr(e,t){return e.all||t.all||Object.keys(e).some(function(n){return t[n]&&ti(t[n],e[n])})}var ct={},lr={},fr=!1;function hn(e,t){pn(lr,e),fr||(fr=!0,setTimeout(function(){fr=!1;var n=lr;lr={},dr(n,!1)},0))}function dr(e,t){t===void 0&&(t=!1);var n=new Set;if(e.all)for(var r=0,i=Object.values(ct);r<i.length;r++){var a=i[r];ii(a,e,n,t)}else for(var o in e){var s=/^idb\:\/\/(.*)\/(.*)\//.exec(o);if(s){var u=s[1],c=s[2],a=ct["idb://".concat(u,"/").concat(c)];a&&ii(a,e,n,t)}}n.forEach(function(d){return d()})}function ii(e,t,n,r){for(var i=[],a=0,o=Object.entries(e.queries.query);a<o.length;a++){for(var s=o[a],u=s[0],c=s[1],d=[],l=0,v=c;l<v.length;l++){var S=v[l];cr(t,S.obsSet)?S.subscribers.forEach(function(b){return n.add(b)}):r&&d.push(S)}r&&i.push([u,d])}if(r)for(var f=0,p=i;f<p.length;f++){var h=p[f],u=h[0],d=h[1];e.queries.query[u]=d}}function Wa(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?ue(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.openCanceller,i=Math.round(e.verno*10),a=!1;function o(){if(t.openCanceller!==r)throw new I.DatabaseClosed("db.open() was cancelled")}var s=t.dbReadyResolve,u=null,c=!1,d=function(){return new D(function(l,v){if(o(),!n)throw new I.MissingAPI;var S=e.name,f=t.autoSchema||!i?n.open(S):n.open(S,i);if(!f)throw new I.MissingAPI;f.onerror=Oe(v),f.onblocked=re(e._fireOnBlocked),f.onupgradeneeded=re(function(p){if(u=f.transaction,t.autoSchema&&!e._options.allowEmptyDB){f.onerror=Ot,u.abort(),f.result.close();var h=n.deleteDatabase(S);h.onsuccess=h.onerror=re(function(){v(new I.NoSuchDatabase("Database ".concat(S," doesnt exist")))})}else{u.onerror=Oe(v);var b=p.oldVersion>Math.pow(2,62)?0:p.oldVersion;c=b<1,e.idbdb=f.result,a&&Aa(e,u),Ta(e,b/10,u,v)}},v),f.onsuccess=re(function(){u=null;var p=e.idbdb=f.result,h=pt(p.objectStoreNames);if(h.length>0)try{var b=p.transaction(xa(h),"readonly");if(t.autoSchema)Ia(e,p,b);else if(fn(e,e._dbSchema,b),!Ka(e,b)&&!a)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),p.close(),i=p.version+1,a=!0,l(d());sn(e,b)}catch{}wt.push(e),p.onversionchange=re(function(y){t.vcFired=!0,e.on("versionchange").fire(y)}),p.onclose=re(function(y){e.on("close").fire(y)}),c&&La(e._deps,S),l()},v)}).catch(function(l){switch(l?.name){case"UnknownError":if(t.PR1398_maxLoop>0)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),d();break;case"VersionError":if(i>0)return i=0,d();break}return D.reject(l)})};return D.race([r,(typeof navigator>"u"?D.resolve():ja()).then(d)]).then(function(){return o(),t.onReadyBeingFired=[],D.resolve(or(function(){return e.on.ready.fire(e.vip)})).then(function l(){if(t.onReadyBeingFired.length>0){var v=t.onReadyBeingFired.reduce(In,q);return t.onReadyBeingFired=[],D.resolve(or(function(){return v(e.vip)})).then(l)}})}).finally(function(){t.openCanceller===r&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(l){t.dbOpenError=l;try{u&&u.abort()}catch{}return r===t.openCanceller&&e._close(),ue(l)}).finally(function(){t.openComplete=!0,s()}).then(function(){if(c){var l={};e.tables.forEach(function(v){v.schema.indexes.forEach(function(S){S.name&&(l["idb://".concat(e.name,"/").concat(v.name,"/").concat(S.name)]=new ve(-1/0,[[[]]]))}),l["idb://".concat(e.name,"/").concat(v.name,"/")]=l["idb://".concat(e.name,"/").concat(v.name,"/:dels")]=new ve(-1/0,[[[]]])}),Ze(It).fire(l),dr(l,!0)}return e})}function pr(e){var t=function(o){return e.next(o)},n=function(o){return e.throw(o)},r=a(t),i=a(n);function a(o){return function(s){var u=o(s),c=u.value;return u.done?c:!c||typeof c.then!="function"?N(c)?Promise.all(c).then(r,i):r(c):c.then(r,i)}}return a(t)()}function Va(e,t,n){var r=arguments.length;if(r<2)throw new I.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];n=i.pop();var a=he(i);return[e,a,n]}function ai(e,t,n,r,i){return D.resolve().then(function(){var a=M.transless||M,o=e._createTransaction(t,n,e._dbSchema,r);o.explicit=!0;var s={trans:o,transless:a};if(r)o.idbtrans=r.idbtrans;else try{o.create(),o.idbtrans._explicit=!0,e._state.PR1398_maxLoop=3}catch(l){return l.name===On.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then(function(){return ai(e,t,n,null,i)})):ue(l)}var u=Rn(i);u&&bt();var c,d=D.follow(function(){if(c=i.call(o,o),c)if(u){var l=Ge.bind(null,null);c.then(l,l)}else typeof c.next=="function"&&typeof c.throw=="function"&&(c=pr(c))},s);return(c&&typeof c.then=="function"?D.resolve(c).then(function(l){return o.active?l:ue(new I.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):d.then(function(){return c})).then(function(l){return r&&o._resolve(),o._completion.then(function(){return l})}).catch(function(l){return o._reject(l),ue(l)})})}function vn(e,t,n){for(var r=N(e)?e.slice():[e],i=0;i<n;++i)r.push(t);return r}function $a(e){return w(w({},e),{table:function(t){var n=e.table(t),r=n.schema,i={},a=[];function o(p,h,b){var y=Bt(p),g=i[y]=i[y]||[],x=p==null?0:typeof p=="string"?1:p.length,m=h>0,C=w(w({},b),{name:m?"".concat(y,"(virtual-from:").concat(b.name,")"):b.name,lowLevelIndex:b,isVirtual:m,keyTail:h,keyLength:x,extractKey:er(p),unique:!m&&b.unique});if(g.push(C),C.isPrimaryKey||a.push(C),x>1){var P=x===2?p[0]:p.slice(0,x-1);o(P,h+1,b)}return g.sort(function(E,K){return E.keyTail-K.keyTail}),C}var s=o(r.primaryKey.keyPath,0,r.primaryKey);i[":id"]=[s];for(var u=0,c=r.indexes;u<c.length;u++){var d=c[u];o(d.keyPath,0,d)}function l(p){var h=i[Bt(p)];return h&&h[0]}function v(p,h){return{type:p.type===1?2:p.type,lower:vn(p.lower,p.lowerOpen?e.MAX_KEY:e.MIN_KEY,h),lowerOpen:!0,upper:vn(p.upper,p.upperOpen?e.MIN_KEY:e.MAX_KEY,h),upperOpen:!0}}function S(p){var h=p.query.index;return h.isVirtual?w(w({},p),{query:{index:h.lowLevelIndex,range:v(p.query.range,h.keyTail)}}):p}var f=w(w({},n),{schema:w(w({},r),{primaryKey:s,indexes:a,getIndexByKeyPath:l}),count:function(p){return n.count(S(p))},query:function(p){return n.query(S(p))},openCursor:function(p){var h=p.query.index,b=h.keyTail,y=h.isVirtual,g=h.keyLength;if(!y)return n.openCursor(p);function x(m){function C(E){E!=null?m.continue(vn(E,p.reverse?e.MAX_KEY:e.MIN_KEY,b)):p.unique?m.continue(m.key.slice(0,g).concat(p.reverse?e.MIN_KEY:e.MAX_KEY,b)):m.continue()}var P=Object.create(m,{continue:{value:C},continuePrimaryKey:{value:function(E,K){m.continuePrimaryKey(vn(E,e.MAX_KEY,b),K)}},primaryKey:{get:function(){return m.primaryKey}},key:{get:function(){var E=m.key;return g===1?E[0]:E.slice(0,g)}},value:{get:function(){return m.value}}});return P}return n.openCursor(S(p)).then(function(m){return m&&x(m)})}});return f}})}var Ua={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:$a};function hr(e,t,n,r){return n=n||{},r=r||"",z(e).forEach(function(i){if(!L(t,i))n[r+i]=void 0;else{var a=e[i],o=t[i];if(typeof a=="object"&&typeof o=="object"&&a&&o){var s=ht(a),u=ht(o);s!==u?n[r+i]=t[i]:s==="Object"?hr(a,o,n,r+i+"."):a!==o&&(n[r+i]=t[i])}else a!==o&&(n[r+i]=t[i])}}),z(t).forEach(function(i){L(e,i)||(n[r+i]=t[i])}),n}function vr(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var Ha={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return w(w({},e),{table:function(t){var n=e.table(t),r=n.schema.primaryKey,i=w(w({},n),{mutate:function(a){var o=M.trans,s=o.table(t).hook,u=s.deleting,c=s.creating,d=s.updating;switch(a.type){case"add":if(c.fire===q)break;return o._promise("readwrite",function(){return l(a)},!0);case"put":if(c.fire===q&&d.fire===q)break;return o._promise("readwrite",function(){return l(a)},!0);case"delete":if(u.fire===q)break;return o._promise("readwrite",function(){return l(a)},!0);case"deleteRange":if(u.fire===q)break;return o._promise("readwrite",function(){return v(a)},!0)}return n.mutate(a);function l(f){var p=M.trans,h=f.keys||vr(r,f);if(!h)throw new Error("Keys missing");return f=f.type==="add"||f.type==="put"?w(w({},f),{keys:h}):w({},f),f.type!=="delete"&&(f.values=F([],f.values,!0)),f.keys&&(f.keys=F([],f.keys,!0)),Ga(n,f,h).then(function(b){var y=h.map(function(g,x){var m=b[x],C={onerror:null,onsuccess:null};if(f.type==="delete")u.fire.call(C,g,m,p);else if(f.type==="add"||m===void 0){var P=c.fire.call(C,g,f.values[x],p);g==null&&P!=null&&(g=P,f.keys[x]=g,r.outbound||U(f.values[x],r.keyPath,g))}else{var E=hr(m,f.values[x]),K=d.fire.call(C,E,g,m,p);if(K){var $=f.values[x];Object.keys(K).forEach(function(A){L($,A)?$[A]=K[A]:U($,A,K[A])})}}return C});return n.mutate(f).then(function(g){for(var x=g.failures,m=g.results,C=g.numFailures,P=g.lastResult,E=0;E<h.length;++E){var K=m?m[E]:h[E],$=y[E];K==null?$.onerror&&$.onerror(x[E]):$.onsuccess&&$.onsuccess(f.type==="put"&&b[E]?f.values[E]:K)}return{failures:x,results:m,numFailures:C,lastResult:P}}).catch(function(g){return y.forEach(function(x){return x.onerror&&x.onerror(g)}),Promise.reject(g)})})}function v(f){return S(f.trans,f.range,1e4)}function S(f,p,h){return n.query({trans:f,values:!1,query:{index:r,range:p},limit:h}).then(function(b){var y=b.result;return l({type:"delete",keys:y,trans:f}).then(function(g){return g.numFailures>0?Promise.reject(g.failures[0]):y.length<h?{failures:[],numFailures:0,lastResult:void 0}:S(f,w(w({},p),{lower:y[y.length-1],lowerOpen:!0}),h)})})}}});return i}})}};function Ga(e,t,n){return t.type==="add"?Promise.resolve([]):e.getMany({trans:t.trans,keys:n,cache:"immutable"})}function oi(e,t,n){try{if(!t||t.keys.length<e.length)return null;for(var r=[],i=0,a=0;i<t.keys.length&&a<e.length;++i)G(t.keys[i],e[a])===0&&(r.push(n?Ne(t.values[i]):t.values[i]),++a);return r.length===e.length?r:null}catch{return null}}var Ya={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var n=e.table(t);return w(w({},n),{getMany:function(r){if(!r.cache)return n.getMany(r);var i=oi(r.keys,r.trans._cache,r.cache==="clone");return i?D.resolve(i):n.getMany(r).then(function(a){return r.trans._cache={keys:r.keys,values:r.cache==="clone"?Ne(a):a},a})},mutate:function(r){return r.type!=="add"&&(r.trans._cache=null),n.mutate(r)}})}}}};function si(e,t){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!t.schema.primaryKey.outbound}function ui(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":return!1;case"getMany":return!1;case"count":return!1;case"openCursor":return!1}}var Qa={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,n=new ve(e.MIN_KEY,e.MAX_KEY);return w(w({},e),{transaction:function(r,i,a){if(M.subscr&&i!=="readonly")throw new I.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(M.querier));return e.transaction(r,i,a)},table:function(r){var i=e.table(r),a=i.schema,o=a.primaryKey,s=a.indexes,u=o.extractKey,c=o.outbound,d=o.autoIncrement&&s.filter(function(f){return f.compound&&f.keyPath.includes(o.keyPath)}),l=w(w({},i),{mutate:function(f){var p,h,b=f.trans,y=f.mutatedParts||(f.mutatedParts={}),g=function(B){var Q="idb://".concat(t,"/").concat(r,"/").concat(B);return y[Q]||(y[Q]=new ve)},x=g(""),m=g(":dels"),C=f.type,P=f.type==="deleteRange"?[f.range]:f.type==="delete"?[f.keys]:f.values.length<50?[vr(o,f).filter(function(B){return B}),f.values]:[],E=P[0],K=P[1],$=f.trans._cache;if(N(E)){x.addKeys(E);var A=C==="delete"||E.length===K.length?oi(E,$):null;A||m.addKeys(E),(A||K)&&Za(g,a,A,K)}else if(E){var V={from:(p=E.lower)!==null&&p!==void 0?p:e.MIN_KEY,to:(h=E.upper)!==null&&h!==void 0?h:e.MAX_KEY};m.add(V),x.add(V)}else x.add(n),m.add(n),a.indexes.forEach(function(B){return g(B.name).add(n)});return i.mutate(f).then(function(B){return E&&(f.type==="add"||f.type==="put")&&(x.addKeys(B.results),d&&d.forEach(function(Q){for(var O=f.values.map(function(we){return Q.extractKey(we)}),se=Q.keyPath.findIndex(function(we){return we===o.keyPath}),me=0,Ie=B.results.length;me<Ie;++me)O[me][se]=B.results[me];g(Q.name).addKeys(O)})),b.mutatedParts=pn(b.mutatedParts||{},y),B})}}),v=function(f){var p,h,b=f.query,y=b.index,g=b.range;return[y,new ve((p=g.lower)!==null&&p!==void 0?p:e.MIN_KEY,(h=g.upper)!==null&&h!==void 0?h:e.MAX_KEY)]},S={get:function(f){return[o,new ve(f.key)]},getMany:function(f){return[o,new ve().addKeys(f.keys)]},count:v,query:v,openCursor:v};return z(S).forEach(function(f){l[f]=function(p){var h=M.subscr,b=!!h,y=si(M,i)&&ui(f,p),g=y?p.obsSet={}:h;if(b){var x=function(A){var V="idb://".concat(t,"/").concat(r,"/").concat(A);return g[V]||(g[V]=new ve)},m=x(""),C=x(":dels"),P=S[f](p),E=P[0],K=P[1];if(f==="query"&&E.isPrimaryKey&&!p.values?C.add(K):x(E.name||"").add(K),!E.isPrimaryKey)if(f==="count")C.add(n);else{var $=f==="query"&&c&&p.values&&i.query(w(w({},p),{values:!1}));return i[f].apply(this,arguments).then(function(A){if(f==="query"){if(c&&p.values)return $.then(function(O){var se=O.result;return m.addKeys(se),A});var V=p.values?A.result.map(u):A.result;p.values?m.addKeys(V):C.addKeys(V)}else if(f==="openCursor"){var B=A,Q=p.values;return B&&Object.create(B,{key:{get:function(){return C.addKey(B.primaryKey),B.key}},primaryKey:{get:function(){var O=B.primaryKey;return C.addKey(O),O}},value:{get:function(){return Q&&m.addKey(B.primaryKey),B.value}}})}return A})}}return i[f].apply(this,arguments)}}),l}})}};function Za(e,t,n,r){function i(a){var o=e(a.name||"");function s(c){return c!=null?a.extractKey(c):null}var u=function(c){return a.multiEntry&&N(c)?c.forEach(function(d){return o.addKey(d)}):o.addKey(c)};(n||r).forEach(function(c,d){var l=n&&s(n[d]),v=r&&s(r[d]);G(l,v)!==0&&(l!=null&&u(l),v!=null&&u(v))})}t.indexes.forEach(i)}function ci(e,t,n){if(n.numFailures===0)return t;if(t.type==="deleteRange")return null;var r=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;if(n.numFailures===r)return null;var i=w({},t);return N(i.keys)&&(i.keys=i.keys.filter(function(a,o){return!(o in n.failures)})),"values"in i&&N(i.values)&&(i.values=i.values.filter(function(a,o){return!(o in n.failures)})),i}function Xa(e,t){return t.lower===void 0?!0:t.lowerOpen?G(e,t.lower)>0:G(e,t.lower)>=0}function Ja(e,t){return t.upper===void 0?!0:t.upperOpen?G(e,t.upper)<0:G(e,t.upper)<=0}function mr(e,t){return Xa(e,t)&&Ja(e,t)}function li(e,t,n,r,i,a){if(!n||n.length===0)return e;var o=t.query.index,s=o.multiEntry,u=t.query.range,c=r.schema.primaryKey,d=c.extractKey,l=o.extractKey,v=(o.lowLevelIndex||o).extractKey,S=n.reduce(function(f,p){var h=f,b=[];if(p.type==="add"||p.type==="put")for(var y=new ve,g=p.values.length-1;g>=0;--g){var x=p.values[g],m=d(x);if(!y.hasKey(m)){var C=l(x);(s&&N(C)?C.some(function(A){return mr(A,u)}):mr(C,u))&&(y.addKey(m),b.push(x))}}switch(p.type){case"add":{var P=new ve().addKeys(t.values?f.map(function(A){return d(A)}):f);h=f.concat(t.values?b.filter(function(A){var V=d(A);return P.hasKey(V)?!1:(P.addKey(V),!0)}):b.map(function(A){return d(A)}).filter(function(A){return P.hasKey(A)?!1:(P.addKey(A),!0)}));break}case"put":{var E=new ve().addKeys(p.values.map(function(A){return d(A)}));h=f.filter(function(A){return!E.hasKey(t.values?d(A):A)}).concat(t.values?b:b.map(function(A){return d(A)}));break}case"delete":var K=new ve().addKeys(p.keys);h=f.filter(function(A){return!K.hasKey(t.values?d(A):A)});break;case"deleteRange":var $=p.range;h=f.filter(function(A){return!mr(d(A),$)});break}return h},e);return S===e?e:(S.sort(function(f,p){return G(v(f),v(p))||G(d(f),d(p))}),t.limit&&t.limit<1/0&&(S.length>t.limit?S.length=t.limit:e.length===t.limit&&S.length<t.limit&&(i.dirty=!0)),a?Object.freeze(S):S)}function fi(e,t){return G(e.lower,t.lower)===0&&G(e.upper,t.upper)===0&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function qa(e,t,n,r){if(e===void 0)return t!==void 0?-1:0;if(t===void 0)return 1;var i=G(e,t);if(i===0){if(n&&r)return 0;if(n)return 1;if(r)return-1}return i}function eo(e,t,n,r){if(e===void 0)return t!==void 0?1:0;if(t===void 0)return-1;var i=G(e,t);if(i===0){if(n&&r)return 0;if(n)return-1;if(r)return 1}return i}function to(e,t){return qa(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&eo(e.upper,t.upper,e.upperOpen,t.upperOpen)>=0}function no(e,t,n,r){var i=ct["idb://".concat(e,"/").concat(t)];if(!i)return[];var a=i.queries[n];if(!a)return[null,!1,i,null];var o=r.query?r.query.index.name:null,s=a[o||""];if(!s)return[null,!1,i,null];switch(n){case"query":var u=s.find(function(l){return l.req.limit===r.limit&&l.req.values===r.values&&fi(l.req.query.range,r.query.range)});if(u)return[u,!0,i,s];var c=s.find(function(l){var v="limit"in l.req?l.req.limit:1/0;return v>=r.limit&&(r.values?l.req.values:!0)&&to(l.req.query.range,r.query.range)});return[c,!1,i,s];case"count":var d=s.find(function(l){return fi(l.req.query.range,r.query.range)});return[d,!!d,i,s]}}function ro(e,t,n,r){e.subscribers.add(n),r.addEventListener("abort",function(){e.subscribers.delete(n),e.subscribers.size===0&&io(e,t)})}function io(e,t){setTimeout(function(){e.subscribers.size===0&&be(t,e)},3e3)}var ao={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name,n=w(w({},e),{transaction:function(r,i,a){var o=e.transaction(r,i,a);if(i==="readwrite"){var s=new AbortController,u=s.signal,c=function(d){return function(){if(s.abort(),i==="readwrite"){for(var l=new Set,v=0,S=r;v<S.length;v++){var f=S[v],p=ct["idb://".concat(t,"/").concat(f)];if(p){var h=e.table(f),b=p.optimisticOps.filter(function(Q){return Q.trans===o});if(o._explicit&&d&&o.mutatedParts)for(var y=0,g=Object.values(p.queries.query);y<g.length;y++)for(var x=g[y],m=0,C=x.slice();m<C.length;m++){var P=C[m];cr(P.obsSet,o.mutatedParts)&&(be(x,P),P.subscribers.forEach(function(Q){return l.add(Q)}))}else if(b.length>0){p.optimisticOps=p.optimisticOps.filter(function(Q){return Q.trans!==o});for(var E=0,K=Object.values(p.queries.query);E<K.length;E++)for(var x=K[E],$=0,A=x.slice();$<A.length;$++){var P=A[$];if(P.res!=null&&o.mutatedParts)if(d&&!P.dirty){var V=Object.isFrozen(P.res),B=li(P.res,P.req,b,h,P,V);P.dirty?(be(x,P),P.subscribers.forEach(function(se){return l.add(se)})):B!==P.res&&(P.res=B,P.promise=D.resolve({result:B}))}else P.dirty&&be(x,P),P.subscribers.forEach(function(se){return l.add(se)})}}}}l.forEach(function(Q){return Q()})}}};o.addEventListener("abort",c(!1),{signal:u}),o.addEventListener("error",c(!1),{signal:u}),o.addEventListener("complete",c(!0),{signal:u})}return o},table:function(r){var i=e.table(r),a=i.schema.primaryKey,o=w(w({},i),{mutate:function(s){var u=M.trans;if(a.outbound||u.db._options.cache==="disabled"||u.explicit||u.idbtrans.mode!=="readwrite")return i.mutate(s);var c=ct["idb://".concat(t,"/").concat(r)];if(!c)return i.mutate(s);var d=i.mutate(s);return(s.type==="add"||s.type==="put")&&(s.values.length>=50||vr(a,s).some(function(l){return l==null}))?d.then(function(l){var v=w(w({},s),{values:s.values.map(function(f,p){var h;if(l.failures[p])return f;var b=!((h=a.keyPath)===null||h===void 0)&&h.includes(".")?Ne(f):w({},f);return U(b,a.keyPath,l.results[p]),b})}),S=ci(c,v,l);c.optimisticOps.push(S),queueMicrotask(function(){return s.mutatedParts&&hn(s.mutatedParts)})}):(c.optimisticOps.push(s),s.mutatedParts&&hn(s.mutatedParts),d.then(function(l){if(l.numFailures>0){be(c.optimisticOps,s);var v=ci(c,s,l);v&&c.optimisticOps.push(v),s.mutatedParts&&hn(s.mutatedParts)}}),d.catch(function(){be(c.optimisticOps,s),s.mutatedParts&&hn(s.mutatedParts)})),d},query:function(s){var u;if(!si(M,i)||!ui("query",s))return i.query(s);var c=((u=M.trans)===null||u===void 0?void 0:u.db._options.cache)==="immutable",d=M,l=d.requery,v=d.signal,S=no(t,r,"query",s),f=S[0],p=S[1],h=S[2],b=S[3];if(f&&p)f.obsSet=s.obsSet;else{var y=i.query(s).then(function(g){var x=g.result;if(f&&(f.res=x),c){for(var m=0,C=x.length;m<C;++m)Object.freeze(x[m]);Object.freeze(x)}else g.result=Ne(x);return g}).catch(function(g){return b&&f&&be(b,f),Promise.reject(g)});f={obsSet:s.obsSet,promise:y,subscribers:new Set,type:"query",req:s,dirty:!1},b?b.push(f):(b=[f],h||(h=ct["idb://".concat(t,"/").concat(r)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}}),h.queries.query[s.query.index.name||""]=b)}return ro(f,b,l,v),f.promise.then(function(g){return{result:li(g.result,s,h?.optimisticOps,i,f,c)}})}});return o}});return n}};function mn(e,t){return new Proxy(e,{get:function(n,r,i){return r==="db"?t:Reflect.get(n,r,i)}})}var Le=function(){function e(t,n){var r=this;this._middlewares={},this.verno=0;var i=e.dependencies;this._options=n=w({addons:e.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange,cache:"cloned"},n),this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};var a=n.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var o={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:q,dbReadyPromise:null,cancelOpen:q,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:n.autoOpen};o.dbReadyPromise=new D(function(u){o.dbReadyResolve=u}),o.openCanceller=new D(function(u,c){o.cancelOpen=c}),this._state=o,this.name=t,this.on=At(this,"populate","blocked","versionchange","close",{ready:[In,q]}),this.on.ready.subscribe=St(this.on.ready.subscribe,function(u){return function(c,d){e.vip(function(){var l=r._state;if(l.openComplete)l.dbOpenError||D.resolve().then(c),d&&u(c);else if(l.onReadyBeingFired)l.onReadyBeingFired.push(c),d&&u(c);else{u(c);var v=r;d||u(function S(){v.on.ready.unsubscribe(c),v.on.ready.unsubscribe(S)})}})}}),this.Collection=pa(this),this.Table=la(this),this.Transaction=_a(this),this.Version=Na(this),this.WhereClause=ba(this),this.on("versionchange",function(u){u.newVersion>0?console.warn("Another connection wants to upgrade database '".concat(r.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(r.name,"'. Closing db now to resume the delete request.")),r.close({disableAutoOpen:!1})}),this.on("blocked",function(u){!u.newVersion||u.newVersion<u.oldVersion?console.warn("Dexie.delete('".concat(r.name,"') was blocked")):console.warn("Upgrade '".concat(r.name,"' blocked by other connection holding version ").concat(u.oldVersion/10))}),this._maxKey=Kt(n.IDBKeyRange),this._createTransaction=function(u,c,d,l){return new r.Transaction(u,c,d,r._options.chromeTransactionDurability,l)},this._fireOnBlocked=function(u){r.on("blocked").fire(u),wt.filter(function(c){return c.name===r.name&&c!==r&&!c._state.vcFired}).map(function(c){return c.on("versionchange").fire(u)})},this.use(Ya),this.use(ao),this.use(Qa),this.use(Ua),this.use(Ha);var s=new Proxy(this,{get:function(u,c,d){if(c==="_vip")return!0;if(c==="table")return function(v){return mn(r.table(v),s)};var l=Reflect.get(u,c,d);return l instanceof Hr?mn(l,s):c==="tables"?l.map(function(v){return mn(v,s)}):c==="_createTransaction"?function(){var v=l.apply(this,arguments);return mn(v,s)}:l}});this.vip=s,a.forEach(function(u){return u(r)})}return e.prototype.version=function(t){if(isNaN(t)||t<.1)throw new I.Type("Given version is not a positive number");if(t=Math.round(t*10)/10,this.idbdb||this._state.isBeingOpened)throw new I.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);var n=this._versions,r=n.filter(function(i){return i._cfg.version===t})[0];return r||(r=new this.Version(t),n.push(r),n.sort(Pa),r.stores({}),this._state.autoSchema=!1,r)},e.prototype._whenReady=function(t){var n=this;return this.idbdb&&(this._state.openComplete||M.letThrough||this._vip)?t():new D(function(r,i){if(n._state.openComplete)return i(new I.DatabaseClosed(n._state.dbOpenError));if(!n._state.isBeingOpened){if(!n._state.autoOpen){i(new I.DatabaseClosed);return}n.open().catch(q)}n._state.dbReadyPromise.then(r,i)}).then(t)},e.prototype.use=function(t){var n=t.stack,r=t.create,i=t.level,a=t.name;a&&this.unuse({stack:n,name:a});var o=this._middlewares[n]||(this._middlewares[n]=[]);return o.push({stack:n,create:r,level:i??10,name:a}),o.sort(function(s,u){return s.level-u.level}),this},e.prototype.unuse=function(t){var n=t.stack,r=t.name,i=t.create;return n&&this._middlewares[n]&&(this._middlewares[n]=this._middlewares[n].filter(function(a){return i?a.create!==i:r?a.name!==r:!1})),this},e.prototype.open=function(){var t=this;return ot(Ue,function(){return Wa(t)})},e.prototype._close=function(){var t=this._state,n=wt.indexOf(this);if(n>=0&&wt.splice(n,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}t.isBeingOpened||(t.dbReadyPromise=new D(function(r){t.dbReadyResolve=r}),t.openCanceller=new D(function(r,i){t.cancelOpen=i}))},e.prototype.close=function(t){var n=t===void 0?{disableAutoOpen:!0}:t,r=n.disableAutoOpen,i=this._state;r?(i.isBeingOpened&&i.cancelOpen(new I.DatabaseClosed),this._close(),i.autoOpen=!1,i.dbOpenError=new I.DatabaseClosed):(this._close(),i.autoOpen=this._options.autoOpen||i.isBeingOpened,i.openComplete=!1,i.dbOpenError=null)},e.prototype.delete=function(t){var n=this;t===void 0&&(t={disableAutoOpen:!0});var r=arguments.length>0&&typeof arguments[0]!="object",i=this._state;return new D(function(a,o){var s=function(){n.close(t);var u=n._deps.indexedDB.deleteDatabase(n.name);u.onsuccess=re(function(){za(n._deps,n.name),a()}),u.onerror=Oe(o),u.onblocked=n._fireOnBlocked};if(r)throw new I.InvalidArgument("Invalid closeOptions argument to db.delete()");i.isBeingOpened?i.dbReadyPromise.then(s):s()})},e.prototype.backendDB=function(){return this.idbdb},e.prototype.isOpen=function(){return this.idbdb!==null},e.prototype.hasBeenClosed=function(){var t=this._state.dbOpenError;return t&&t.name==="DatabaseClosed"},e.prototype.hasFailed=function(){return this._state.dbOpenError!==null},e.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(e.prototype,"tables",{get:function(){var t=this;return z(this._allTables).map(function(n){return t._allTables[n]})},enumerable:!1,configurable:!0}),e.prototype.transaction=function(){var t=Va.apply(this,arguments);return this._transaction.apply(this,t)},e.prototype._transaction=function(t,n,r){var i=this,a=M.trans;(!a||a.db!==this||t.indexOf("!")!==-1)&&(a=null);var o=t.indexOf("?")!==-1;t=t.replace("!","").replace("?","");var s,u;try{if(u=n.map(function(d){var l=d instanceof i.Table?d.name:d;if(typeof l!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return l}),t=="r"||t===Hn)s=Hn;else if(t=="rw"||t==Gn)s=Gn;else throw new I.InvalidArgument("Invalid transaction mode: "+t);if(a){if(a.mode===Hn&&s===Gn)if(o)a=null;else throw new I.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");a&&u.forEach(function(d){if(a&&a.storeNames.indexOf(d)===-1)if(o)a=null;else throw new I.SubTransaction("Table "+d+" not included in parent transaction.")}),o&&a&&!a.active&&(a=null)}}catch(d){return a?a._promise(null,function(l,v){v(d)}):ue(d)}var c=ai.bind(null,this,s,u,a,r);return a?a._promise(s,c,"lock"):M.trans?ot(M.transless,function(){return i._whenReady(c)}):this._whenReady(c)},e.prototype.table=function(t){if(!L(this._allTables,t))throw new I.InvalidTable("Table ".concat(t," does not exist"));return this._allTables[t]},e}(),oo=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",so=function(){function e(t){this._subscribe=t}return e.prototype.subscribe=function(t,n,r){return this._subscribe(!t||typeof t=="function"?{next:t,error:n,complete:r}:t)},e.prototype[oo]=function(){return this},e}(),yn;try{yn={indexedDB:T.indexedDB||T.mozIndexedDB||T.webkitIndexedDB||T.msIndexedDB,IDBKeyRange:T.IDBKeyRange||T.webkitIDBKeyRange}}catch{yn={indexedDB:null,IDBKeyRange:null}}function di(e){var t=!1,n,r=new so(function(i){var a=Rn(e);function o(b){var y=yt();try{a&&bt();var g=He(e,b);return a&&(g=g.finally(Ge)),g}finally{y&&gt()}}var s=!1,u,c={},d={},l={get closed(){return s},unsubscribe:function(){s||(s=!0,u&&u.abort(),v&&Ze.storagemutated.unsubscribe(p))}};i.start&&i.start(l);var v=!1,S=function(){return Vn(h)};function f(){return cr(d,c)}var p=function(b){pn(c,b),f()&&S()},h=function(){if(!(s||!yn.indexedDB)){c={};var b={};u&&u.abort(),u=new AbortController;var y={subscr:b,signal:u.signal,requery:S,querier:e,trans:null},g=o(y);Promise.resolve(g).then(function(x){t=!0,n=x,!(s||y.signal.aborted)&&(c={},d=b,!fe(d)&&!v&&(Ze(It,p),v=!0),Vn(function(){return!s&&i.next&&i.next(x)}))},function(x){t=!1,["DatabaseClosedError","AbortError"].includes(x?.name)||s||Vn(function(){s||i.error&&i.error(x)})})}};return setTimeout(S,0),l});return r.hasValue=function(){return t},r.getValue=function(){return n},r}var lt=Le;J(lt,w(w({},Ht),{delete:function(e){var t=new lt(e,{addons:[]});return t.delete()},exists:function(e){return new lt(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return Fa(lt.dependencies).then(e)}catch{return ue(new I.MissingAPI)}},defineClass:function(){function e(t){j(this,t)}return e},ignoreTransaction:function(e){return M.trans?ot(M.transless,e):e()},vip:or,async:function(e){return function(){try{var t=pr(e.apply(this,arguments));return!t||typeof t.then!="function"?D.resolve(t):t}catch(n){return ue(n)}}},spawn:function(e,t,n){try{var r=pr(e.apply(n,t||[]));return!r||typeof r.then!="function"?D.resolve(r):r}catch(i){return ue(i)}},currentTransaction:{get:function(){return M.trans||null}},waitFor:function(e,t){var n=D.resolve(typeof e=="function"?lt.ignoreTransaction(e):e).timeout(t||6e4);return M.trans?M.trans.waitFor(n):n},Promise:D,debug:{get:function(){return Me},set:function(e){Rr(e)}},derive:de,extend:j,props:J,override:St,Events:At,on:Ze,liveQuery:di,extendObservabilitySet:pn,getByKeyPath:W,setByKeyPath:U,delByKeyPath:ne,shallowClone:oe,deepClone:Ne,getObjectDiff:hr,cmp:G,asap:$t,minKey:Un,addons:[],connections:wt,errnames:On,dependencies:yn,cache:ct,semVer:zr,version:zr.split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,n){return e+t/Math.pow(10,n*2)})})),lt.maxKey=Kt(lt.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Ze(It,function(e){if(!Xe){var t;t=new CustomEvent(Xn,{detail:e}),Xe=!0,dispatchEvent(t),Xe=!1}}),addEventListener(Xn,function(e){var t=e.detail;Xe||yr(t)}));function yr(e){var t=Xe;try{Xe=!0,Ze.storagemutated.fire(e),dr(e,!0)}finally{Xe=t}}var Xe=!1,Je,gr=function(){};typeof BroadcastChannel<"u"&&(gr=function(){Je=new BroadcastChannel(Xn),Je.onmessage=function(e){return e.data&&yr(e.data)}},gr(),typeof Je.unref=="function"&&Je.unref(),Ze(It,function(e){Xe||Je.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!Le.disableBfCache&&e.persisted){Me&&console.debug("Dexie: handling persisted pagehide"),Je?.close();for(var t=0,n=wt;t<n.length;t++){var r=n[t];r.close({disableAutoOpen:!1})}}}),addEventListener("pageshow",function(e){!Le.disableBfCache&&e.persisted&&(Me&&console.debug("Dexie: handling persisted pageshow"),gr(),yr({all:new ve(-1/0,[[]])}))}));function uo(e){return new Mt({add:e})}function co(e){return new Mt({remove:e})}function lo(e,t){return new Mt({replacePrefix:[e,t]})}D.rejectionMapper=$i,Rr(Me);var fo=Object.freeze({__proto__:null,Dexie:Le,liveQuery:di,Entity:Vr,cmp:G,PropModification:Mt,replacePrefix:lo,add:uo,remove:co,default:Le,RangeSet:ve,mergeRanges:Ft,rangesOverlap:ti});return w(Le,fo,{default:Le}),Le})});var br=H(te(),1),ae={editButton:"M17.318 1.975a3.329 3.329 0 114.707 4.707L8.451 20.256c-.49.49-1.082.867-1.735 1.103L2.34 22.94a1 1 0 01-1.28-1.28l1.581-4.376a4.726 4.726 0 011.103-1.735L17.318 1.975zm3.293 1.414a1.329 1.329 0 00-1.88 0L5.159 16.963c-.283.283-.5.624-.636 1l-.857 2.372 2.371-.857a2.726 2.726 0 001.001-.636L20.611 5.268a1.329 1.329 0 000-1.879z",settings:"M7.96 5.33a2.67 2.67 90 100 5.34 2.67 2.67 90 000-5.34ZM6.67 8A1.33 1.33 90 119.33 8 1.33 1.33 90 016.67 8Zm4.82-4.81a.95.94 90 01-1.1-.75L10.05.55A.47.47 90 009.68.17 8.1 8.1 90 006.32.17.47.47 90 005.96.55L5.61 2.44a.95.95 90 01-1.25.71L2.55 2.51a.47.47 90 00-.51.13C1.28 3.47.71 4.46.36 5.53a.47.47 90 00.14.51L1.97 7.28a.94.94 90 010 1.43L.5 9.95a.47.47 90 00-.14.51 7.98 7.98 90 001.68 2.9.47.47 90 00.51.13l1.81-.65a.94.94 90 011.25.72l.34 1.89c.04.18.18.33.37.37a8.1 8.1 90 003.36 0 .47.47 90 00.37-.37l.34-1.89a.95.95 90 011.25-.72l1.81.65c.18.06.38.01.51-.13.76-.84 1.34-1.82 1.68-2.9a.47.47 90 00-.14-.5L14.03 8.72a.94.94 90 010-1.44L15.5 6.04a.47.47 90 00.14-.5 7.98 7.98 90 00-1.68-2.9.47.47 90 00-.51-.13l-1.81.65a.95.95 90 01-.15.04Zm-8.82.78 1.25.44a2.28 2.28 90 003-1.73l.24-1.3a6.81 6.81 90 011.68 0l.24 1.3a2.28 2.28 90 003.01 1.73l1.24-.44c.34.44.63.93.84 1.44l-1 .85a2.27 2.27 90 000 3.48l1 .85a6.65 6.65 90 01-.84 1.44l-1.24-.44A2.28 2.28 90 009.08 13.32l-.24 1.29a6.8 6.8 90 01-1.69 0l-.23-1.29A2.28 2.28 90 003.91 11.59l-1.24.44a6.65 6.65 90 01-.84-1.44l1-.86a2.27 2.27 90 000-3.47l-1-.85c.21-.51.5-1 .84-1.44Z",github:"M12.2135 0C18.947 0 24.4267 5.5 24.4066 12.3041c0 5.4391-3.4983 10.0428-8.3513 11.6728-.6065.1223-.829-.265-.829-.591 0-.4072.02-1.7315.02-3.3815 0-1.1613-.384-1.8945-.829-2.2815 2.73-.3058 5.581-1.3445 5.581-6.0708 0-1.3445-.465-2.4445-1.2537-3.3.1213-.3055.5463-1.5688-.1212-3.2595 0 0-1.0312-.326-3.3567 1.263-.9707-.2648-2.0219-.4075-3.0532-.4075A11.7425 11.7425 90 009.16 6.3556c-2.3252-1.589-3.3565-1.263-3.3565-1.263-.6675 1.6907-.2427 2.954-.1215 3.2595-.7685.8555-1.2535 1.9555-1.2535 3.3 0 4.7263 2.8509 5.7855 5.5607 6.0708-.3437.3055-.6675.8555-.7685 1.65-.7077.326-2.467.8555-3.5587-1.0185 0 0-.6472-1.1815-1.8807-1.263 0 0-1.193 0-.081.7538 0 0 .809.3665 1.355 1.7925 0 0 .7075 2.2002 4.105 1.4667 0 1.0188.02 1.9965.02 2.2818 0 .3258-.2222.713-.829.5905C3.4983 22.3472 0 17.7432 0 12.3042 0 5.5 5.4597 0 12.2135 0Z",close:"M31.098 29.794 16.955 15.65 31.097 1.51 29.683.093 15.54 14.237 1.4.094-.016 1.508 14.126 15.65-.016 29.795l1.414 1.414L15.54 17.065l14.144 14.143",warning:"MM13 14V9H11v5Zm0 2H11v2h2Zm8.884 3.5A1 1 0 0121 21H3a1 1 0 01-.884-1.468l9-17c.346-.654 1.422-.654 1.768 0Z",more:"M3 8A1.5 1.5 0 110 8a1.5 1.5 0 013 0zm6.5 0a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM16 8a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z",questionMark:"M12 2c5.523 0 10 4.478 10 10s-4.477 10-10 10S2 17.522 2 12 6.477 2 12 2Zm0 1.667c-4.595 0-8.333 3.738-8.333 8.333S7.405 20.333 12 20.333 20.333 16.595 20.333 12c0-4.595-3.738-8.333-8.333-8.333ZM12 15.5a1 1 0 110 2 1 1 0 010-2Zm0-8.75a2.75 2.75 0 012.75 2.75c0 1.01-.297 1.574-1.051 2.359l-.169.171c-.622.622-.78.886-.78 1.47a.75.75 0 01-1.5 0c0-1.01.297-1.574 1.051-2.359l.169-.171c.622-.622.78-.886.78-1.47a1.25 1.25 0 00-2.493-.128l-.007.128a.75.75 0 01-1.5 0A2.75 2.75 0 0112 6.75Z",dropdown:"M20.4614 6.3469a1.506 1.506 90 00-2.1125.1919L12 14.1564 5.651 6.5389a1.4997 1.4997 90 10-2.3028 1.922l7.5004 9.0004a1.4992 1.4992 90 002.3028 0l7.5004-9.0005a1.5019 1.5019 90 00-.1904-2.1139Z",palette:"M12 2c5.461 0 9.965 4.012 9.992 8.84 0 3.051-2.504 5.554-5.555 5.554H14.441a1.64 1.64 0 00-1.668 1.668c0 .473.148.836.438 1.125.257.29.437.688.437 1.125C13.648 21.254 12.926 22 12 22 6.5 22 2 17.5 2 12S6.5 2 12 2Z",duplicate:"M15 3.5c0-.5-.5-1-1-1H11V1c0-.5-.5-1-1-1H2C1.5 0 1 .5 1 1V11.5c0 .5.5 1 1 1H4.5V15c0 .5.5 1 1 1H14c.5 0 1-.5 1-1ZM2.5 2c0-.25.25-.5.5-.5H9c.25 0 .5.25.5.5v8.5c0 .25-.25.5-.5.5H3c-.25 0-.5-.25-.5-.5Zm4 12.5c-.25 0-.5-.25-.5-.5V12.5h4c.5 0 1-.5 1-1V4h2c.25 0 .5.25.5.5V14c0 .25-.25.5-.5.5Z"},Be=(_,k=16)=>({size:w=k,fill:F="currentColor"})=>(0,br.jsx)("svg",{viewBox:`0 0 ${k} ${k}`,width:w,height:w,fill:F,children:(0,br.jsx)("path",{d:_})});ae.React={editButton:Be(ae.editButton,24),settings:Be(ae.settings,16),github:Be(ae.github,24),close:Be(ae.close,32),warning:Be(ae.warning,24),more:Be(ae.more,16),questionMark:Be(ae.questionMark,24),dropdown:Be(ae.dropdown,24),palette:Be(ae.palette,24),duplicate:Be(ae.duplicate,16)};ae.HTML={editButton:`<path d="${ae.editButton}"/>`,settings:`<path d="${ae.settings}"/>`,github:`<path d="${ae.github}"/>`,close:`<path d="${ae.close}"/>`,warning:`<path d="${ae.warning}"/>`,more:`<path d="${ae.more}"/>`,questionMark:`<path d="${ae.questionMark}"/>`,dropdown:`<path d="${ae.dropdown}"/>`,palette:`<path d="${ae.palette}"/>`,duplicate:`<path d="${ae.duplicate}"/>`};var ke=ae;(()=>{let _=`.Modal__overlay {
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
  display: flex;
  justify-content: center;
  align-items: center;
  background-color: rgba(var(--spice-rgb-shadow), 0.5);
  border-radius: 7px;
}

.Modal {
  background-color: unset;
}

.Modal__container {
  display: flex;
  flex-direction: column;
  background-color: rgba(var(--spice-rgb-main), 0.9) !important;
  backdrop-filter: blur(20px) saturate(1.4) brightness(1.2);
  width: 500px;
  max-height: 500px;
  border-radius: 7px;
  box-shadow: 0 0px 20px rgba(var(--spice-rgb-shadow), 0.5) !important;
}

.Modal__container--large {
  max-height: 80vh;
  width: clamp(550px, 60vw, 650px);
}

.Modal__header {
  display: flex;
  justify-content: space-between;
  padding: 32px 32px 12px;
  border-bottom: 1px solid rgba(var(--spice-rgb-selected-row), 0.1);
}

.Modal__titleContainer {
  display: flex;
  gap: 8px;
}

.Modal__icon {
  display: flex;
  align-items: center;
}

.Modal__title {
  display: flex;
}

.Modal__buttonContainer {
  display: flex;
  align-items: center;
  gap: 8px;
}

.Modal__button {
  background-color: var(--spice-highlight);
  border-radius: 8px;
  height: 34px;
  cursor: pointer;
  padding: 8px;
  border: 0;
}

.Modal__button:hover {
  transform: scale(1.1);
}

.Modal__button:active {
  transform: scale(0.9);
}

.Modal__content {
  display: flex;
  padding: 16px 24px !important;
  overflow: auto;
  scrollbar-gutter: stable both-edges;
}
`,k="shared-popupModal.css";if(document.getElementById(k))return;let w=document.createElement("style");w.id=k,w.textContent=_,document.head.appendChild(w)})();var jt=H(Te(),1),yi=H(wr(),1);var ye=H(te(),1),ze=null,zt=null,wn=()=>{zt&&ze&&(zt.unmount(),ze.remove(),document.body.style.overflow="auto",document.removeEventListener("keydown",gi),document.removeEventListener("mousedown",bi),ze=null,zt=null)},gi=_=>{_.key==="Escape"&&wn()},bi=_=>{_.target.classList.contains("Modal__overlay")&&wn()},wi=({title:_="",content:k,isLarge:w=!0,buttons:F=null,icon:T=""}={})=>{ze=document.getElementById("popup-modal"),ze||(ze=document.createElement("popup-modal"),ze.id="popup-modal",document.body.appendChild(ze)),zt=yi.default.createRoot(ze),document.addEventListener("keydown",gi),document.addEventListener("mousedown",bi);let z=(0,jt.memo)(()=>(0,ye.jsx)("div",{className:"Modal__overlay",children:(0,ye.jsx)("div",{className:"Modal",children:(0,ye.jsxs)("div",{className:`Modal__container${w?" Modal__container--large":""}`,children:[(0,ye.jsxs)("div",{className:"Modal__header",children:[(0,ye.jsxs)("div",{className:"Modal__titleContainer",children:[(0,ye.jsx)("div",{className:"Modal__icon",children:T}),(0,ye.jsx)("h1",{className:"Modal__title",children:_})]}),(0,ye.jsxs)("div",{className:"Modal__buttonContainer",children:[F,(0,ye.jsx)(Spicetify.ReactComponent.TooltipWrapper,{label:"Close",placement:"top",children:(0,ye.jsx)("button",{type:"button",className:"Modal__button Modal__button--close",onClick:()=>wn(),children:(0,ye.jsx)(ke.React.close,{size:18})})})]})]}),(0,ye.jsx)("div",{className:"Modal__content",children:jt.default.isValidElement(k)?k:jt.default.createElement(k)})]})})}));zt.render((0,ye.jsx)(z,{}))};wi.hide=wn;var _n=wi;var xn=H(_i(),1),xi=Symbol.for("Dexie"),kn=globalThis[xi]||(globalThis[xi]=xn.default);if(xn.default.semVer!==kn.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${xn.default.semVer} and ${kn.semVer}`);var{liveQuery:Uo,mergeRanges:Ho,rangesOverlap:Go,RangeSet:Yo,cmp:Qo,Entity:Zo,PropModification:Xo,replacePrefix:Jo,add:qo,remove:es}=kn;var ki=kn;var ge=H(Te(),1);var kr=H(Te(),1),Si=H(wr(),1),Sn=H(te(),1);function wo({titleText:_,descriptionText:k,cancelText:w="Cancel",confirmText:F="Confirm",onConfirm:T,onClose:z,onOpen:N,onOutside:j,confirmLabel:Y,allowHTML:R}){let L=kr.default.memo(()=>{let[J,X]=Spicetify.React.useState(!0),ee=document.querySelector(".ReactModalPortal:last-of-type");return kr.default.useEffect(()=>{J&&N?.()},[J,N]),(0,Sn.jsx)(Spicetify.ReactComponent.RemoteConfigProvider,{configuration:Spicetify.Platform.RemoteConfiguration,children:(0,Sn.jsx)(Spicetify.ReactComponent.ConfirmDialog,{titleText:_,descriptionText:k,cancelText:w,confirmText:F,isOpen:J,onOutside:()=>{X(!1),j?.(),ee?.remove()},onClose:()=>{X(!1),z?.(),ee?.remove()},onConfirm:()=>{X(!1),T?.(),ee?.remove()},confirmLabel:Y,allowHTML:R})})});Si.default.createRoot(document.createElement("div")).render((0,Sn.jsx)(L,{}))}var Cn=wo;var kt=H(Te(),1);(()=>{let _=`.dropdown {
  position: relative;
  min-width: 100px;
  width: fit-content;
  font-size: 14px !important;
  cursor: pointer;

  .dropdown--disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .dropdown__button {
    display: flex;
    border: none;
    justify-content: space-between;
    align-items: center;
    padding: 0 8px;
    background: rgba(var(--spice-rgb-selected-row), 0.1);
    color: rgba(var(--spice-rgb-text), 0.8);
    border-radius: 4px;
    height: 32px;
    width: 100%;
  }

  .dropdown__arrow {
    display: flex;
  }

  .dropdown__menu {
    background: var(--spice-card);
    border-radius: 4px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    color: rgba(var(--spice-rgb-text), 0.8);
    border: solid rgba(var(--spice-rgb-subtext), 0.1) 1px;
    overflow-y: scroll;
    scrollbar-width: none;
    max-height: 250px;
  }

  .dropdown__option {
    display: flex;
    align-items: center;
    padding: 0 8px;
    height: 32px;
    cursor: pointer;

    &:first-child {
      border-top-left-radius: 4px;
      border-top-right-radius: 4px;
    }

    &:last-child {
      border-bottom-left-radius: 4px;
      border-bottom-right-radius: 4px;
    }

    &:hover,
    .dropdown__option--selected {
      background: var(--spice-button);
    }
  }
}
`,k="shared-dropdown.css";if(document.getElementById(k))return;let w=document.createElement("style");w.id=k,w.textContent=_,document.head.appendChild(w)})();var je=H(te(),1),_o=(0,kt.memo)(({value:_,options:k,onChange:w,disabled:F})=>{let T=(0,kt.useId)(),z=(0,kt.useRef)(null),N=`--dropdown-anchor-${T.replace(/:/g,"id")}`,j=R=>{w?.({target:{value:R.value}}),z.current?.hidePopover()},Y=k.find(R=>R.value===_)?.label||"Select...";return(0,je.jsxs)("div",{className:`dropdown${F?" dropdown--disabled":""}`,children:[(0,je.jsxs)("button",{className:"dropdown__button",popovertarget:T,popovertargetaction:"toggle",disabled:F,style:{anchorName:N},children:[(0,je.jsx)("div",{className:"dropdown__text",children:Y}),(0,je.jsx)("div",{className:"dropdown__arrow",children:(0,je.jsx)(ke.React.dropdown,{size:12})})]}),(0,je.jsx)("div",{popover:"auto",id:T,ref:z,className:"dropdown__menu",style:{top:`calc(anchor(${N} bottom) + 4px)`,left:`anchor(${N} left)`,width:`anchor-size(${N} width)`},children:k.map(R=>(0,je.jsx)("div",{className:`dropdown__option${_===R.value?" dropdown__option--selected":""}`,onClick:()=>j(R),children:R.label},R.value))})]})}),Ci=_o;var Wt=H(Te(),1);var Ei=H(Te(),1);(()=>{let _=`.input {
  background: rgba(var(--spice-rgb-selected-row), 0.1);
  border: 0;
  border-radius: 4px;
  color: rgba(var(--spice-rgb-text), 0.8);
  height: 32px;
  width: 128px;
  text-overflow: ellipsis;
  padding-left: 10px;

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
}
`,k="shared-input.css";if(document.getElementById(k))return;let w=document.createElement("style");w.id=k,w.textContent=_,document.head.appendChild(w)})();var Pi=H(te(),1),xo=(0,Ei.memo)(({value:_,onChange:k,placeholder:w,disabled:F})=>(0,Pi.jsx)("input",{className:"input",type:"text",value:_,onChange:k,placeholder:w,disabled:F})),Di=xo;var Oi=H(Te(),1);var Ti=H(Te(),1);var Sr=H(te(),1),ko=(0,Ti.memo)(({name:_,popupModal:k})=>k?(0,Sr.jsx)("button",{className:"themeOptionPopupButton",onClick:()=>_n({title:_,content:k,isLarge:!1}),"aria-label":"Open popup",children:(0,Sr.jsx)(ke.React.editButton,{size:16})}):null),Ai=ko;var Ri=H(Te(),1);var En=H(te(),1),So=(0,Ri.memo)(({tippy:_})=>(0,En.jsx)(Spicetify.ReactComponent.TooltipWrapper,{label:_,placement:"top",showDelay:0,children:(0,En.jsx)("div",{className:"themeOptionTippy",children:(0,En.jsx)(ke.React.questionMark,{size:20,fill:"var(--spice-subtext)"})})})),Mi=So;(()=>{let _=`.themeOptionRow {
  display: flex;
  height: 32px;
  justify-content: space-between;
}

.themeOptionDesc {
  display: flex;
  height: 100%;
  align-items: center;
  font-size: 15px;
  color: var(--spice-subtext);
}

.themeOptionControl {
  align-content: center;
  display: flex;
  gap: 8px;
}
`,k="shared-optionRow.css";if(document.getElementById(k))return;let w=document.createElement("style");w.id=k,w.textContent=_,document.head.appendChild(w)})();var et=H(te(),1),Co=(0,Oi.memo)(({name:_,desc:k,tippy:w,children:F,popupModal:T})=>(0,et.jsxs)("div",{className:"themeOptionRow","data-name":`theme:${_}`,children:[(0,et.jsx)("div",{className:"themeOptionContent",children:(0,et.jsx)("div",{className:"themeOptionDesc",children:k})}),(0,et.jsxs)("div",{className:"themeOptionControl",children:[w&&(0,et.jsx)(Mi,{tippy:w}),(0,et.jsx)(Ai,{name:_,popupModal:T}),F]})]})),Cr=Co;var Ii=H(Te(),1);(()=>{let _=`.toggle {
  display: flex;
  align-items: center;
  border: none;
  background: none;
  cursor: pointer;

  &:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .toggle__background {
    width: 42px;
    height: 24px;
    background: rgba(var(--spice-rgb-selected-row), 0.1);
    border-radius: 12px;
    display: flex;
    align-items: center;

    &:has(.toggle__slider--enabled) {
      background: var(--spice-button);
    }

    .toggle__slider--enabled {
      margin-left: 20px;
    }
  }

  .toggle__slider {
    width: 20px;
    height: 20px;
    background: var(--spice-text);
    border-radius: 50%;
    margin-left: 2px;
    transition: 0.1s cubic-bezier(0.45, 0.05, 0.55, 0.95);
    box-shadow: 0px 0px 5px rgba(var(--spice-rgb-shadow), 0.3);
  }
}
`,k="shared-toggle.css";if(document.getElementById(k))return;let w=document.createElement("style");w.id=k,w.textContent=_,document.head.appendChild(w)})();var Dn=H(te(),1),Eo=(0,Ii.memo)(({value:_,onChange:k,disabled:w})=>(0,Dn.jsx)("button",{className:"toggle",onClick:k,disabled:w,children:(0,Dn.jsx)("span",{className:"toggle__background",children:(0,Dn.jsx)("span",{className:`toggle__slider${_?" toggle__slider--enabled":""}${w?" toggle__slider--disabled":""}`})})})),Ki=Eo;var ce=H(te(),1),Bi=["live","remix","mix","acoustic","instrumental","radio","version","ver","edit","mono","stereo","deluxe","intro","outro","remastered","bonus","feat","ft","explicit","clean","piano","guitar","cover","original","extended","album","single"],Er={groupSettings:{exact:!0,isrc:!0,likely:!0,possible:!0},confirmSettings:{exact:!1,isrc:!1,likely:!0,possible:!0},defaultNormalizeWords:Bi,customNormalizeWords:[]},Ni=()=>{try{let _=localStorage.getItem("findDupeTracks");if(_){let k=JSON.parse(_);return k.defaultNormalizeWords||(k.defaultNormalizeWords=[...Bi]),k}return Er}catch(_){return console.error("Error loading settings:",_),Er}},Do=_=>{localStorage.setItem("findDupeTracks",JSON.stringify(_))},Pn=()=>Ni(),Po=()=>{let[_,k]=(0,Wt.useState)(Ni()),[w,F]=(0,Wt.useState)("");(0,Wt.useEffect)(()=>{Do(_)},[_]);let T=(R,L,J)=>(0,ce.jsxs)("section",{className:"dupe-settings__section",children:[(0,ce.jsx)("h3",{className:"dupe-settings__section-title",children:R}),(0,ce.jsx)("div",{className:"dupe-settings__options",children:Object.entries(J).map(([X,ee])=>(0,ce.jsx)(Cr,{name:`${X}-${L}`,desc:ee,children:(0,ce.jsx)(Ki,{value:_[L][X],onChange:()=>k(de=>({...de,[L]:{...de[L],[X]:!de[L][X]}}))})},X))})]}),z=()=>{let R=w.trim().toLowerCase();R&&(_.customNormalizeWords.includes(R)||_.defaultNormalizeWords.includes(R)||(k(L=>({...L,customNormalizeWords:[...L.customNormalizeWords,R]})),F("")))},N=(R,L)=>{k(J=>L?{...J,defaultNormalizeWords:J.defaultNormalizeWords.filter(X=>X!==R)}:{...J,customNormalizeWords:J.customNormalizeWords.filter(X=>X!==R)})},j=()=>{Cn({titleText:"Are you sure?",descriptionText:"This will reset all settings to default!",confirmText:"Reset",onConfirm:()=>k(JSON.parse(JSON.stringify(Er)))})},Y=[..._.defaultNormalizeWords.map(R=>({word:R,isDefault:!0})),..._.customNormalizeWords.map(R=>({word:R,isDefault:!1}))];return(0,ce.jsxs)("div",{className:"dupe-settings",children:[T("Duplicate Groups to Display","groupSettings",{exact:"Exact Duplicates (Same URI)",isrc:"ISRC Duplicates (Same Recording)",likely:"Likely Duplicates (Same Name)",possible:"Possible Duplicates (Similar Name)"}),T("Confirm Before Deleting","confirmSettings",{exact:"Exact Duplicates",isrc:"ISRC Duplicates",likely:"Likely Duplicates",possible:"Possible Duplicates"}),(0,ce.jsxs)("section",{className:"dupe-settings__section",children:[(0,ce.jsx)("h3",{className:"dupe-settings__section-title",children:"Normalization Words"}),(0,ce.jsx)("p",{className:"dupe-settings__description",children:"Add or remove words to be ignored when comparing track names for similarity."}),(0,ce.jsxs)(Cr,{name:"custom-words",desc:"Add a word to normalization list",children:[(0,ce.jsx)(Di,{value:w,onChange:R=>F(R.target.value),placeholder:"Enter word to normalize",disabled:!1,onKeyDown:R=>R.key==="Enter"&&z()}),(0,ce.jsx)("button",{type:"button",onClick:z,style:{marginLeft:8},children:"Add"})]}),(0,ce.jsx)("div",{className:"dupe-settings__words-list",children:Y.length>0?(0,ce.jsx)("div",{className:"dupe-settings__words-ul",children:Y.map(({word:R,isDefault:L})=>(0,ce.jsxs)("div",{className:"dupe-settings__word-item",children:[R,(0,ce.jsx)("button",{type:"button",className:"dupe-settings__word-remove",onClick:()=>N(R,L),children:"Remove"})]},R))}):(0,ce.jsx)("p",{className:"dupe-settings__no-words",children:"No normalization words"})})]}),(0,ce.jsx)("div",{className:"dupe-settings__actions",children:(0,ce.jsx)("button",{type:"button",className:"dupe-settings__reset",onClick:j,children:"Reset to Defaults"})})]})},Fi=Po;var Z=H(te(),1),ft=new ki("findDupeTracks");ft.version(1).stores({tracks:"&trackUri, trackName, albumUri, playCount, isrc"});async function To(_=100){let k=await Spicetify.Platform.LibraryAPI.getContents({offset:0,limit:_}),w=k.items.filter(T=>T.type==="playlist"&&T.isOwnedBySelf),F=k.totalLength;if(F>_){let T=Math.ceil((F-_)/_),z=Array.from({length:T},(j,Y)=>_*(Y+1)),N=await Promise.all(z.map(j=>Spicetify.Platform.LibraryAPI.getContents({offset:j,limit:_})));for(let j of N)w=w.concat(j.items.filter(Y=>Y.type==="playlist"&&Y.isOwnedBySelf))}return w}async function Ao(_,k=5e3){let w=await Spicetify.Platform.PlaylistAPI.getContents(_,{offset:0,limit:k}),F=w.items,T=w.totalLength;if(T>k){let R=Math.ceil((T-k)/k),L=Array.from({length:R},(X,ee)=>k*(ee+1)),J=await Promise.all(L.map(X=>Spicetify.Platform.PlaylistAPI.getContents(_,{offset:X,limit:k}).then(ee=>ee.items)));F=F.concat(J.flat())}let z=F.map(R=>R.uri),N=await ft.tracks.bulkGet(z),j=new Map(N.filter(Boolean).map(R=>[R.trackUri,R])),Y=F.map(R=>{let L=j.get(R.uri);return{trackUri:R.uri,trackName:R.name,albumUri:R.album.uri,playCount:L?.playCount??null,isrc:L?.isrc??null}});return await ft.tracks.bulkPut(Y),{items:F,totalLength:T}}async function Ro(_){let k=new Map,w=await ft.tracks.bulkGet(_),F=[];w.forEach((z,N)=>{let j=_[N];z?.isrc?k.set(j,z.isrc):F.push(j)});let T=[];if(F.length>0){let z=F.map(R=>Spicetify.URI.fromString(R).id),N=50,j=[];for(let R=0;R<z.length;R+=N){let J=`https://api.spotify.com/v1/tracks?ids=${z.slice(R,R+N).join(",")}`;j.push(Spicetify.CosmosAsync.get(J))}let Y=await Promise.all(j);for(let R of Y)for(let L of R.tracks){let J=L?.external_ids?.isrc,X=L?.uri;J&&X&&(k.set(X,J),T.push({key:X,changes:{isrc:J}}))}}return T.length>0&&await ft.tracks.bulkUpdate(T),k}async function Mo(_){let k=new Map,w=_.map(j=>j.uri),F=await ft.tracks.bulkGet(w),T=new Map,z=new Map;for(let j of F){let Y=j.trackUri;if(z.set(Y,j),j.playCount!=null)k.set(Y,j.playCount);else{let R=_.find(L=>L.uri===Y);R?.album?.uri&&(k.set(Y,null),T.set(Y,R.album.uri))}}let N=[];if(T.size>0){let j=new Map;T.forEach((R,L)=>{j.set(R,j.get(R)||new Set),j.get(R).add(L)});let Y=Array.from(j.entries()).map(async([R,L])=>{let X=(await Spicetify.GraphQL.Request(Spicetify.GraphQL.Definitions.getAlbum,{uri:R,locale:Spicetify.Locale.getLocale(),offset:0,limit:5e3}))?.data?.albumUnion?.tracksV2?.items;if(X)for(let ee of X){let de=ee?.track?.uri;if(L.has(de)){let dt=ee.track.playcount,We=dt?Number.parseInt(dt,10):0;k.set(de,We),N.push({key:de,changes:{playCount:We}})}}});await Promise.all(Y)}return N.length>0&&await ft.tracks.bulkUpdate(N),k}var Li=(_,k)=>k.get(_)??0,Oo=_=>{let k=Pn(),F=[...k.defaultNormalizeWords,...k.customNormalizeWords].join("|"),T=new RegExp(`\\b(${F})\\b`,"gi");return _.toLowerCase().replace(/\(.*?\)|\[.*?\]/g,"").replace(T,"").replace(/-/g," ").replace(/[^\p{L}\p{N}\s]/gu,"").replace(/\s+/g," ").trim()};function Io({selectedPlaylist:_}){let[k,w]=(0,ge.useState)([]),[F,T]=(0,ge.useState)(_?.uri||""),[z,N]=(0,ge.useState)(_||null),[j,Y]=(0,ge.useState)([]),[R,L]=(0,ge.useState)({}),[J,X]=(0,ge.useState)(new Map),[ee,de]=(0,ge.useState)({exact:[],isrc:[],likely:[],possible:[]});(0,ge.useEffect)(()=>{let W=!0;return(async()=>{let U=await To();if(!W)return;w(U);let ne=_?.uri||U[0]?.uri||"";T(ne),_?N(_):U.length>0&&N(U[0])})(),()=>{W=!1}},[_]);let dt=W=>{let U=W.target.value;T(U);let ne=k.find(oe=>oe.uri===U);ne&&(N(ne),typeof window<"u"&&(window.currentSelectedPlaylist=ne))},We=(0,ge.useCallback)((W,U,ne)=>{let oe=new Set,ie=(fe,tt,Ne)=>{let $e=new Map,An=0;for(let Ee of fe){if(oe.has(Ee.uri)){An++;continue}let be=Ne(tt(Ee));be&&($e.set(be,$e.get(be)||[]),$e.get(be).push(Ee))}let ht=[],Ct=0;for(let Ee of $e.values())if(Ee.length>1){let be=performance.now();Ee.sort((Re,De)=>Li(De.uri,U)-Li(Re.uri,U)),Ct+=performance.now()-be;for(let Re of Ee)oe.add(Re.uri);ht.push({mainTrack:Ee[0],duplicates:Ee.slice(1)})}return ht},he=ie(W,fe=>fe.uri,fe=>fe),le=ie(W,fe=>ne.get(fe.uri),fe=>fe),Se=ie(W,fe=>fe.name,fe=>fe.toLowerCase().trim()),Ve=ie(W,fe=>fe.name,Oo);de({exact:he,isrc:le,likely:Se,possible:Ve})},[]),Vt=async(W,U,ne)=>{await Spicetify.Platform.PlaylistAPI.remove(F,[{uri:W.uri,uid:W.uid}]),de(oe=>{let ie=oe[U],he=ie[ne],le=he.duplicates.filter(fe=>!(fe.uri===W.uri&&fe.uid===W.uid)),Se;he.mainTrack.uri===W.uri&&he.mainTrack.uid===W.uid?Se=le.length>0?{mainTrack:le[0],duplicates:le.slice(1)}:null:Se={...he,duplicates:le};let Ve=[...ie];return Se&&Se.duplicates.length>0?Ve[ne]=Se:Ve.splice(ne,1),{...oe,[U]:Ve}}),Y(oe=>oe.filter(ie=>!(ie.uri===W.uri&&ie.uid===W.uid)))},pt=async(W,U,ne)=>{if(!Pn().confirmSettings[W]){await Vt(ne,W,U);return}Cn({titleText:"Remove Track",descriptionText:`Are you sure you want to remove "${ne.name}"? This cannot be undone.`,confirmText:"Remove",onConfirm:()=>Vt(ne,W,U)})};(0,ge.useEffect)(()=>{let W={exact:[],isrc:[],likely:[],possible:[]};Y([]),de(W),L({}),X(new Map),(async()=>{let oe=(await Ao(F)).items;if(Y(oe),oe.length>0){let ie=oe.map(Se=>Se.uri),[he,le]=await Promise.all([Mo(oe),Ro(ie)]);L(he),X(le),We(oe,he,le)}})()},[F,We]);let St=(0,ge.memo)(({track:W})=>{let U=R.get(W.uri),ne=U!=null?U.toLocaleString():"N/A",oe=J.get(W.uri)||"N/A",ie=W.album?.name||"N/A",he=W.artists?.map(le=>le.name).join(", ")||"N/A";return(0,Z.jsxs)("div",{className:"dupe-group__details",children:["Artists: ",he,(0,Z.jsxs)("span",{className:"dupe-group__album",children:[" Album: ",ie]}),(0,Z.jsxs)("span",{className:"dupe-group__playcount",children:[" Plays: ",ne]}),(0,Z.jsxs)("span",{className:"dupe-group__isrc",children:[" ISRC: ",oe]})]})}),Ae=(W,U,ne)=>Pn().groupSettings[ne]?(0,Z.jsxs)("div",{className:"dupe-group",children:[(0,Z.jsx)("p",{className:"dupe-group__heading",children:`${W} (${U.length} found)`}),U.length>0?(0,Z.jsx)("ul",{className:"dupe-group__list",children:U.map((ie,he)=>(0,Z.jsxs)("li",{className:`dupe-group__item dupe-group__item--${ne}`,children:[(0,Z.jsxs)("div",{className:"dupe-group__source",children:["Source: ",ie.mainTrack.name,(0,Z.jsx)(St,{track:ie.mainTrack})]}),(0,Z.jsx)("div",{className:"dupe-group__duplicates-label",children:"Duplicates:"}),(0,Z.jsx)("ul",{className:"dupe-group__duplicates-list",children:ie.duplicates.map(le=>(0,Z.jsxs)("li",{className:"dupe-group__duplicate-item",children:[(0,Z.jsxs)("div",{className:"dupe-group__duplicate-content",children:[(0,Z.jsx)("span",{className:"dupe-group__duplicate-name",children:le.name}),(0,Z.jsx)(St,{track:le})]}),(0,Z.jsx)("button",{className:"dupe-group__delete-button",onClick:()=>pt(ne,he,le),children:"Delete"})]},`${le.uri}-${le.uid||le.uri}`))})]},`${ie.mainTrack.uri}-${ie.mainTrack.uid||he}`))}):(0,Z.jsx)("p",{children:"No duplicates found in this category."})]}):null,$t=z?z.name:"Select a playlist",Tn=k.map(W=>({value:W.uri,label:W.name}));return(0,Z.jsxs)("div",{className:"find-dupes",children:[(0,Z.jsxs)("div",{className:"find-dupes__header",children:[(0,Z.jsx)("span",{className:"find-dupes__header-label",children:"Select Playlist:"}),(0,Z.jsx)(Ci,{value:F,options:Tn,onChange:dt,disabled:k.length===0})]}),F&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)("p",{className:"find-dupes__details",children:["Playlist: ",$t," (",j.length," tracks analyzed)"]}),(0,Z.jsxs)(Z.Fragment,{children:[Ae("Exact Duplicates (Same URI)",ee.exact,"exact"),Ae("ISRC Duplicates (Same Recording)",ee.isrc,"isrc"),Ae("Likely Duplicates (Same Name)",ee.likely,"likely"),Ae("Possible Duplicates (Similar Name)",ee.possible,"possible")]})]})]})}var zi=Io;(()=>{let _=`.find-dupes {
  display: flex;
  flex-direction: column;
  gap: 10px;
  width: 100%;
}

.find-dupes__header {
  display: flex;
  align-items: center;
  gap: 10px;
}

.find-dupes__header-label {
  color: var(--spice-text);
  font-weight: bold;
}

.find-dupes__details {
  font-size: 1.25em;
  color: var(--spice-text);
}

.dupe-group {
  display: flex;
  flex-direction: column;
  gap: 10px;
  background-color: var(--spice-player);
  border: 1px solid rgba(var(--spice-rgb-selected-row), 0.1);
  border-radius: 6px;
  padding: 12px;
}

.dupe-group__heading {
  display: flex;
  justify-content: space-between;
  font-weight: bold;
  font-size: 1.2em;
  color: var(--spice-text);
}

.dupe-group__heading-length {
  background: #ff676746;
  border: 1px solid #ff575766;
  font-size: 12px;
  font-weight: 400;
  border-radius: 100px;
  padding: 0 12px;
  align-content: center;
}

.dupe-group__list {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.dupe-group__item {
  display: flex;
  flex-direction: column;
  gap: 5px;
  padding: 15px;
  border-radius: 4px;
  border: 1px solid rgba(var(--spice-rgb-selected-row), 0.1);
  border-left: 4px solid;
}

.dupe-group__item--exact {
  border-left-color: #ff5a5a;
}

.dupe-group__item--isrc {
  border-left-color: #ff9050;
}

.dupe-group__item--likely {
  border-left-color: #eaea66;
}

.dupe-group__item--possible {
  border-left-color: #80ef80;
}

.dupe-group__source {
  font-weight: bold;
  color: var(--spice-text);
  font-size: 1.05em;
}

.dupe-group__duplicates-label {
  font-weight: normal;
  color: var(--spice-subtext);
  font-size: 0.95em;
}

.dupe-group__duplicates-list {
  padding-left: 15px;
  display: flex;
  flex-direction: column;
}

.dupe-group__line {
  display: flex;
  gap: 8px;
}

.dupe-group__duplicate-name {
  font-weight: 600;
}

.dupe-group__duplicate-item {
  font-size: 1em;
  border-bottom: 1px solid rgba(var(--spice-rgb-selected-row), 0.1);
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 10px;
}

.dupe-group__duplicate-item:last-child {
  border-bottom: none;
}

.dupe-group__duplicates-label {
  color: var(--spice-text);
  font-size: 16px;
  font-weight: 600;
}

.dupe-group__details {
  display: flex;
  flex-direction: column;
  color: var(--spice-subtext);
  font-size: 0.9em;
}

.dupe-group__delete-button {
  background-color: #ff5a5a;
  color: white;
  border: none;
  padding: 6px 12px;
  border-radius: 4px;
  cursor: pointer;
  font-size: 0.85em;
  font-weight: bold;

  &:hover {
    background-color: #d34f4f;
  }

  &:active {
    background-color: #c72c2c;
    transform: scale(0.98);
  }
}

.dupe-settings {
  width: 100%;
}

.dupe-settings__section {
  margin-bottom: 24px;
}

.dupe-settings__section-title {
  font-size: 16px;
  font-weight: 700;
  margin-bottom: 16px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  padding-bottom: 8px;
}

.dupe-settings__description {
  margin-bottom: 12px;
  opacity: 0.7;
  font-size: 13px;
}

.dupe-settings__options {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 12px;
}

.dupe-settings__option {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 8px 12px;
  background-color: rgba(0, 0, 0, 0.2);
  border-radius: 4px;
}

.dupe-settings__words-list {
  max-height: 200px;
  overflow-y: auto;
}

.dupe-settings__words-ul {
  padding: 0;
  margin: 0;
}

.dupe-settings__word-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 8px 12px;
  background-color: rgba(0, 0, 0, 0.2);
  border-radius: 4px;
  margin-bottom: 8px;
}

.dupe-settings__word-item .dupe-settings__word-remove {
  background-color: #ff5a5a;
  border: none;
  color: white;
  padding: 4px 8px;
  border-radius: 4px;
  cursor: pointer;
  font-size: 12px;

  &:hover {
    background-color: #d34f4f;
  }
}

.dupe-settings__words-list .dupe-settings__no-words {
  padding: 12px;
  text-align: center;
  background-color: rgba(0, 0, 0, 0.2);
  border-radius: 4px;
  opacity: 0.7;
}

.dupe-settings__actions {
  display: flex;
  justify-content: flex-end;
  margin-top: 24px;
}

.dupe-settings__actions .dupe-settings__reset {
  background-color: rgba(255, 50, 50, 0.3);
  color: white;
  border: none;
  padding: 8px 16px;
  border-radius: 4px;
  cursor: pointer;

  &:hover {
    background-color: rgba(255, 50, 50, 0.6);
  }
}
`,k="findDupeTracks-styles.css";if(document.getElementById(k))return;let w=document.createElement("style");w.id=k,w.textContent=_,document.head.appendChild(w)})();var _e=H(te(),1),Ko=(_,k="main")=>{let w=F=>{let T=F==="settings";_n({title:T?"Find Duplicates Settings":"Find Duplicates",content:T?(0,_e.jsx)(Fi,{}):(0,_e.jsx)(zi,{selectedPlaylist:_}),isLarge:!0,buttons:(0,_e.jsxs)(_e.Fragment,{children:[(0,_e.jsx)(Spicetify.ReactComponent.TooltipWrapper,{label:T?"Back to Duplicates":"Settings",placement:"top",children:(0,_e.jsx)("button",{className:`Modal__button Modal__button--${T?"back":"settings"}`,onClick:()=>w(T?"main":"settings"),children:T?(0,_e.jsx)(ke.React.duplicate,{size:18}):(0,_e.jsx)(ke.React.settings,{size:18})})}),(0,_e.jsx)(Spicetify.ReactComponent.TooltipWrapper,{label:"GitHub",placement:"top",children:(0,_e.jsx)("button",{className:"Modal__button Modal__button--github",onClick:()=>window.open("https://github.com/veryboringhwl/spicetify-extensions"),children:(0,_e.jsx)(ke.React.github,{size:18})})})]})})};w(k)},Dr=null,Bo=new Spicetify.ContextMenuV2.Item({children:"Find Duplicates",leadingIcon:ke.HTML.duplicate,onClick:async()=>{let _=await Spicetify.Platform.PlaylistAPI.getMetadata(Dr),k={uri:Dr,name:_.name};Ko(k)},shouldAdd:(_,k,w)=>{let T=Spicetify.ContextMenuV2.parseProps(_)[0][0],z=Spicetify.URI.isPlaylistV1OrV2(T);return Dr=z?T:null,z}});Bo.register();
/*! Bundled license information:

dexie/dist/dexie.js:
  (*! *****************************************************************************
  Copyright (c) Microsoft Corporation.
  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.
  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** *)
*/
})();
